<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SCION Data Plane</title>
<meta content="Corine de Kater" name="author">
<meta content="Nicola Rustignoli" name="author">
<meta content="Jean-Christophe Hugly" name="author">
<meta content="Samuel Hitz" name="author">
<meta content="
       This document describes the data plane of the path-aware, inter-domain network architecture SCION (Scalability, Control, and Isolation On Next-generation networks). One of the basic characteristics of SCION is that it gives path control to endpoints. The SCION Control Plane is responsible for discovering these paths and making them available as path segments to the endpoints. The role of the SCION Data Plane is to combine the path segments into end-to-end paths, and forward data between endpoints according to the specified path. 
       The SCION Data Plane fundamentally differs from today's IP-based data plane in that it is  path-aware : In SCION, interdomain forwarding directives are embedded in the packet header. This document provides a detailed specification of the SCION data packet format as well as the structure of the SCION header. SCION also supports extension headers, which are additionally described. The document continues with the life cycle of a SCION packet while traversing the SCION Internet, followed by a specification of the SCION path authorization mechanisms and the packet processing at routers. 
       This document contains new approaches to secure path aware networking. It is not an Internet Standard, has not received any formal review of the IETF, nor was the work developed through the rough consensus process. The approaches offered in this work are offered to the community for its consideration in the further evolution of the Internet. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-dekater-scion-dataplane-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-dekater-scion-dataplane.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SCION DP</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">de Kater, et al.</td>
<td class="center">Expires 18 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dekater-scion-dataplane-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-16" class="published">16 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-18">18 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. de Kater</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">N. Rustignoli</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">J. C. Hugly</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">S. Hitz</div>
<div class="org">Anapaya Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SCION Data Plane</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the data plane of the path-aware, inter-domain network architecture SCION (Scalability, Control, and Isolation On Next-generation networks). One of the basic characteristics of SCION is that it gives path control to endpoints. The SCION Control Plane is responsible for discovering these paths and making them available as path segments to the endpoints. The role of the SCION Data Plane is to combine the path segments into end-to-end paths, and forward data between endpoints according to the specified path.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The SCION Data Plane fundamentally differs from today's IP-based data plane in that it is <em>path-aware</em>: In SCION, interdomain forwarding directives are embedded in the packet header. This document provides a detailed specification of the SCION data packet format as well as the structure of the SCION header. SCION also supports extension headers, which are additionally described. The document continues with the life cycle of a SCION packet while traversing the SCION Internet, followed by a specification of the SCION path authorization mechanisms and the packet processing at routers.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document contains new approaches to secure path aware networking. It is not an Internet Standard, has not received any formal review of the IETF, nor was the work developed through the rough consensus process. The approaches offered in this work are offered to the community for its consideration in the further evolution of the Internet.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://scionassociation.github.io/scion-dp_I-D/draft-dekater-scion-dataplane.html">https://scionassociation.github.io/scion-dp_I-D/draft-dekater-scion-dataplane.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-dekater-scion-dataplane/">https://datatracker.ietf.org/doc/draft-dekater-scion-dataplane/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/scionassociation/scion-dp_I-D">https://github.com/scionassociation/scion-dp_I-D</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1" class="keepWithNext"><a href="#section-1.3.1" class="auto internal xref">1.3.1</a>.  <a href="#name-inter-and-intra-domain-forw" class="internal xref">Inter- and Intra-Domain Forwarding</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a href="#section-1.3.2" class="auto internal xref">1.3.2</a>.  <a href="#name-intra-domain-forwarding-pro" class="internal xref">Intra-Domain Forwarding Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.3">
                    <p id="section-toc.1-1.1.2.3.2.3.1"><a href="#section-1.3.3" class="auto internal xref">1.3.3</a>.  <a href="#name-configuration" class="internal xref">Configuration</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-path-construction-segment-c" class="internal xref">Path Construction (Segment Combinations)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-path-authorization" class="internal xref">Path Authorization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-scion-header-specification" class="internal xref">SCION Header Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-common-header" class="internal xref">Common Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-address-header" class="internal xref">Address Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-path-header" class="internal xref">Path Header</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-empty-path-type" class="internal xref">Empty Path Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-scion-path-type" class="internal xref">SCION Path Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-one-hop-path-type" class="internal xref">One-Hop Path Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-path-reversal" class="internal xref">Path Reversal</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-extension-headers" class="internal xref">Extension Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-options-field" class="internal xref">Options Field</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-pseudo-header-for-upper-lay" class="internal xref">Pseudo Header for Upper-Layer Checksum</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-life-of-a-scion-data-packet" class="internal xref">Life of a SCION Data Packet</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-description" class="internal xref">Description</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-creating-an-end-to-end-scio" class="internal xref">Creating an End-to-End SCION Forwarding Path</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-step-by-step-explanation" class="internal xref">Step-by-Step Explanation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-path-authorization-2" class="internal xref">Path Authorization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-authorizing-segments-throug" class="internal xref">Authorizing Segments through Chained MACs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-hop-field-mac-overview" class="internal xref">Hop Field MAC Overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-peering-link-mac-computatio" class="internal xref">Peering Link MAC Computation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-path-initialization-and-pac" class="internal xref">Path Initialization and Packet Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-initialization-at-source-en" class="internal xref">Initialization at Source Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-processing-at-routers" class="internal xref">Processing at Routers</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-mtu" class="internal xref">MTU</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-packet-fragmentation" class="internal xref">Packet Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-scion-ip-gateway" class="internal xref">SCION IP Gateway</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-handling-link-failures" class="internal xref">Handling Link Failures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-link-failure-detection-bfd" class="internal xref">Link Failure Detection - BFD</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-link-failure-notification-s" class="internal xref">Link Failure Notification - SCMP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-path-authorization-3" class="internal xref">Path Authorization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-forwarding-key-compromise" class="internal xref">Forwarding key compromise</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-forging-hop-field-mac" class="internal xref">Forging Hop Field MAC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.3">
                    <p id="section-toc.1-1.7.2.1.2.3.1"><a href="#section-7.1.3" class="auto internal xref">7.1.3</a>.  <a href="#name-path-splicing" class="internal xref">Path Splicing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-on-path-attacks" class="internal xref">On-Path Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-modification-of-the-path-he" class="internal xref">Modification of the Path Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-payload-integrity" class="internal xref">Payload Integrity</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-off-path-attacks" class="internal xref">Off-Path Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-volumetric-denial-of-servic" class="internal xref">Volumetric Denial of Service Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-deployment-testing-scionlab" class="internal xref">Deployment Testing: SCIONLab</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-assigned-scion-protocol-num" class="internal xref">Assigned SCION Protocol Numbers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-C.1" class="auto internal xref"></a><a href="#name-considerations" class="internal xref">Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-C.2" class="auto internal xref"></a><a href="#name-assignment" class="internal xref">Assignment</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-D.1" class="auto internal xref"></a><a href="#name-draft-dekater-scion-datapla" class="internal xref">draft-dekater-scion-dataplane-05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-D.2" class="auto internal xref"></a><a href="#name-draft-dekater-scion-dataplan" class="internal xref">draft-dekater-scion-dataplane-04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-D.3" class="auto internal xref"></a><a href="#name-draft-dekater-scion-dataplane" class="internal xref">draft-dekater-scion-dataplane-03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-D.4" class="auto internal xref"></a><a href="#name-draft-dekater-scion-dataplane-" class="internal xref">draft-dekater-scion-dataplane-02</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">SCION is a path-aware internetworking routing architecture as described in <span>[<a href="#RFC9217" class="cite xref">RFC9217</a>]</span>. It allows endpoints and applications to select paths across the network to use for traffic, based on trusted path properties. SCION is an inter-domain network architecture and is therefore not concerned with intra-domain forwarding.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">SCION has been developed with the following goals:<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><em>Availability</em> - to provide highly available communication that can send traffic over paths with optimal or required characteristics, quickly handle inter-domain link or router failures (both on the last hop or anywhere along the path) and provide continuity in the presence of adversaries.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><em>Security</em> - to introduce a new approach to inter-domain path security that leverages path awareness in combination with a unique trust model. The goal is to provide higher levels of trust in routing information to prevent traffic hijacking, and enable users to decide where their data travels based on routing information that can be unambiguously attributed to an AS, ensuring that packets are only forwarded along authorized path segments. A particular use case is to enable geofencing.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><em>Scalability</em> - to improve the scalability of the inter-domain control plane and data plane, avoiding existing limitations related to convergence and forwarding table size. The advertising of path segments is separated into a beaconing process within each Isolation Domain (ISD) and between ISDs which incurs minimal overhead and resource requirements on routers.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">SCION relies on three main components:<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"><em>PKI</em> - To achieve scalability and trust, SCION organizes existing ASes into logical groups of independent routing planes called <em>Isolation Domains (ISDs)</em>. All ASes in an ISD agree on a set of trust roots called the <em>Trust Root Configuration (TRC)</em> which is a collection of signed root certificates in X.509 v3 format <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The ISD is governed by a set of <em>core ASes</em> which typically manage the trust roots and provide connectivity to other ISDs. This is the basis of the public key infrastructure which the SCION Control Plane relies upon for the authentication of messages that is used for the SCION control plane. See <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span><a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><em>Control Plane</em> - performs inter-domain routing by discovering and securely disseminating path information between ASes. The core ASes use Path-segment Construction Beacons (PCBs) to explore intra-ISD paths, or to explore paths across different ISDs. See <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span><a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9"><em>Data Plane</em> - carries out secure packet forwarding between SCION-enabled ASes over paths selected by endpoints. A SCION border router reuses existing intra-domain infrastructure to communicate to other SCION routers or SCION endpoints within its AS.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">This document describes the SCION Data Plane component. It should be read in conjunction with the other components <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span> and <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">The SCION architecture was initially developed outside of the IETF by ETH Zurich with significant contributions from Anapaya Systems. It is deployed in the Swiss finance sector to provide resilient connectivity between financial institutions. The aim of this document is to document the existing protocol specification as deployed, to encourage interoperability among implementations, and to introduce new concepts that can potentially be further improved to address particular problems with the current Internet architecture.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">==Note (to be removed before publication): this document, together with the other components <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span> and <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>, deprecates <span>[<a href="#I-D.dekater-panrg-scion-overview" class="cite xref">I-D.dekater-panrg-scion-overview</a>]</span>.==<a href="#section-1-12" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1"><strong>Autonomous System (AS)</strong>: An autonomous system is a network under a common administrative control. For example, the network of an Internet service provider or organization can constitute an AS.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2"><strong>Core AS</strong>: Each SCION isolation domain (ISD) is administered by a set of distinguished autonomous systems (ASes) called core ASes, which are responsible for initiating the path discovery and path construction process (in SCION called "beaconing").<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3"><strong>Data Plane</strong>: The data plane (sometimes also referred to as the forwarding plane) is responsible for forwarding data packets that endpoints have injected into the network. After routing information has been disseminated by the control plane, packets are forwarded by the data plane in accordance with such information.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4"><strong>Egress/Ingress</strong>: refers to the direction of travel. In SCION, path construction with beaconing happens in one direction, while actual traffic might follow the opposite direction. This document clarifies on a case-by-case basis whether 'egress' or 'ingress' refers to the direction of travel of the SCION packet or to the direction of beaconing.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5"><strong>Endpoint</strong>: An endpoint is the start or the end of a SCION path, as defined in <span>[<a href="#RFC9473" class="cite xref">RFC9473</a>]</span>.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6"><strong>Forwarding Key</strong>: A forwarding key is a symmetric key that is shared between the control service (control plane) and the routers (data plane) of an AS. It is used to authenticate Hop Fields in the end-to-end SCION path. The forwarding key is an AS-local secret and is not shared with other ASes.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7"><strong>Forwarding Path</strong>: A forwarding path is a complete end-to-end path between two SCION endpoints which is used to transmit packets in the data plane. It can be created with a combination of up to three path segments (an up segment, a core segment, and a down segment).<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8"><strong>Hop Field (HF)</strong>: As they traverse the network, path segment construction beacons (PCBs) accumulate cryptographically protected AS-level path information in the form of Hop Fields. In the data plane, Hop Fields are used for packet forwarding: they contain the incoming and outgoing interface IDs of the ASes on the forwarding path.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9"><strong>Info Field (INF)</strong>: Each path segment construction beacon (PCB) contains a single Info field, which provides basic information about the PCB. Together with Hop Fields (HFs), these are used to create forwarding paths.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10"><strong>Interface Identifier (Interface ID)</strong>: A 16-bit identifier that designates a SCION interface at the end of a link connecting two SCION ASes, with each interface belonging to one border router. Hop fields describe the traversal of an AS by a pair of interface IDs called <code>ConsIngress</code> and <code>ConsEgress</code>, as they refer to the ingress and egress interfaces in the direction of path construction (beaconing). The Interface ID <span class="bcp14">MUST</span> be unique within each AS. Interface ID 0 is not a valid identifier as implementations <span class="bcp14">MAY</span> use it as the "unspecified" value.<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11"><strong>Isolation Domain (ISD)</strong>: In SCION, Autonomous Systems (ASes) are organized into logical groups called Isolation Domains or ISDs. Each ISD consists of ASes that span an area with a uniform trust environment (e.g. a common jurisdiction). A possible model is for ISDs to be formed along national boundaries or federations of nations.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12"><strong>Leaf AS</strong>: An AS at the "edge" of an ISD, with no other downstream ASes.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<p id="section-1.1-13"><strong>MAC</strong>: Message Authentication Code. In the rest of this document, "MAC" always refers to "Message Authentication Code" and never to "Medium Access Control". When "Medium Access Control address" is implied, the phrase "Link Layer Address" is used.<a href="#section-1.1-13" class="pilcrow">¶</a></p>
<p id="section-1.1-14"><strong>Path Authorization</strong>: A requirement for the data plane is that endpoints can only use paths that were constructed and authorized by ASes in the control plane. This property is called path authorization. The goal of path authorization is to prevent endpoints from crafting Hop Fields (HFs) themselves, modifying HFs in authorized path segments, or combining HFs of different path segments.<a href="#section-1.1-14" class="pilcrow">¶</a></p>
<p id="section-1.1-15"><strong>Path Control</strong>: Path control is a property of a network architecture that gives endpoints the ability to select how their packets travel through the network. Path control is stronger than path transparency.<a href="#section-1.1-15" class="pilcrow">¶</a></p>
<p id="section-1.1-16"><strong>Path Segment</strong>: Path segments are derived from path segment construction beacons (PCBs). A path segment can be (1) an up segment (i.e. a path between a non-core AS and a core AS in the same ISD), (2) a down segment (i.e. the same as an up segment, but in the opposite direction), or (3) a core segment (i.e., a path between core ASes). Up to three path segments can be used to create a forwarding path.<a href="#section-1.1-16" class="pilcrow">¶</a></p>
<p id="section-1.1-17"><strong>Path-Segment Construction Beacon (PCB)</strong>: Core AS control planes generate PCBs to explore paths within their isolation domain (ISD) and among different ISDs. ASes further propagate selected PCBs to their neighboring ASes. As a PCB traverses the network, it carries path segments, which can subsequently be used for traffic forwarding.<a href="#section-1.1-17" class="pilcrow">¶</a></p>
<p id="section-1.1-18"><strong>Path Transparency</strong>: Path transparency is a property of a network architecture that gives endpoints full visibility over the network paths their packets are taking. Path transparency is weaker than path control.<a href="#section-1.1-18" class="pilcrow">¶</a></p>
<p id="section-1.1-19"><strong>Peering Link</strong>: A link between two SCION border routers of different ASes that can be used as a shortcut. Peering link information is added to segment information during the beaconing process and used to shorten paths while assembling them from segments. It is possible to construct a path out of only two partial segments which top-most hops are joined by a peering link. Two peering ASes may be in different ISDs and may exist between any ASes, including core ASes.<a href="#section-1.1-19" class="pilcrow">¶</a></p>
<p id="section-1.1-20"><strong>SCMP</strong>: A signaling protocol analogous to the Internet Control Message Protocol (ICMP). This is described in <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>.<a href="#section-1.1-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1.2">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-1.3">
        <h3 id="name-overview">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.3-1">The SCION Data Plane forwards inter-domain packets between SCION-enabled ASes. SCION routers are normally deployed at the edge of an AS, and peer with neighbor SCION routers. Inter-domain forwarding is based on end-to-end path information contained in the packet header. This path information consists of a sequence of Hop Fields (HFs). Each Hop Field corresponds to an AS on the path, and it includes an ingress interface ID as well as an egress interface ID, which unequivocally identifies the ingress and egress interfaces within the AS. The information is authenticated with a Message Authentication Code (MAC) to prevent forgery.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">This concept allows SCION routers to forward packets to a neighbor AS without inspecting the destination address and also without consulting an inter-domain forwarding table. Intra-domain forwarding and routing are based on existing mechanisms (e.g. IP). A SCION border router reuses existing intra-domain infrastructure to communicate to other SCION routers or SCION endpoints within its AS. The last SCION router at the destination AS therefore uses the destination address to forward the packet to the appropriate local endpoint.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">This SCION design choice has the following advantages:<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-4.1">
            <p id="section-1.3-4.1.1">It provides control and transparency over forwarding paths to endpoints.<a href="#section-1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.2">
            <p id="section-1.3-4.2.1">It simplifies the packet processing at routers. Instead of having to perform longest prefix matching on IP addresses which requires expensive hardware and substantial amounts of energy, a router can simply access the next hop from the packet header after having verified the authenticity of the Hop Field's MAC.<a href="#section-1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="inter-and-intra-domain-forwarding">
<section id="section-1.3.1">
          <h4 id="name-inter-and-intra-domain-forw">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-inter-and-intra-domain-forw" class="section-name selfRef">Inter- and Intra-Domain Forwarding</a>
          </h4>
<p id="section-1.3.1-1">As SCION is an inter-domain network architecture, it is not concerned with intra-domain forwarding. This corresponds to the general practice today where BGP and IP are used for inter-domain routing and forwarding, respectively, but ASes use an intra-domain protocol of their choice - for example OSPF or IS-IS for routing and IP, MPLS, and various Layer 2 protocols for forwarding. In fact, even if ASes use IP forwarding internally today, they typically encapsulate the original IP packet they receive at the edge of their network into another IP packet with the destination address set to the egress border router, to avoid full inter-domain forwarding tables at internal routers.<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-1.3.1-2">SCION emphasizes this separation as it is used exclusively for inter-domain forwarding; re-using the intra-domain network fabric to provide connectivity amongst all SCION infrastructure services, border routers, and endpoints. As a consequence, minimal change to the infrastructure is required for ISPs when deploying SCION. In practice, in most existing SCION deployments, SCION routers communicate among themselves and with endpoints by enclosing the SCION header inside an UDP/IPv6 or UDP/IPv4 packet. The choice of using an UDP/IP as an intra-domain protocol between routers was driven by the need to maximize compatibility with existing networks. This does not exclude that a SCION packet may be enclosed directly on top of a L2 protocol, since the choice of intra-domain protocol is AS specific.<a href="#section-1.3.1-2" class="pilcrow">¶</a></p>
<p id="section-1.3.1-3"><a href="#_figure-30" class="auto internal xref">Figure 1</a> shows the SCION header within the protocol stack, in an AS where the SCION deployment uses UDP/IP as an intra-domain protocol. A similar model may be used for inter-domain links, depending on the individual choice of the two interconnected SCION router operators. A full example of the life of a SCION packet is later presented in <a href="#life-of-a-packet" class="auto internal xref">Section 3</a>. A list of currently used upper layer protocols on top of SCION is presented in <a href="#protnum" class="auto internal xref">Appendix "Assigned SCION Protocol Numbers"</a>.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
<span id="name-the-scion-header-within-the"></span><div id="_figure-30">
<figure id="figure-1">
            <div id="section-1.3.1-4.1">
              <div class="alignLeft art-svg artwork" id="section-1.3.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="330" height="235" viewBox="0 0 330.0 235.0">
                  <path d="M 2.878906 13.319336 L 2.878906 6.412109 L 6.729980 6.412109 L 6.729980 7.335938 L 3.738281 7.335938 L 3.738281 13.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 26.319336 L 2.878906 12.300781 L 3.738281 12.300781 L 3.738281 26.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 39.319336 L 2.878906 25.300781 L 3.738281 25.300781 L 3.738281 39.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 52.319336 L 2.878906 38.300781 L 3.738281 38.300781 L 3.738281 52.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 65.319336 L 2.878906 51.300781 L 3.738281 51.300781 L 3.738281 65.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 78.319336 L 2.878906 64.300781 L 3.738281 64.300781 L 3.738281 78.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 91.319336 L 2.878906 77.300781 L 3.738281 77.300781 L 3.738281 91.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 104.319336 L 2.878906 90.300781 L 3.738281 90.300781 L 3.738281 97.412109 L 6.729980 97.412109 L 6.729980 98.335938 L 3.738281 98.335938 L 3.738281 104.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 117.319336 L 2.878906 103.300781 L 3.738281 103.300781 L 3.738281 117.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 130.319336 L 2.878906 116.300781 L 3.738281 116.300781 L 3.738281 130.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 143.319336 L 2.878906 129.300781 L 3.738281 129.300781 L 3.738281 143.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 156.319336 L 2.878906 142.300781 L 3.738281 142.300781 L 3.738281 149.412109 L 6.729980 149.412109 L 6.729980 150.335938 L 3.738281 150.335938 L 3.738281 156.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 169.319336 L 2.878906 155.300781 L 3.738281 155.300781 L 3.738281 169.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 182.319336 L 2.878906 168.300781 L 3.738281 168.300781 L 3.738281 175.412109 L 6.729980 175.412109 L 6.729980 176.335938 L 3.738281 176.335938 L 3.738281 182.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 195.319336 L 2.878906 181.300781 L 3.738281 181.300781 L 3.738281 195.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 208.319336 L 2.878906 194.300781 L 3.738281 194.300781 L 3.738281 201.412109 L 6.729980 201.412109 L 6.729980 202.335938 L 3.738281 202.335938 L 3.738281 208.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 221.319336 L 2.878906 207.300781 L 3.738281 207.300781 L 3.738281 221.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 2.878906 228.335938 L 2.878906 220.300781 L 3.738281 220.300781 L 3.738281 227.412109 L 6.729980 227.412109 L 6.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 6.892578 228.335938 L 6.892578 227.412109 L 13.729980 227.412109 L 13.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 13.892578 228.335938 L 13.892578 227.412109 L 20.729980 227.412109 L 20.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 20.892578 228.335938 L 20.892578 227.412109 L 27.729980 227.412109 L 27.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 27.892578 228.335938 L 27.892578 227.412109 L 34.729980 227.412109 L 34.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 34.892578 228.335938 L 34.892578 227.412109 L 41.729980 227.412109 L 41.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 41.892578 228.335938 L 41.892578 227.412109 L 48.729980 227.412109 L 48.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 48.892578 228.335938 L 48.892578 227.412109 L 55.729980 227.412109 L 55.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 55.892578 228.335938 L 55.892578 227.412109 L 62.729980 227.412109 L 62.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 62.892578 228.335938 L 62.892578 227.412109 L 69.729980 227.412109 L 69.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 69.892578 228.335938 L 69.892578 227.412109 L 76.729980 227.412109 L 76.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 76.892578 228.335938 L 76.892578 227.412109 L 83.729980 227.412109 L 83.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 83.892578 228.335938 L 83.892578 227.412109 L 90.729980 227.412109 L 90.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 90.892578 228.335938 L 90.892578 227.412109 L 97.729980 227.412109 L 97.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 97.892578 228.335938 L 97.892578 227.412109 L 104.729980 227.412109 L 104.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 104.892578 228.335938 L 104.892578 227.412109 L 111.729980 227.412109 L 111.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 111.892578 228.335938 L 111.892578 227.412109 L 118.729980 227.412109 L 118.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 118.892578 228.335938 L 118.892578 227.412109 L 125.729980 227.412109 L 125.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 125.892578 228.335938 L 125.892578 227.412109 L 132.729980 227.412109 L 132.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.892578 228.335938 L 132.892578 227.412109 L 139.729980 227.412109 L 139.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.892578 228.335938 L 139.892578 227.412109 L 146.729980 227.412109 L 146.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 146.892578 228.335938 L 146.892578 227.412109 L 153.729980 227.412109 L 153.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 153.892578 228.335938 L 153.892578 227.412109 L 160.729980 227.412109 L 160.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 160.892578 228.335938 L 160.892578 227.412109 L 167.729980 227.412109 L 167.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 167.892578 228.335938 L 167.892578 227.412109 L 174.729980 227.412109 L 174.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 174.892578 228.335938 L 174.892578 227.412109 L 181.729980 227.412109 L 181.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 181.892578 228.335938 L 181.892578 227.412109 L 188.729980 227.412109 L 188.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 188.892578 228.335938 L 188.892578 227.412109 L 195.729980 227.412109 L 195.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 195.892578 228.335938 L 195.892578 227.412109 L 202.729980 227.412109 L 202.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 202.892578 228.335938 L 202.892578 227.412109 L 209.729980 227.412109 L 209.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 209.892578 228.335938 L 209.892578 227.412109 L 212.878906 227.412109 L 212.878906 220.300781 L 213.738281 220.300781 L 213.738281 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 217.032227 228.142578 L 223.590332 224.866211 L 223.590332 231.418945 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 223.892578 228.335938 L 223.892578 227.412109 L 230.729980 227.412109 L 230.729980 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 230.892578 228.335938 L 230.892578 227.412109 L 233.878906 227.412109 L 233.878906 220.300781 L 234.738281 220.300781 L 234.738281 228.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 71.154785 209.980957 L 72.245117 209.980957 L 72.245117 217.086914 L 76.117676 217.086914 L 76.117676 218.000000 L 71.154785 218.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 78.697266 212.005859 L 81.227051 212.005859 L 81.227051 217.231934 L 83.187500 217.231934 L 83.187500 218.000000 L 78.278320 218.000000 L 78.278320 217.231934 L 80.238770 217.231934 L 80.238770 212.773926 L 78.697266 212.773926 Z M 80.238770 209.669434 L 81.227051 209.669434 L 81.227051 210.915527 L 80.238770 210.915527 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 89.645020 214.272461 L 89.645020 218.000000 L 88.651367 218.000000 L 88.651367 214.272461 Q 88.651367 213.461426 88.366699 213.080078 Q 88.082031 212.698730 87.475098 212.698730 Q 86.782227 212.698730 86.408936 213.190186 Q 86.035645 213.681641 86.035645 214.600098 L 86.035645 218.000000 L 85.047363 218.000000 L 85.047363 211.984375 L 86.035645 211.984375 L 86.035645 212.886719 Q 86.298828 212.371094 86.750000 212.105225 Q 87.201172 211.839355 87.818848 211.839355 Q 88.737305 211.839355 89.191162 212.443604 Q 89.645020 213.047852 89.645020 214.272461 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 92.267578 209.642578 L 93.288086 209.642578 L 93.288086 214.481934 L 95.882324 211.984375 L 97.085449 211.984375 L 94.716797 214.250977 L 97.456055 218.000000 L 96.247559 218.000000 L 94.023926 214.895508 L 93.288086 215.588379 L 93.288086 218.000000 L 92.267578 218.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 106.154785 209.980957 L 107.245117 209.980957 L 107.245117 217.086914 L 111.117676 217.086914 L 111.117676 218.000000 L 106.154785 218.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 115.770508 214.976074 L 115.442871 214.976074 Q 114.578125 214.976074 114.140381 215.279541 Q 113.702637 215.583008 113.702637 216.184570 Q 113.702637 216.727051 114.030273 217.027832 Q 114.357910 217.328613 114.937988 217.328613 Q 115.754395 217.328613 116.221680 216.761963 Q 116.688965 216.195312 116.694336 215.196289 L 116.694336 214.976074 Z M 117.687988 214.567871 L 117.687988 218.000000 L 116.694336 218.000000 L 116.694336 217.108398 Q 116.377441 217.645508 115.896729 217.900635 Q 115.416016 218.155762 114.728516 218.155762 Q 113.810059 218.155762 113.262207 217.637451 Q 112.714355 217.119141 112.714355 216.249023 Q 112.714355 215.244629 113.388428 214.723633 Q 114.062500 214.202637 115.367676 214.202637 L 116.694336 214.202637 L 116.694336 214.046875 Q 116.688965 213.327148 116.329102 213.002197 Q 115.969238 212.677246 115.179688 212.677246 Q 114.674805 212.677246 114.159180 212.822266 Q 113.643555 212.967285 113.154785 213.246582 L 113.154785 212.258301 Q 113.702637 212.048828 114.204834 211.944092 Q 114.707031 211.839355 115.179688 211.839355 Q 115.926270 211.839355 116.455322 212.059570 Q 116.984375 212.279785 117.312012 212.720215 Q 117.516113 212.988770 117.602051 213.383545 Q 117.687988 213.778320 117.687988 214.567871 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 123.608398 216.066406 Q 123.361328 216.694824 122.979980 217.720703 Q 122.448242 219.138672 122.265625 219.450195 Q 122.018555 219.869141 121.647949 220.078613 Q 121.277344 220.288086 120.783203 220.288086 L 119.988281 220.288086 L 119.988281 219.460938 L 120.573730 219.460938 Q 121.008789 219.460938 121.255859 219.208496 Q 121.502930 218.956055 121.884277 217.903320 L 119.558594 211.984375 L 120.605957 211.984375 L 122.389160 216.689453 L 124.145508 211.984375 L 125.192871 211.984375 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.015625 214.498047 L 132.015625 214.981445 L 127.734863 214.981445 L 127.734863 215.013672 Q 127.691895 216.243652 128.204834 216.780762 Q 128.717773 217.317871 129.652344 217.317871 Q 130.125000 217.317871 130.640625 217.167480 Q 131.156250 217.017090 131.741699 216.710938 L 131.741699 217.693848 Q 131.177734 217.924805 130.654053 218.040283 Q 130.130371 218.155762 129.641602 218.155762 Q 128.239746 218.155762 127.450195 217.315186 Q 126.660645 216.474609 126.660645 214.997559 Q 126.660645 213.558105 127.434082 212.698730 Q 128.207520 211.839355 129.496582 211.839355 Q 130.645996 211.839355 131.309326 212.618164 Q 131.972656 213.396973 132.015625 214.498047 Z M 131.027344 214.208008 Q 130.962891 213.584961 130.573486 213.131104 Q 130.184082 212.677246 129.453613 212.677246 Q 128.739258 212.677246 128.277344 213.149902 Q 127.815430 213.622559 127.772461 214.213379 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.203613 213.225098 Q 138.886719 212.978027 138.559082 212.865234 Q 138.231445 212.752441 137.839355 212.752441 Q 136.915527 212.752441 136.426758 213.332520 Q 135.937988 213.912598 135.937988 215.008301 L 135.937988 218.000000 L 134.944336 218.000000 L 134.944336 211.984375 L 135.937988 211.984375 L 135.937988 213.160645 Q 136.185059 212.521484 136.697998 212.180420 Q 137.210938 211.839355 137.914551 211.839355 Q 138.279785 211.839355 138.596680 211.930664 Q 138.913574 212.021973 139.203613 212.215332 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 221.319336 L 212.878906 207.300781 L 213.738281 207.300781 L 213.738281 221.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 233.878906 221.319336 L 233.878906 207.300781 L 234.738281 207.300781 L 234.738281 221.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 6.892578 202.335938 L 6.892578 201.412109 L 13.729980 201.412109 L 13.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 13.892578 202.335938 L 13.892578 201.412109 L 20.729980 201.412109 L 20.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 20.892578 202.335938 L 20.892578 201.412109 L 27.729980 201.412109 L 27.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 27.892578 202.335938 L 27.892578 201.412109 L 34.729980 201.412109 L 34.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 34.892578 202.335938 L 34.892578 201.412109 L 41.729980 201.412109 L 41.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 41.892578 202.335938 L 41.892578 201.412109 L 48.729980 201.412109 L 48.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 48.892578 202.335938 L 48.892578 201.412109 L 55.729980 201.412109 L 55.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 55.892578 202.335938 L 55.892578 201.412109 L 62.729980 201.412109 L 62.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 62.892578 202.335938 L 62.892578 201.412109 L 69.729980 201.412109 L 69.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 69.892578 202.335938 L 69.892578 201.412109 L 76.729980 201.412109 L 76.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 76.892578 202.335938 L 76.892578 201.412109 L 83.729980 201.412109 L 83.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 83.892578 202.335938 L 83.892578 201.412109 L 90.729980 201.412109 L 90.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 90.892578 202.335938 L 90.892578 201.412109 L 97.729980 201.412109 L 97.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 97.892578 202.335938 L 97.892578 201.412109 L 104.729980 201.412109 L 104.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 104.892578 202.335938 L 104.892578 201.412109 L 111.729980 201.412109 L 111.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 111.892578 202.335938 L 111.892578 201.412109 L 118.729980 201.412109 L 118.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 118.892578 202.335938 L 118.892578 201.412109 L 125.729980 201.412109 L 125.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 125.892578 202.335938 L 125.892578 201.412109 L 132.729980 201.412109 L 132.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.892578 202.335938 L 132.892578 201.412109 L 139.729980 201.412109 L 139.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.892578 202.335938 L 139.892578 201.412109 L 146.729980 201.412109 L 146.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 146.892578 202.335938 L 146.892578 201.412109 L 153.729980 201.412109 L 153.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 153.892578 202.335938 L 153.892578 201.412109 L 160.729980 201.412109 L 160.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 160.892578 202.335938 L 160.892578 201.412109 L 167.729980 201.412109 L 167.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 167.892578 202.335938 L 167.892578 201.412109 L 174.729980 201.412109 L 174.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 174.892578 202.335938 L 174.892578 201.412109 L 181.729980 201.412109 L 181.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 181.892578 202.335938 L 181.892578 201.412109 L 188.729980 201.412109 L 188.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 188.892578 202.335938 L 188.892578 201.412109 L 195.729980 201.412109 L 195.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 195.892578 202.335938 L 195.892578 201.412109 L 202.729980 201.412109 L 202.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 202.892578 202.335938 L 202.892578 201.412109 L 209.729980 201.412109 L 209.729980 202.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 208.319336 L 212.878906 202.335938 L 209.892578 202.335938 L 209.892578 201.412109 L 212.878906 201.412109 L 212.878906 194.300781 L 213.738281 194.300781 L 213.738281 208.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 233.878906 208.319336 L 233.878906 194.300781 L 234.738281 194.300781 L 234.738281 208.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 99.079590 183.980957 L 103.532227 183.980957 L 103.532227 184.894043 L 101.851074 184.894043 L 101.851074 191.086914 L 103.532227 191.086914 L 103.532227 192.000000 L 99.079590 192.000000 L 99.079590 191.086914 L 100.760742 191.086914 L 100.760742 184.894043 L 99.079590 184.894043 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 107.143066 184.872559 L 107.143066 187.885742 L 108.399902 187.885742 Q 109.151855 187.885742 109.573486 187.488281 Q 109.995117 187.090820 109.995117 186.376465 Q 109.995117 185.662109 109.576172 185.267334 Q 109.157227 184.872559 108.399902 184.872559 Z M 106.058105 183.980957 L 108.399902 183.980957 Q 109.742676 183.980957 110.435547 184.590576 Q 111.128418 185.200195 111.128418 186.376465 Q 111.128418 187.563477 110.438232 188.170410 Q 109.748047 188.777344 108.399902 188.777344 L 107.143066 188.777344 L 107.143066 192.000000 L 106.058105 192.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 195.319336 L 212.878906 181.300781 L 213.738281 181.300781 L 213.738281 195.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 233.878906 195.319336 L 233.878906 181.300781 L 234.738281 181.300781 L 234.738281 195.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 254.014160 191.242676 L 254.014160 194.288086 L 253.020508 194.288086 L 253.020508 185.984375 L 254.014160 185.984375 L 254.014160 186.752441 Q 254.261230 186.306641 254.672119 186.072998 Q 255.083008 185.839355 255.620117 185.839355 Q 256.710449 185.839355 257.330811 186.682617 Q 257.951172 187.525879 257.951172 189.019043 Q 257.951172 190.485352 257.328125 191.320557 Q 256.705078 192.155762 255.620117 192.155762 Q 255.072266 192.155762 254.661377 191.922119 Q 254.250488 191.688477 254.014160 191.242676 Z M 256.914551 188.997559 Q 256.914551 187.848145 256.552002 187.262695 Q 256.189453 186.677246 255.475098 186.677246 Q 254.755371 186.677246 254.384766 187.265381 Q 254.014160 187.853516 254.014160 188.997559 Q 254.014160 190.136230 254.384766 190.727051 Q 254.755371 191.317871 255.475098 191.317871 Q 256.189453 191.317871 256.552002 190.732422 Q 256.914551 190.146973 256.914551 188.997559 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 265.203613 187.225098 Q 264.886719 186.978027 264.559082 186.865234 Q 264.231445 186.752441 263.839355 186.752441 Q 262.915527 186.752441 262.426758 187.332520 Q 261.937988 187.912598 261.937988 189.008301 L 261.937988 192.000000 L 260.944336 192.000000 L 260.944336 185.984375 L 261.937988 185.984375 L 261.937988 187.160645 Q 262.185059 186.521484 262.697998 186.180420 Q 263.210938 185.839355 263.914551 185.839355 Q 264.279785 185.839355 264.596680 185.930664 Q 264.913574 186.021973 265.203613 186.215332 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 269.308594 186.677246 Q 268.556641 186.677246 268.169922 187.262695 Q 267.783203 187.848145 267.783203 188.997559 Q 267.783203 190.141602 268.169922 190.729736 Q 268.556641 191.317871 269.308594 191.317871 Q 270.065918 191.317871 270.452637 190.729736 Q 270.839355 190.141602 270.839355 188.997559 Q 270.839355 187.848145 270.452637 187.262695 Q 270.065918 186.677246 269.308594 186.677246 Z M 269.308594 185.839355 Q 270.560059 185.839355 271.223389 186.650391 Q 271.886719 187.461426 271.886719 188.997559 Q 271.886719 190.539062 271.226074 191.347412 Q 270.565430 192.155762 269.308594 192.155762 Q 268.057129 192.155762 267.396484 191.347412 Q 266.735840 190.539062 266.735840 188.997559 Q 266.735840 187.461426 267.396484 186.650391 Q 268.057129 185.839355 269.308594 185.839355 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 276.297852 184.276367 L 276.297852 185.984375 L 278.542969 185.984375 L 278.542969 186.752441 L 276.297852 186.752441 L 276.297852 190.018066 Q 276.297852 190.684082 276.550293 190.947266 Q 276.802734 191.210449 277.431152 191.210449 L 278.542969 191.210449 L 278.542969 192.000000 L 277.334473 192.000000 Q 276.222656 192.000000 275.766113 191.554199 Q 275.309570 191.108398 275.309570 190.018066 L 275.309570 186.752441 L 273.703613 186.752441 L 273.703613 185.984375 L 275.309570 185.984375 L 275.309570 184.276367 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 283.308594 186.677246 Q 282.556641 186.677246 282.169922 187.262695 Q 281.783203 187.848145 281.783203 188.997559 Q 281.783203 190.141602 282.169922 190.729736 Q 282.556641 191.317871 283.308594 191.317871 Q 284.065918 191.317871 284.452637 190.729736 Q 284.839355 190.141602 284.839355 188.997559 Q 284.839355 187.848145 284.452637 187.262695 Q 284.065918 186.677246 283.308594 186.677246 Z M 283.308594 185.839355 Q 284.560059 185.839355 285.223389 186.650391 Q 285.886719 187.461426 285.886719 188.997559 Q 285.886719 190.539062 285.226074 191.347412 Q 284.565430 192.155762 283.308594 192.155762 Q 282.057129 192.155762 281.396484 191.347412 Q 280.735840 190.539062 280.735840 188.997559 Q 280.735840 187.461426 281.396484 186.650391 Q 282.057129 185.839355 283.308594 185.839355 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 292.698730 191.693848 Q 292.301270 191.924805 291.879639 192.040283 Q 291.458008 192.155762 291.017578 192.155762 Q 289.621094 192.155762 288.834229 191.317871 Q 288.047363 190.479980 288.047363 188.997559 Q 288.047363 187.515137 288.834229 186.677246 Q 289.621094 185.839355 291.017578 185.839355 Q 291.452637 185.839355 291.866211 185.952148 Q 292.279785 186.064941 292.698730 186.301270 L 292.698730 187.337891 Q 292.306641 186.988770 291.911865 186.833008 Q 291.517090 186.677246 291.017578 186.677246 Q 290.088379 186.677246 289.588867 187.278809 Q 289.089355 187.880371 289.089355 188.997559 Q 289.089355 190.109375 289.591553 190.713623 Q 290.093750 191.317871 291.017578 191.317871 Q 291.533203 191.317871 291.941406 191.159424 Q 292.349609 191.000977 292.698730 190.667969 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 297.308594 186.677246 Q 296.556641 186.677246 296.169922 187.262695 Q 295.783203 187.848145 295.783203 188.997559 Q 295.783203 190.141602 296.169922 190.729736 Q 296.556641 191.317871 297.308594 191.317871 Q 298.065918 191.317871 298.452637 190.729736 Q 298.839355 190.141602 298.839355 188.997559 Q 298.839355 187.848145 298.452637 187.262695 Q 298.065918 186.677246 297.308594 186.677246 Z M 297.308594 185.839355 Q 298.560059 185.839355 299.223389 186.650391 Q 299.886719 187.461426 299.886719 188.997559 Q 299.886719 190.539062 299.226074 191.347412 Q 298.565430 192.155762 297.308594 192.155762 Q 296.057129 192.155762 295.396484 191.347412 Q 294.735840 190.539062 294.735840 188.997559 Q 294.735840 187.461426 295.396484 186.650391 Q 296.057129 185.839355 297.308594 185.839355 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 304.861816 189.824707 Q 304.861816 190.490723 305.106201 190.829102 Q 305.350586 191.167480 305.828613 191.167480 L 306.983398 191.167480 L 306.983398 192.000000 L 305.731934 192.000000 Q 304.845703 192.000000 304.359619 191.433350 Q 303.873535 190.866699 303.873535 189.824707 L 303.873535 184.383789 L 302.289062 184.383789 L 302.289062 183.610352 L 304.861816 183.610352 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 6.892578 176.335938 L 6.892578 175.412109 L 13.729980 175.412109 L 13.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 13.892578 176.335938 L 13.892578 175.412109 L 20.729980 175.412109 L 20.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 20.892578 176.335938 L 20.892578 175.412109 L 27.729980 175.412109 L 27.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 27.892578 176.335938 L 27.892578 175.412109 L 34.729980 175.412109 L 34.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 34.892578 176.335938 L 34.892578 175.412109 L 41.729980 175.412109 L 41.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 41.892578 176.335938 L 41.892578 175.412109 L 48.729980 175.412109 L 48.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 48.892578 176.335938 L 48.892578 175.412109 L 55.729980 175.412109 L 55.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 55.892578 176.335938 L 55.892578 175.412109 L 62.729980 175.412109 L 62.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 62.892578 176.335938 L 62.892578 175.412109 L 69.729980 175.412109 L 69.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 69.892578 176.335938 L 69.892578 175.412109 L 76.729980 175.412109 L 76.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 76.892578 176.335938 L 76.892578 175.412109 L 83.729980 175.412109 L 83.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 83.892578 176.335938 L 83.892578 175.412109 L 90.729980 175.412109 L 90.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 90.892578 176.335938 L 90.892578 175.412109 L 97.729980 175.412109 L 97.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 97.892578 176.335938 L 97.892578 175.412109 L 104.729980 175.412109 L 104.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 104.892578 176.335938 L 104.892578 175.412109 L 111.729980 175.412109 L 111.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 111.892578 176.335938 L 111.892578 175.412109 L 118.729980 175.412109 L 118.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 118.892578 176.335938 L 118.892578 175.412109 L 125.729980 175.412109 L 125.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 125.892578 176.335938 L 125.892578 175.412109 L 132.729980 175.412109 L 132.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.892578 176.335938 L 132.892578 175.412109 L 139.729980 175.412109 L 139.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.892578 176.335938 L 139.892578 175.412109 L 146.729980 175.412109 L 146.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 146.892578 176.335938 L 146.892578 175.412109 L 153.729980 175.412109 L 153.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 153.892578 176.335938 L 153.892578 175.412109 L 160.729980 175.412109 L 160.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 160.892578 176.335938 L 160.892578 175.412109 L 167.729980 175.412109 L 167.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 167.892578 176.335938 L 167.892578 175.412109 L 174.729980 175.412109 L 174.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 174.892578 176.335938 L 174.892578 175.412109 L 181.729980 175.412109 L 181.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 181.892578 176.335938 L 181.892578 175.412109 L 188.729980 175.412109 L 188.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 188.892578 176.335938 L 188.892578 175.412109 L 195.729980 175.412109 L 195.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 195.892578 176.335938 L 195.892578 175.412109 L 202.729980 175.412109 L 202.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 202.892578 176.335938 L 202.892578 175.412109 L 209.729980 175.412109 L 209.729980 176.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 182.319336 L 212.878906 176.335938 L 209.892578 176.335938 L 209.892578 175.412109 L 212.878906 175.412109 L 212.878906 168.300781 L 213.738281 168.300781 L 213.738281 182.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 233.878906 182.319336 L 233.878906 168.300781 L 234.738281 168.300781 L 234.738281 182.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 246.079590 170.980957 L 250.532227 170.980957 L 250.532227 171.894043 L 248.851074 171.894043 L 248.851074 178.086914 L 250.532227 178.086914 L 250.532227 179.000000 L 246.079590 179.000000 L 246.079590 178.086914 L 247.760742 178.086914 L 247.760742 171.894043 L 246.079590 171.894043 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 257.645020 175.272461 L 257.645020 179.000000 L 256.651367 179.000000 L 256.651367 175.272461 Q 256.651367 174.461426 256.366699 174.080078 Q 256.082031 173.698730 255.475098 173.698730 Q 254.782227 173.698730 254.408936 174.190186 Q 254.035645 174.681641 254.035645 175.600098 L 254.035645 179.000000 L 253.047363 179.000000 L 253.047363 172.984375 L 254.035645 172.984375 L 254.035645 173.886719 Q 254.298828 173.371094 254.750000 173.105225 Q 255.201172 172.839355 255.818848 172.839355 Q 256.737305 172.839355 257.191162 173.443604 Q 257.645020 174.047852 257.645020 175.272461 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 262.297852 171.276367 L 262.297852 172.984375 L 264.542969 172.984375 L 264.542969 173.752441 L 262.297852 173.752441 L 262.297852 177.018066 Q 262.297852 177.684082 262.550293 177.947266 Q 262.802734 178.210449 263.431152 178.210449 L 264.542969 178.210449 L 264.542969 179.000000 L 263.334473 179.000000 Q 262.222656 179.000000 261.766113 178.554199 Q 261.309570 178.108398 261.309570 177.018066 L 261.309570 173.752441 L 259.703613 173.752441 L 259.703613 172.984375 L 261.309570 172.984375 L 261.309570 171.276367 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 272.203613 174.225098 Q 271.886719 173.978027 271.559082 173.865234 Q 271.231445 173.752441 270.839355 173.752441 Q 269.915527 173.752441 269.426758 174.332520 Q 268.937988 174.912598 268.937988 176.008301 L 268.937988 179.000000 L 267.944336 179.000000 L 267.944336 172.984375 L 268.937988 172.984375 L 268.937988 174.160645 Q 269.185059 173.521484 269.697998 173.180420 Q 270.210938 172.839355 270.914551 172.839355 Q 271.279785 172.839355 271.596680 172.930664 Q 271.913574 173.021973 272.203613 173.215332 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 276.770508 175.976074 L 276.442871 175.976074 Q 275.578125 175.976074 275.140381 176.279541 Q 274.702637 176.583008 274.702637 177.184570 Q 274.702637 177.727051 275.030273 178.027832 Q 275.357910 178.328613 275.937988 178.328613 Q 276.754395 178.328613 277.221680 177.761963 Q 277.688965 177.195312 277.694336 176.196289 L 277.694336 175.976074 Z M 278.687988 175.567871 L 278.687988 179.000000 L 277.694336 179.000000 L 277.694336 178.108398 Q 277.377441 178.645508 276.896729 178.900635 Q 276.416016 179.155762 275.728516 179.155762 Q 274.810059 179.155762 274.262207 178.637451 Q 273.714355 178.119141 273.714355 177.249023 Q 273.714355 176.244629 274.388428 175.723633 Q 275.062500 175.202637 276.367676 175.202637 L 277.694336 175.202637 L 277.694336 175.046875 Q 277.688965 174.327148 277.329102 174.002197 Q 276.969238 173.677246 276.179688 173.677246 Q 275.674805 173.677246 275.159180 173.822266 Q 274.643555 173.967285 274.154785 174.246582 L 274.154785 173.258301 Q 274.702637 173.048828 275.204834 172.944092 Q 275.707031 172.839355 276.179688 172.839355 Q 276.926270 172.839355 277.455322 173.059570 Q 277.984375 173.279785 278.312012 173.720215 Q 278.516113 173.988770 278.602051 174.383545 Q 278.687988 174.778320 278.687988 175.567871 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 280.547852 175.111328 L 286.241211 175.111328 L 286.241211 176.019043 L 280.547852 176.019043 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 291.608398 173.752441 L 291.608398 170.642578 L 292.596680 170.642578 L 292.596680 179.000000 L 291.608398 179.000000 L 291.608398 178.242676 Q 291.361328 178.688477 290.950439 178.922119 Q 290.539551 179.155762 290.002441 179.155762 Q 288.912109 179.155762 288.286377 178.309814 Q 287.660645 177.463867 287.660645 175.976074 Q 287.660645 174.509766 288.289062 173.674561 Q 288.917480 172.839355 290.002441 172.839355 Q 290.544922 172.839355 290.958496 173.072998 Q 291.372070 173.306641 291.608398 173.752441 Z M 288.702637 175.997559 Q 288.702637 177.146973 289.067871 177.732422 Q 289.433105 178.317871 290.147461 178.317871 Q 290.861816 178.317871 291.235107 177.727051 Q 291.608398 177.136230 291.608398 175.997559 Q 291.608398 174.853516 291.235107 174.265381 Q 290.861816 173.677246 290.147461 173.677246 Q 289.433105 173.677246 289.067871 174.262695 Q 288.702637 174.848145 288.702637 175.997559 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 297.308594 173.677246 Q 296.556641 173.677246 296.169922 174.262695 Q 295.783203 174.848145 295.783203 175.997559 Q 295.783203 177.141602 296.169922 177.729736 Q 296.556641 178.317871 297.308594 178.317871 Q 298.065918 178.317871 298.452637 177.729736 Q 298.839355 177.141602 298.839355 175.997559 Q 298.839355 174.848145 298.452637 174.262695 Q 298.065918 173.677246 297.308594 173.677246 Z M 297.308594 172.839355 Q 298.560059 172.839355 299.223389 173.650391 Q 299.886719 174.461426 299.886719 175.997559 Q 299.886719 177.539062 299.226074 178.347412 Q 298.565430 179.155762 297.308594 179.155762 Q 296.057129 179.155762 295.396484 178.347412 Q 294.735840 177.539062 294.735840 175.997559 Q 294.735840 174.461426 295.396484 173.650391 Q 296.057129 172.839355 297.308594 172.839355 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 304.630859 173.596680 Q 304.813477 173.209961 305.095459 173.024658 Q 305.377441 172.839355 305.774902 172.839355 Q 306.500000 172.839355 306.798096 173.400635 Q 307.096191 173.961914 307.096191 175.514160 L 307.096191 179.000000 L 306.193848 179.000000 L 306.193848 175.557129 Q 306.193848 174.284180 306.051514 173.975342 Q 305.909180 173.666504 305.533203 173.666504 Q 305.103516 173.666504 304.945068 173.996826 Q 304.786621 174.327148 304.786621 175.557129 L 304.786621 179.000000 L 303.884277 179.000000 L 303.884277 175.557129 Q 303.884277 174.268066 303.731201 173.967285 Q 303.578125 173.666504 303.180664 173.666504 Q 302.788574 173.666504 302.635498 173.996826 Q 302.482422 174.327148 302.482422 175.557129 L 302.482422 179.000000 L 301.585449 179.000000 L 301.585449 172.984375 L 302.482422 172.984375 L 302.482422 173.500000 Q 302.659668 173.177734 302.925537 173.008545 Q 303.191406 172.839355 303.529785 172.839355 Q 303.937988 172.839355 304.209229 173.027344 Q 304.480469 173.215332 304.630859 173.596680 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 311.770508 175.976074 L 311.442871 175.976074 Q 310.578125 175.976074 310.140381 176.279541 Q 309.702637 176.583008 309.702637 177.184570 Q 309.702637 177.727051 310.030273 178.027832 Q 310.357910 178.328613 310.937988 178.328613 Q 311.754395 178.328613 312.221680 177.761963 Q 312.688965 177.195312 312.694336 176.196289 L 312.694336 175.976074 Z M 313.687988 175.567871 L 313.687988 179.000000 L 312.694336 179.000000 L 312.694336 178.108398 Q 312.377441 178.645508 311.896729 178.900635 Q 311.416016 179.155762 310.728516 179.155762 Q 309.810059 179.155762 309.262207 178.637451 Q 308.714355 178.119141 308.714355 177.249023 Q 308.714355 176.244629 309.388428 175.723633 Q 310.062500 175.202637 311.367676 175.202637 L 312.694336 175.202637 L 312.694336 175.046875 Q 312.688965 174.327148 312.329102 174.002197 Q 311.969238 173.677246 311.179688 173.677246 Q 310.674805 173.677246 310.159180 173.822266 Q 309.643555 173.967285 309.154785 174.246582 L 309.154785 173.258301 Q 309.702637 173.048828 310.204834 172.944092 Q 310.707031 172.839355 311.179688 172.839355 Q 311.926270 172.839355 312.455322 173.059570 Q 312.984375 173.279785 313.312012 173.720215 Q 313.516113 173.988770 313.602051 174.383545 Q 313.687988 174.778320 313.687988 175.567871 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 316.697266 173.005859 L 319.227051 173.005859 L 319.227051 178.231934 L 321.187500 178.231934 L 321.187500 179.000000 L 316.278320 179.000000 L 316.278320 178.231934 L 318.238770 178.231934 L 318.238770 173.773926 L 316.697266 173.773926 Z M 318.238770 170.669434 L 319.227051 170.669434 L 319.227051 171.915527 L 318.238770 171.915527 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 327.645020 175.272461 L 327.645020 179.000000 L 326.651367 179.000000 L 326.651367 175.272461 Q 326.651367 174.461426 326.366699 174.080078 Q 326.082031 173.698730 325.475098 173.698730 Q 324.782227 173.698730 324.408936 174.190186 Q 324.035645 174.681641 324.035645 175.600098 L 324.035645 179.000000 L 323.047363 179.000000 L 323.047363 172.984375 L 324.035645 172.984375 L 324.035645 173.886719 Q 324.298828 173.371094 324.750000 173.105225 Q 325.201172 172.839355 325.818848 172.839355 Q 326.737305 172.839355 327.191162 173.443604 Q 327.645020 174.047852 327.645020 175.272461 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 98.789551 162.922363 L 98.789551 157.980957 L 99.879883 157.980957 L 99.879883 163.416504 Q 99.879883 164.001953 99.912109 164.251709 Q 99.944336 164.501465 100.024902 164.635742 Q 100.196777 164.952637 100.521729 165.113770 Q 100.846680 165.274902 101.308594 165.274902 Q 101.775879 165.274902 102.098145 165.113770 Q 102.420410 164.952637 102.597656 164.635742 Q 102.678223 164.501465 102.710449 164.254395 Q 102.742676 164.007324 102.742676 163.427246 L 102.742676 157.980957 L 103.827637 157.980957 L 103.827637 162.922363 Q 103.827637 164.152344 103.674561 164.670654 Q 103.521484 165.188965 103.145508 165.527344 Q 102.791016 165.844238 102.334473 166.000000 Q 101.877930 166.155762 101.308594 166.155762 Q 100.744629 166.155762 100.288086 166.000000 Q 99.831543 165.844238 99.471680 165.527344 Q 99.101074 165.194336 98.945312 164.665283 Q 98.789551 164.136230 98.789551 162.922363 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 107.341797 165.108398 Q 108.711426 165.108398 109.253906 164.434326 Q 109.796387 163.760254 109.796387 161.998535 Q 109.796387 160.220703 109.256592 159.546631 Q 108.716797 158.872559 107.341797 158.872559 L 106.826172 158.872559 L 106.826172 165.108398 Z M 107.363281 157.980957 Q 109.200195 157.980957 110.070312 158.958496 Q 110.940430 159.936035 110.940430 161.998535 Q 110.940430 164.050293 110.070312 165.025146 Q 109.200195 166.000000 107.363281 166.000000 L 105.735840 166.000000 L 105.735840 157.980957 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 114.143066 158.872559 L 114.143066 161.885742 L 115.399902 161.885742 Q 116.151855 161.885742 116.573486 161.488281 Q 116.995117 161.090820 116.995117 160.376465 Q 116.995117 159.662109 116.576172 159.267334 Q 116.157227 158.872559 115.399902 158.872559 Z M 113.058105 157.980957 L 115.399902 157.980957 Q 116.742676 157.980957 117.435547 158.590576 Q 118.128418 159.200195 118.128418 160.376465 Q 118.128418 161.563477 117.438232 162.170410 Q 116.748047 162.777344 115.399902 162.777344 L 114.143066 162.777344 L 114.143066 166.000000 L 113.058105 166.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 169.319336 L 212.878906 155.300781 L 213.738281 155.300781 L 213.738281 169.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 233.878906 169.319336 L 233.878906 155.300781 L 234.738281 155.300781 L 234.738281 169.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 6.892578 150.335938 L 6.892578 149.412109 L 13.729980 149.412109 L 13.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 13.892578 150.335938 L 13.892578 149.412109 L 20.729980 149.412109 L 20.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 20.892578 150.335938 L 20.892578 149.412109 L 27.729980 149.412109 L 27.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 27.892578 150.335938 L 27.892578 149.412109 L 34.729980 149.412109 L 34.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 34.892578 150.335938 L 34.892578 149.412109 L 41.729980 149.412109 L 41.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 41.892578 150.335938 L 41.892578 149.412109 L 48.729980 149.412109 L 48.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 48.892578 150.335938 L 48.892578 149.412109 L 55.729980 149.412109 L 55.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 55.892578 150.335938 L 55.892578 149.412109 L 62.729980 149.412109 L 62.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 62.892578 150.335938 L 62.892578 149.412109 L 69.729980 149.412109 L 69.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 69.892578 150.335938 L 69.892578 149.412109 L 76.729980 149.412109 L 76.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 76.892578 150.335938 L 76.892578 149.412109 L 83.729980 149.412109 L 83.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 83.892578 150.335938 L 83.892578 149.412109 L 90.729980 149.412109 L 90.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 90.892578 150.335938 L 90.892578 149.412109 L 97.729980 149.412109 L 97.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 97.892578 150.335938 L 97.892578 149.412109 L 104.729980 149.412109 L 104.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 104.892578 150.335938 L 104.892578 149.412109 L 111.729980 149.412109 L 111.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 111.892578 150.335938 L 111.892578 149.412109 L 118.729980 149.412109 L 118.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 118.892578 150.335938 L 118.892578 149.412109 L 125.729980 149.412109 L 125.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 125.892578 150.335938 L 125.892578 149.412109 L 132.729980 149.412109 L 132.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.892578 150.335938 L 132.892578 149.412109 L 139.729980 149.412109 L 139.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.892578 150.335938 L 139.892578 149.412109 L 146.729980 149.412109 L 146.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 146.892578 150.335938 L 146.892578 149.412109 L 153.729980 149.412109 L 153.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 153.892578 150.335938 L 153.892578 149.412109 L 160.729980 149.412109 L 160.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 160.892578 150.335938 L 160.892578 149.412109 L 167.729980 149.412109 L 167.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 167.892578 150.335938 L 167.892578 149.412109 L 174.729980 149.412109 L 174.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 174.892578 150.335938 L 174.892578 149.412109 L 181.729980 149.412109 L 181.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 181.892578 150.335938 L 181.892578 149.412109 L 188.729980 149.412109 L 188.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 188.892578 150.335938 L 188.892578 149.412109 L 195.729980 149.412109 L 195.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 195.892578 150.335938 L 195.892578 149.412109 L 202.729980 149.412109 L 202.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 202.892578 150.335938 L 202.892578 149.412109 L 209.729980 149.412109 L 209.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 156.319336 L 212.878906 150.335938 L 209.892578 150.335938 L 209.892578 149.412109 L 212.878906 149.412109 L 212.878906 142.300781 L 213.738281 142.300781 L 213.738281 156.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 217.032227 150.142578 L 223.590332 146.866211 L 223.590332 153.418945 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 223.892578 150.335938 L 223.892578 149.412109 L 230.729980 149.412109 L 230.729980 150.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 233.878906 156.319336 L 233.878906 150.335938 L 230.892578 150.335938 L 230.892578 149.412109 L 234.738281 149.412109 L 234.738281 156.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 96.435547 119.254883 L 96.435547 120.355957 Q 95.941406 120.039062 95.444580 119.877930 Q 94.947754 119.716797 94.442871 119.716797 Q 93.674805 119.716797 93.229004 120.073975 Q 92.783203 120.431152 92.783203 121.038086 Q 92.783203 121.569824 93.075928 121.849121 Q 93.368652 122.128418 94.168945 122.316406 L 94.738281 122.445312 Q 95.866211 122.708496 96.381836 123.272461 Q 96.897461 123.836426 96.897461 124.808594 Q 96.897461 125.952637 96.188477 126.554199 Q 95.479492 127.155762 94.125977 127.155762 Q 93.562012 127.155762 92.992676 127.034912 Q 92.423340 126.914062 91.848633 126.672363 L 91.848633 125.517578 Q 92.466309 125.909668 93.016846 126.092285 Q 93.567383 126.274902 94.125977 126.274902 Q 94.947754 126.274902 95.404297 125.906982 Q 95.860840 125.539062 95.860840 124.878418 Q 95.860840 124.276855 95.546631 123.959961 Q 95.232422 123.643066 94.453613 123.471191 L 93.873535 123.336914 Q 92.756348 123.084473 92.251465 122.574219 Q 91.746582 122.063965 91.746582 121.204590 Q 91.746582 120.130371 92.468994 119.483154 Q 93.191406 118.835938 94.389160 118.835938 Q 94.851074 118.835938 95.361328 118.940674 Q 95.871582 119.045410 96.435547 119.254883 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 143.319336 L 212.878906 129.300781 L 213.738281 129.300781 L 213.738281 143.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 103.763184 126.715332 Q 103.349609 126.935547 102.914551 127.045654 Q 102.479492 127.155762 101.990723 127.155762 Q 100.449219 127.155762 99.597900 126.065430 Q 98.746582 124.975098 98.746582 122.998535 Q 98.746582 121.032715 99.603271 119.934326 Q 100.459961 118.835938 101.990723 118.835938 Q 102.479492 118.835938 102.914551 118.946045 Q 103.349609 119.056152 103.763184 119.276367 L 103.763184 120.388184 Q 103.365723 120.060547 102.909180 119.888672 Q 102.452637 119.716797 101.990723 119.716797 Q 100.932617 119.716797 100.406250 120.533203 Q 99.879883 121.349609 99.879883 122.998535 Q 99.879883 124.642090 100.406250 125.458496 Q 100.932617 126.274902 101.990723 126.274902 Q 102.463379 126.274902 102.917236 126.103027 Q 103.371094 125.931152 103.763184 125.603516 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 106.079590 118.980957 L 110.532227 118.980957 L 110.532227 119.894043 L 108.851074 119.894043 L 108.851074 126.086914 L 110.532227 126.086914 L 110.532227 127.000000 L 106.079590 127.000000 L 106.079590 126.086914 L 107.760742 126.086914 L 107.760742 119.894043 L 106.079590 119.894043 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 116.860840 122.998535 Q 116.860840 121.231445 116.498291 120.474121 Q 116.135742 119.716797 115.308594 119.716797 Q 114.486816 119.716797 114.124268 120.474121 Q 113.761719 121.231445 113.761719 122.998535 Q 113.761719 124.760254 114.124268 125.517578 Q 114.486816 126.274902 115.308594 126.274902 Q 116.135742 126.274902 116.498291 125.520264 Q 116.860840 124.765625 116.860840 122.998535 Z M 117.994141 122.998535 Q 117.994141 125.093262 117.330811 126.124512 Q 116.667480 127.155762 115.308594 127.155762 Q 113.949707 127.155762 113.289062 126.129883 Q 112.628418 125.104004 112.628418 122.998535 Q 112.628418 120.898438 113.291748 119.867188 Q 113.955078 118.835938 115.308594 118.835938 Q 116.667480 118.835938 117.330811 119.867188 Q 117.994141 120.898438 117.994141 122.998535 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 119.102051 119.007812 L 120.584473 119.007812 L 123.721191 125.587402 L 123.721191 119.007812 L 124.875977 119.007812 L 124.875977 127.000000 L 123.393555 127.000000 L 120.256836 120.420410 L 120.256836 127.000000 L 119.102051 127.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 130.319336 L 212.878906 116.300781 L 213.738281 116.300781 L 213.738281 130.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 117.319336 L 212.878906 103.300781 L 213.738281 103.300781 L 213.738281 117.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 6.892578 98.335938 L 6.892578 97.412109 L 13.729980 97.412109 L 13.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 13.892578 98.335938 L 13.892578 97.412109 L 20.729980 97.412109 L 20.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 20.892578 98.335938 L 20.892578 97.412109 L 27.729980 97.412109 L 27.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 27.892578 98.335938 L 27.892578 97.412109 L 34.729980 97.412109 L 34.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 34.892578 98.335938 L 34.892578 97.412109 L 41.729980 97.412109 L 41.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 41.892578 98.335938 L 41.892578 97.412109 L 48.729980 97.412109 L 48.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 48.892578 98.335938 L 48.892578 97.412109 L 55.729980 97.412109 L 55.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 55.892578 98.335938 L 55.892578 97.412109 L 62.729980 97.412109 L 62.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 62.892578 98.335938 L 62.892578 97.412109 L 69.729980 97.412109 L 69.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 69.892578 98.335938 L 69.892578 97.412109 L 76.729980 97.412109 L 76.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 76.892578 98.335938 L 76.892578 97.412109 L 83.729980 97.412109 L 83.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 83.892578 98.335938 L 83.892578 97.412109 L 90.729980 97.412109 L 90.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 90.892578 98.335938 L 90.892578 97.412109 L 97.729980 97.412109 L 97.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 97.892578 98.335938 L 97.892578 97.412109 L 104.729980 97.412109 L 104.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 104.892578 98.335938 L 104.892578 97.412109 L 111.729980 97.412109 L 111.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 111.892578 98.335938 L 111.892578 97.412109 L 118.729980 97.412109 L 118.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 118.892578 98.335938 L 118.892578 97.412109 L 125.729980 97.412109 L 125.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 125.892578 98.335938 L 125.892578 97.412109 L 132.729980 97.412109 L 132.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.892578 98.335938 L 132.892578 97.412109 L 139.729980 97.412109 L 139.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.892578 98.335938 L 139.892578 97.412109 L 146.729980 97.412109 L 146.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 146.892578 98.335938 L 146.892578 97.412109 L 153.729980 97.412109 L 153.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 153.892578 98.335938 L 153.892578 97.412109 L 160.729980 97.412109 L 160.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 160.892578 98.335938 L 160.892578 97.412109 L 167.729980 97.412109 L 167.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 167.892578 98.335938 L 167.892578 97.412109 L 174.729980 97.412109 L 174.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 174.892578 98.335938 L 174.892578 97.412109 L 181.729980 97.412109 L 181.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 181.892578 98.335938 L 181.892578 97.412109 L 188.729980 97.412109 L 188.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 188.892578 98.335938 L 188.892578 97.412109 L 195.729980 97.412109 L 195.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 195.892578 98.335938 L 195.892578 97.412109 L 202.729980 97.412109 L 202.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 202.892578 98.335938 L 202.892578 97.412109 L 209.729980 97.412109 L 209.729980 98.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 104.319336 L 212.878906 98.335938 L 209.892578 98.335938 L 209.892578 97.412109 L 212.878906 97.412109 L 212.878906 90.300781 L 213.738281 90.300781 L 213.738281 104.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 65.143066 41.872559 L 65.143066 44.885742 L 66.399902 44.885742 Q 67.151855 44.885742 67.573486 44.488281 Q 67.995117 44.090820 67.995117 43.376465 Q 67.995117 42.662109 67.576172 42.267334 Q 67.157227 41.872559 66.399902 41.872559 Z M 64.058105 40.980957 L 66.399902 40.980957 Q 67.742676 40.980957 68.435547 41.590576 Q 69.128418 42.200195 69.128418 43.376465 Q 69.128418 44.563477 68.438232 45.170410 Q 67.748047 45.777344 66.399902 45.777344 L 65.143066 45.777344 L 65.143066 49.000000 L 64.058105 49.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 65.319336 L 212.878906 51.300781 L 213.738281 51.300781 L 213.738281 65.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 78.319336 L 212.878906 64.300781 L 213.738281 64.300781 L 213.738281 78.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 91.319336 L 212.878906 77.300781 L 213.738281 77.300781 L 213.738281 91.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 73.770508 45.976074 L 73.442871 45.976074 Q 72.578125 45.976074 72.140381 46.279541 Q 71.702637 46.583008 71.702637 47.184570 Q 71.702637 47.727051 72.030273 48.027832 Q 72.357910 48.328613 72.937988 48.328613 Q 73.754395 48.328613 74.221680 47.761963 Q 74.688965 47.195312 74.694336 46.196289 L 74.694336 45.976074 Z M 75.687988 45.567871 L 75.687988 49.000000 L 74.694336 49.000000 L 74.694336 48.108398 Q 74.377441 48.645508 73.896729 48.900635 Q 73.416016 49.155762 72.728516 49.155762 Q 71.810059 49.155762 71.262207 48.637451 Q 70.714355 48.119141 70.714355 47.249023 Q 70.714355 46.244629 71.388428 45.723633 Q 72.062500 45.202637 73.367676 45.202637 L 74.694336 45.202637 L 74.694336 45.046875 Q 74.688965 44.327148 74.329102 44.002197 Q 73.969238 43.677246 73.179688 43.677246 Q 72.674805 43.677246 72.159180 43.822266 Q 71.643555 43.967285 71.154785 44.246582 L 71.154785 43.258301 Q 71.702637 43.048828 72.204834 42.944092 Q 72.707031 42.839355 73.179688 42.839355 Q 73.926270 42.839355 74.455322 43.059570 Q 74.984375 43.279785 75.312012 43.720215 Q 75.516113 43.988770 75.602051 44.383545 Q 75.687988 44.778320 75.687988 45.567871 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 81.608398 47.066406 Q 81.361328 47.694824 80.979980 48.720703 Q 80.448242 50.138672 80.265625 50.450195 Q 80.018555 50.869141 79.647949 51.078613 Q 79.277344 51.288086 78.783203 51.288086 L 77.988281 51.288086 L 77.988281 50.460938 L 78.573730 50.460938 Q 79.008789 50.460938 79.255859 50.208496 Q 79.502930 49.956055 79.884277 48.903320 L 77.558594 42.984375 L 78.605957 42.984375 L 80.389160 47.689453 L 82.145508 42.984375 L 83.192871 42.984375 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 87.861816 46.824707 Q 87.861816 47.490723 88.106201 47.829102 Q 88.350586 48.167480 88.828613 48.167480 L 89.983398 48.167480 L 89.983398 49.000000 L 88.731934 49.000000 Q 87.845703 49.000000 87.359619 48.433350 Q 86.873535 47.866699 86.873535 46.824707 L 86.873535 41.383789 L 85.289062 41.383789 L 85.289062 40.610352 L 87.861816 40.610352 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 94.308594 43.677246 Q 93.556641 43.677246 93.169922 44.262695 Q 92.783203 44.848145 92.783203 45.997559 Q 92.783203 47.141602 93.169922 47.729736 Q 93.556641 48.317871 94.308594 48.317871 Q 95.065918 48.317871 95.452637 47.729736 Q 95.839355 47.141602 95.839355 45.997559 Q 95.839355 44.848145 95.452637 44.262695 Q 95.065918 43.677246 94.308594 43.677246 Z M 94.308594 42.839355 Q 95.560059 42.839355 96.223389 43.650391 Q 96.886719 44.461426 96.886719 45.997559 Q 96.886719 47.539062 96.226074 48.347412 Q 95.565430 49.155762 94.308594 49.155762 Q 93.057129 49.155762 92.396484 48.347412 Q 91.735840 47.539062 91.735840 45.997559 Q 91.735840 44.461426 92.396484 43.650391 Q 93.057129 42.839355 94.308594 42.839355 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 101.770508 45.976074 L 101.442871 45.976074 Q 100.578125 45.976074 100.140381 46.279541 Q 99.702637 46.583008 99.702637 47.184570 Q 99.702637 47.727051 100.030273 48.027832 Q 100.357910 48.328613 100.937988 48.328613 Q 101.754395 48.328613 102.221680 47.761963 Q 102.688965 47.195312 102.694336 46.196289 L 102.694336 45.976074 Z M 103.687988 45.567871 L 103.687988 49.000000 L 102.694336 49.000000 L 102.694336 48.108398 Q 102.377441 48.645508 101.896729 48.900635 Q 101.416016 49.155762 100.728516 49.155762 Q 99.810059 49.155762 99.262207 48.637451 Q 98.714355 48.119141 98.714355 47.249023 Q 98.714355 46.244629 99.388428 45.723633 Q 100.062500 45.202637 101.367676 45.202637 L 102.694336 45.202637 L 102.694336 45.046875 Q 102.688965 44.327148 102.329102 44.002197 Q 101.969238 43.677246 101.179688 43.677246 Q 100.674805 43.677246 100.159180 43.822266 Q 99.643555 43.967285 99.154785 44.246582 L 99.154785 43.258301 Q 99.702637 43.048828 100.204834 42.944092 Q 100.707031 42.839355 101.179688 42.839355 Q 101.926270 42.839355 102.455322 43.059570 Q 102.984375 43.279785 103.312012 43.720215 Q 103.516113 43.988770 103.602051 44.383545 Q 103.687988 44.778320 103.687988 45.567871 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 109.608398 43.752441 L 109.608398 40.642578 L 110.596680 40.642578 L 110.596680 49.000000 L 109.608398 49.000000 L 109.608398 48.242676 Q 109.361328 48.688477 108.950439 48.922119 Q 108.539551 49.155762 108.002441 49.155762 Q 106.912109 49.155762 106.286377 48.309814 Q 105.660645 47.463867 105.660645 45.976074 Q 105.660645 44.509766 106.289062 43.674561 Q 106.917480 42.839355 108.002441 42.839355 Q 108.544922 42.839355 108.958496 43.072998 Q 109.372070 43.306641 109.608398 43.752441 Z M 106.702637 45.997559 Q 106.702637 47.146973 107.067871 47.732422 Q 107.433105 48.317871 108.147461 48.317871 Q 108.861816 48.317871 109.235107 47.727051 Q 109.608398 47.136230 109.608398 45.997559 Q 109.608398 44.853516 109.235107 44.265381 Q 108.861816 43.677246 108.147461 43.677246 Q 107.433105 43.677246 107.067871 44.262695 Q 106.702637 44.848145 106.702637 45.997559 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 123.592285 40.116211 Q 122.877930 41.340820 122.526123 42.557373 Q 122.174316 43.773926 122.174316 45.009277 Q 122.174316 46.239258 122.526123 47.458496 Q 122.877930 48.677734 123.592285 49.913086 L 122.732910 49.913086 Q 121.921875 48.634766 121.524414 47.423584 Q 121.126953 46.212402 121.126953 45.009277 Q 121.126953 43.811523 121.524414 42.597656 Q 121.921875 41.383789 122.732910 40.116211 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 127.154785 40.980957 L 128.245117 40.980957 L 128.245117 48.086914 L 132.117676 48.086914 L 132.117676 49.000000 L 127.154785 49.000000 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 136.947754 41.969238 L 134.417969 46.207031 L 136.947754 46.207031 Z M 136.770508 40.980957 L 138.027344 40.980957 L 138.027344 46.207031 L 139.096191 46.207031 L 139.096191 47.087891 L 138.027344 47.087891 L 138.027344 49.000000 L 136.947754 49.000000 L 136.947754 47.087891 L 133.547852 47.087891 L 133.547852 46.062012 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 141.869141 40.116211 L 142.728516 40.116211 Q 143.539551 41.383789 143.937012 42.597656 Q 144.334473 43.811523 144.334473 45.009277 Q 144.334473 46.217773 143.937012 47.431641 Q 143.539551 48.645508 142.728516 49.913086 L 141.869141 49.913086 Q 142.583496 48.666992 142.935303 47.447754 Q 143.287109 46.228516 143.287109 45.009277 Q 143.287109 43.784668 142.935303 42.565430 Q 142.583496 41.346191 141.869141 40.116211 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 52.319336 L 212.878906 38.300781 L 213.738281 38.300781 L 213.738281 52.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 26.319336 L 212.878906 12.300781 L 213.738281 12.300781 L 213.738281 26.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 39.319336 L 212.878906 25.300781 L 213.738281 25.300781 L 213.738281 39.319336 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 6.892578 7.335938 L 6.892578 6.412109 L 13.729980 6.412109 L 13.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 13.892578 7.335938 L 13.892578 6.412109 L 20.729980 6.412109 L 20.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 20.892578 7.335938 L 20.892578 6.412109 L 27.729980 6.412109 L 27.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 27.892578 7.335938 L 27.892578 6.412109 L 34.729980 6.412109 L 34.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 34.892578 7.335938 L 34.892578 6.412109 L 41.729980 6.412109 L 41.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 41.892578 7.335938 L 41.892578 6.412109 L 48.729980 6.412109 L 48.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 48.892578 7.335938 L 48.892578 6.412109 L 55.729980 6.412109 L 55.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 55.892578 7.335938 L 55.892578 6.412109 L 62.729980 6.412109 L 62.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 62.892578 7.335938 L 62.892578 6.412109 L 69.729980 6.412109 L 69.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 69.892578 7.335938 L 69.892578 6.412109 L 76.729980 6.412109 L 76.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 76.892578 7.335938 L 76.892578 6.412109 L 83.729980 6.412109 L 83.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 83.892578 7.335938 L 83.892578 6.412109 L 90.729980 6.412109 L 90.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 90.892578 7.335938 L 90.892578 6.412109 L 97.729980 6.412109 L 97.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 97.892578 7.335938 L 97.892578 6.412109 L 104.729980 6.412109 L 104.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 104.892578 7.335938 L 104.892578 6.412109 L 111.729980 6.412109 L 111.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 111.892578 7.335938 L 111.892578 6.412109 L 118.729980 6.412109 L 118.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 118.892578 7.335938 L 118.892578 6.412109 L 125.729980 6.412109 L 125.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 125.892578 7.335938 L 125.892578 6.412109 L 132.729980 6.412109 L 132.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 132.892578 7.335938 L 132.892578 6.412109 L 139.729980 6.412109 L 139.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 139.892578 7.335938 L 139.892578 6.412109 L 146.729980 6.412109 L 146.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 146.892578 7.335938 L 146.892578 6.412109 L 153.729980 6.412109 L 153.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 153.892578 7.335938 L 153.892578 6.412109 L 160.729980 6.412109 L 160.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 160.892578 7.335938 L 160.892578 6.412109 L 167.729980 6.412109 L 167.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 167.892578 7.335938 L 167.892578 6.412109 L 174.729980 6.412109 L 174.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 174.892578 7.335938 L 174.892578 6.412109 L 181.729980 6.412109 L 181.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 181.892578 7.335938 L 181.892578 6.412109 L 188.729980 6.412109 L 188.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 188.892578 7.335938 L 188.892578 6.412109 L 195.729980 6.412109 L 195.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 195.892578 7.335938 L 195.892578 6.412109 L 202.729980 6.412109 L 202.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 202.892578 7.335938 L 202.892578 6.412109 L 209.729980 6.412109 L 209.729980 7.335938 Z " fill="black" fill-opacity="1.000000"></path>
                  <path d="M 212.878906 13.319336 L 212.878906 7.335938 L 209.892578 7.335938 L 209.892578 6.412109 L 213.738281 6.412109 L 213.738281 13.319336 Z " fill="black" fill-opacity="1.000000"></path>
                </svg><a href="#section-1.3.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-scion-header-within-the" class="selfRef">The SCION header within the protocol stack in a typical deployment</a>
            </figcaption></figure>
</div>
<p id="section-1.3.1-5">A complete SCION address is composed of the &lt;ISD, AS, endpoint address&gt; 3-tuple. The ISD-AS part is used for inter-domain routing. The endpoint address part is only used for intra-domain forwarding at the source and destination ASes. This implies that endpoint addresses are only required to be globally unique within each SCION AS. This means, for example, that an endpoint running a SCION stack using a <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span> could directly communicate with another SCION endpoint using a <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span> endpoint address in a different SCION AS.<a href="#section-1.3.1-5" class="pilcrow">¶</a></p>
<p id="section-1.3.1-6">The data transmission order for SCION is the same as for IPv6 as defined in Introduction of <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-1.3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intra-domain-forwarding-process">
<section id="section-1.3.2">
          <h4 id="name-intra-domain-forwarding-pro">
<a href="#section-1.3.2" class="section-number selfRef">1.3.2. </a><a href="#name-intra-domain-forwarding-pro" class="section-name selfRef">Intra-Domain Forwarding Process</a>
          </h4>
<p id="section-1.3.2-1">When transiting an intermediate SCION AS, a packet gets forwarded by at most two SCION routers. The forwarding process consists of the following steps.<a href="#section-1.3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.3.2-2">
<li id="section-1.3.2-2.1">
              <p id="section-1.3.2-2.1.1">The AS's SCION ingress router receives a SCION packet from the neighboring AS.<a href="#section-1.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-2.2">
              <p id="section-1.3.2-2.2.1">The SCION router parses, validates, and authenticates the SCION header.<a href="#section-1.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-2.3">
              <p id="section-1.3.2-2.3.1">The SCION router maps the egress interface ID in the current Hop Field of the SCION header to the destination address of the intra-domain protocol (e.g. MPLS or IP) of the egress border router.<a href="#section-1.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-2.4">
              <p id="section-1.3.2-2.4.1">The packet is forwarded within the AS by SCION-unaware routers and switches based on the header of the intra-domain protocol.<a href="#section-1.3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-2.5">
              <p id="section-1.3.2-2.5.1">Upon receiving the packet, the SCION egress router strips off the header of the intra-domain protocol, again validates and updates the SCION header, and forwards the packet to the neighboring SCION router.<a href="#section-1.3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-2.6">
              <p id="section-1.3.2-2.6.1">The last SCION router on the path forwards the packet to the packet's destination endpoint indicated by the field <code>DstHostAddr</code> of <span><a href="#address-header" class="internal xref">the Address Header</a> (<a href="#address-header" class="auto internal xref">Section 2.2</a>)</span>.<a href="#section-1.3.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="configuration">
<section id="section-1.3.3">
          <h4 id="name-configuration">
<a href="#section-1.3.3" class="section-number selfRef">1.3.3. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
          </h4>
<p id="section-1.3.3-1">Border routers require mappings from SCION interface IDs to underlay addresses and such information <span class="bcp14">MUST</span> be supplied to each router in an out of band fashion (e.g in a configuration file). For each link to a neighbor, these values <span class="bcp14">MUST</span> be configured. A typical implementation will require:<a href="#section-1.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.3-2.1">
              <p id="section-1.3.3-2.1.1">Interface ID.<a href="#section-1.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.3-2.2">
              <p id="section-1.3.3-2.2.1">Link type (core, parent, child, peer). Link type depends on mutual agreements between the organizations operating the ASes at each end of each link.<a href="#section-1.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.3-2.3">
              <p id="section-1.3.3-2.3.1">Neighbor ISD-AS number.<a href="#section-1.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.3-2.4">
              <p id="section-1.3.3-2.4.1">For the router that manages the interface: the neighbor interface underlay address.<a href="#section-1.3.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.3-2.5">
              <p id="section-1.3.3-2.5.1">For the routers that do not manage the interface:  the address of the intra-domain protocol on the router that does.<a href="#section-1.3.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.3.3-3">In order to forward traffic to a service endpoint address (<code>DT/DS</code> == 0b01 in the <span><a href="#common-header" class="internal xref">common header</a> (<a href="#common-header" class="auto internal xref">Section 2.1</a>)</span>), a border router translates the service number into a specific destination address. The method used to accomplish the translation is not defined by this document and is only dependent on the implementation and the choices of each AS's administrator. In current practice this is accomplished by way of a configuration file.<a href="#section-1.3.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3.3-4"><strong>Note:</strong> The current SCION implementation runs over the UDP/IP protocol. However, the use of other lower layers protocols is possible.<a href="#section-1.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="construction">
<section id="section-1.4">
        <h3 id="name-path-construction-segment-c">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-path-construction-segment-c" class="section-name selfRef">Path Construction (Segment Combinations)</a>
        </h3>
<p id="section-1.4-1">Paths are discovered by the SCION Control Plane which makes them available to SCION endpoints in the form of path segments. As described in <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>, there are three kinds of path segments: up, down, and core. In the data plane, a SCION endpoint creates end-to-end paths from the path segments by combining multiple path segments. Depending on the network topology, a SCION forwarding path can consist of one, two, or three segments. Each path segment contains several Hop Fields representing the ASes on the segment as well as one Info Field with basic information about the segment, such as a timestamp.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">Segments cannot be combined arbitrarily. To construct a valid forwarding path, the source endpoint <span class="bcp14">MUST</span> obey the following rules:<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-3.1">
            <p id="section-1.4-3.1.1">There <span class="bcp14">MUST</span> be at most one of each type of segment (up, core, and down). Allowing multiple up or down segments would decrease efficiency and the ability of ASes to enforce path policies.<a href="#section-1.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-3.2">
            <p id="section-1.4-3.2.1">If an up segment is present, it <span class="bcp14">MUST</span> be the first segment in the path.<a href="#section-1.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-3.3">
            <p id="section-1.4-3.3.1">If a down segment is present, it <span class="bcp14">MUST</span> be the last segment in the path.<a href="#section-1.4-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-3.4">
            <p id="section-1.4-3.4.1">If there are two path segments (one up and one down segment) that both announce the same peering link, then a shortcut via this peering link is possible.<a href="#section-1.4-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-3.5">
            <p id="section-1.4-3.5.1">If there are two path segments (one up and one down segment) that share a common ancestor AS (in the direction of beaconing), then a shortcut via this common ancestor AS is possible. The Up-then-Down constraint still applies.<a href="#section-1.4-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-3.6">
            <p id="section-1.4-3.6.1">Additionally, all segments without any peering possibility <span class="bcp14">MUST</span> consist of at least two Hop Fields.<a href="#section-1.4-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.4-4">Note that the type of segment is known to the endpoint but it is not explicitly visible in the path header of data packets. Therefore, a SCION router needs to explicitly verify that these rules were followed correctly by performing checks described in <a href="#process-router-ingress" class="auto internal xref">Section 4.2.2.1</a>.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">Besides enabling the enforcement of path policies, the above rules also protect the economic interest of ASes as they prevent building "valley paths". A valley path contains ASes that do not profit economically from traffic on this route, with the name coming from the fact that such paths go "down" (following parent-child links) before going "up" (following child-parent links).<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<p id="section-1.4-6"><a href="#_figure-1" class="auto internal xref">Figure 2</a> below shows valid segment combinations.<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7"><strong>Note:</strong> It is assumed that the source and destination endpoints are in different ASes (as endpoints from the same AS use an empty forwarding path to communicate with each other).<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<span id="name-illustration-of-valid-path-"></span><div id="_figure-1">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-1.4-8.1">
<pre>
 ┌───┐
 │ C │ = Core AS                  - - - - = unused links
 └───┘
 ┌───┐
 │ * │ = source/destination AS    ──────▶ = direction of beaconing
 └───┘

         Core                        Core                  Core
      ──────────▶                 ──────────▶           ──────────▶
    ┌───┐     ┌───┐             ┌───┐     ┌───┐       ┌───┐     ┌───┐
┌───┤ C ├─────┤ C ├───┐     ┌───┤ C ├─────┤C/*│       │C/*├ - - ┤C/*│
│   └─┬─┘     └─┬─┘   │     │   └─┬─┘     └───┘       └───┘     └───┘
│     │   1a    │     │     │     │   1b                    1c
│     │         │     │     │     │
│     │         │     │     │     │
│   ┌─┴─┐     ┌─┴─┐   │     │   ┌─┴─┐                      Core
│   │   │     │   │   │     │   │   │                 ──────────────▶
│   └─┬─┘     └─┬─┘   │     │   └─┬─┘                      ┌───┐
│     │         │     │     │     │                   ┌────┤ C ├────┐
│     │         │     │     │     │                   │    └───┘    │
│     │         │     │     │     │                   │             │
│   ┌─┴─┐     ┌─┴─┐   │     │   ┌─┴─┐               ┌─┴─┐   1d    ┌─┴─┐
└─-▶│ * │     │ * │◀──┘     └─-▶│ * │               │C/*│         │C/*│
    └───┘     └───┘             └───┘               └───┘         └───┘


         ┌───┐                   ┌───┐                 ┌───┐
┌──   ┌──┤ C ├──┐   ──┐     ┌────┤C/*│        ┌──   ┌─ ┤ C ├ ─┐   ──┐
│     │  └───┘  │     │     │    └─┬─┘        │     |  └───┘  |     │
│     │         │     │     │      │          │     |         |     │
│     │   2a    │     │     │  2b  │          │     |    3a   |     │
│     │         │     │     │      │          │     |         |     │
│   ┌─┴─┐     ┌─┴─┐   │     │    ┌─┴─┐        │   ┌─┴─┐     ┌─┴─┐   │
│   │   │     │   │   │     │    │   │        │   │   #- - -#   │   │
│   └─┬─┘     └─┬─┘   │     │    └─┬─┘        │   └─┬─┘Peer └─┬─┘   │
│     │         │     │     │      │          │     │         │     │
│     │         │     │     │      │          │     │         │     │
│     │         │     │     │      │          │     │         │     │
│   ┌─┴─┐     ┌─┴─┐   │     │    ┌─┴─┐        │   ┌─┴─┐     ┌─┴─┐   │
└─-▶│ * │     │ * │◀──┘     └──-▶│ * │        └─-▶│ * │     │ * │◀──┘
    └───┘     └───┘              └───┘            └───┘     └───┘

         Core                                      Core
     ──────────▶                               ──────────▶
   ┌───┐     ┌───┐             ┌───┐         ┌───┐     ┌───┐      ┌───┐
┌──┤ C ├ - - ┤ C ├──┐   ┌──────┤ C ├──────┐  │ C ├ - - ┤ C │  ┌───┤ C │
│  └─┬─┘     └─┬─┘  │   │      └─┬─┘      │  └─┬─┘     └─┬─┘  │   └─┬─┘
│    |   3b    |    │   │        |   4a   │    |   4b    |    │  5  |
│    |         |    │   │        |        │    |         |    │     |
│    |         |    │   │        |        │    |         |    │     |
│  ┌─┴─┐     ┌─┴─┐  │   │      ┌─┴─┐      │    └ -┌───┐- ┘    │   ┌─┴─┐
│  │   #- - -#   │  │   │    ┌─┤   ├─┐    │    ┌──┤   ├──┐    │   │ * │
│  └─┬─┘ Peer└─┬─┘  │   │    │ └───┘ │    │    │  └───┘  │    │   └─┬─┘
│    │         │    │   │    │       │    │    │         │    │     │
│    │         │    │   │    │       │    │    │         │    │     │
│    │         │    │   │    │       │    │    │         │    │     │
│  ┌─┴─┐     ┌─┴─┐  │   │  ┌─┴─┐   ┌─┴─┐  │  ┌─┴─┐     ┌─┴─┐  │   ┌─┴─┐
└─▶│ * │     │ * │◀─┘   └-▶│ * │   │ * │◀─┘  │ * │     │ * │  └--▶│ * │
   └───┘     └───┘         └───┘   └───┘     └───┘     └───┘      └───┘
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-illustration-of-valid-path-" class="selfRef">Illustration of valid path segment combinations. Each node represents a SCION Autonomous System.</a>
          </figcaption></figure>
</div>
<p id="section-1.4-9">Valid path segment combinations:<a href="#section-1.4-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-10.1">
            <p id="section-1.4-10.1.1"><strong>Communication through core ASes</strong>:<a href="#section-1.4-10.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-10.1.2.1">
                <p id="section-1.4-10.1.2.1.1"><strong>Core segment combination</strong> (Cases 1a, 1b, 1c, 1d in <a href="#_figure-1" class="auto internal xref">Figure 2</a>): The up and down segments of source and destination do not have an AS in common. In this case, a core segment is <span class="bcp14">REQUIRED</span> to connect the source's up segment and the destination's down segment (Case 1a). If either the source or the destination AS is a core AS (Case 1b) or both are core ASes (Cases 1c and 1d), then no up or down segments are <span class="bcp14">REQUIRED</span> to connect the respective ASes to the core segment.<a href="#section-1.4-10.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.4-10.1.2.2">
                <p id="section-1.4-10.1.2.2.1"><strong>Immediate combination</strong> (Cases 2a, 2b in <a href="#_figure-1" class="auto internal xref">Figure 2</a>): The last AS on the up segment (which is necessarily a core AS) is the same as the first AS on the down segment. In this case, a simple combination of up and down segments creates a valid forwarding path. In Case 2b, only one segment is required.<a href="#section-1.4-10.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.4-10.2">
            <p id="section-1.4-10.2.1"><strong>Peering shortcut</strong> (Cases 3a and 3b): A peering link exists between the up and down segment, and extraneous path segments to the core are cut off. Note that the up and down segments do not need to originate from the same core AS and the peering link could also be traversing to a different ISD.<a href="#section-1.4-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-10.3">
            <p id="section-1.4-10.3.1"><strong>AS shortcut</strong> (Cases 4a and 4b): The up and down segments intersect at a non-core AS below the ISD core, thus creating a shortcut. In this case, a shorter path is made possible by removing the extraneous part of the path to the core. Note that the up and down segments do not need to originate from the same core AS.<a href="#section-1.4-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-10.4">
            <p id="section-1.4-10.4.1"><strong>On-path</strong> (Case 5): In the case where the source's up segment contains the destination AS or the destination's down segment contains the source AS, a single segment is sufficient to construct a forwarding path. Again, no core AS is on the final path.<a href="#section-1.4-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="path-authorization">
<section id="section-1.5">
        <h3 id="name-path-authorization">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-path-authorization" class="section-name selfRef">Path Authorization</a>
        </h3>
<p id="section-1.5-1">The SCION Data Plane provides <em>path authorization</em>. This property ensures that data packets always traverse the network using path segments that were explicitly authorized by the respective ASes and prevents endpoints from constructing unauthorized paths or paths containing loops. SCION uses symmetric cryptography in the form of Message Authentication Codes (MACs) to authenticate the information encoded in Hop Fields and such MACs are verified by routers at forwarding. For a detailed specification, see <a href="#path-auth" class="auto internal xref">Section 4</a>.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="header">
<section id="section-2">
      <h2 id="name-scion-header-specification">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-scion-header-specification" class="section-name selfRef">SCION Header Specification</a>
      </h2>
<p id="section-2-1">The SCION packet header is aligned to 4 bytes. It is composed of a common header, an address header, a path header, and an <span class="bcp14">OPTIONAL</span> extension header, see <a href="#_figure-2" class="auto internal xref">Figure 3</a> below.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span id="name-high-level-scion-header-str"></span><div id="_figure-2">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-2-2.1">
<pre>
┌────────────────────────────────────────────────────────┐
│                     Common header                      │
│                                                        │
├────────────────────────────────────────────────────────┤
│                     Address header                     │
│                                                        │
├────────────────────────────────────────────────────────┤
│                      Path header                       │
│                                                        │
├────────────────────────────────────────────────────────┤
│               Extension header (OPTIONAL)              │
│                                                        │
└────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-high-level-scion-header-str" class="selfRef">High-level SCION header structure, non-byte aligned</a>
        </figcaption></figure>
</div>
<p id="section-2-3">The <em>common header</em> contains important meta information including version number and the lengths of the header and payload. In particular, it contains flags that control the format of subsequent headers such as the address and path headers. For more details, see <a href="#common-header" class="auto internal xref">Section 2.1</a>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The <em>address header</em> contains the ISD, AS and endpoint addresses of source and destination. The type and length of endpoint addresses are variable and can be set independently using flags in the common header. For more details, see <a href="#address-header" class="auto internal xref">Section 2.2</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The <em>path header</em> contains the full AS-level forwarding path of the packet. A path type field in the common header specifies the path format used in the path header. For more details, see <a href="#path-header" class="auto internal xref">Section 2.3</a>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">The <span class="bcp14">OPTIONAL</span> <em>extension</em> header contains a variable number of hop-by-hop and end-to-end options, similar to extensions in the IPv6 header <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>. For more details, see <a href="#ext-header" class="auto internal xref">Section 2.4</a>.<a href="#section-2-6" class="pilcrow">¶</a></p>
<div id="common-header">
<section id="section-2.1">
        <h3 id="name-common-header">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-common-header" class="section-name selfRef">Common Header</a>
        </h3>
<p id="section-2.1-1">The SCION common header has the following packet format:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-the-scion-common-header-pac"></span><div id="_figure-3">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-2.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│Version│   TrafficClass    │            Flow Label             │
├───────┴───────┬───────────┴───┬───────────────────────────────┤
│    NextHdr    │    HdrLen     │          PayloadLen           │
├───────────────┼───┬───┬───┬───┼───────────────────────────────┤
│    PathType   │DT │DL │ST │SL │              RSV              │
└───────────────┴───┴───┴───┴───┴───────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-the-scion-common-header-pac" class="selfRef">The SCION common header packet format</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1"><code>Version</code>: The version of the SCION common header. Currently, only version "0" is supported.<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1"><code>TrafficClass</code>: The 8-bit long identifier of the packet's class or priority. The value of the traffic class bits in a received packet might differ from the value sent by the packet's source. The current use of the <code>TrafficClass</code> field for Differentiated Services and Explicit Congestion Notification is specified in <span>[<a href="#RFC2474" class="cite xref">RFC2474</a>]</span> and <span>[<a href="#RFC3168" class="cite xref">RFC3168</a>]</span>.<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.3">
            <p id="section-2.1-3.3.1"><code>Flow Label</code>: This 20-bit field labels sequences of packets to be treated in the network as a single flow. Sources <span class="bcp14">MUST</span> set this field. This serves the same purpose as what <span>[<a href="#RFC6437" class="cite xref">RFC6437</a>]</span> describes for IPv6 and is used in the same manner. Notably, a Flow Label of zero does not imply that packet reordering is acceptable.<a href="#section-2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.4">
            <p id="section-2.1-3.4.1"><code>NextHdr</code>: Encodes the type of the first header after the SCION header. This can be either a SCION extension or a Layer 4 protocol such as TCP or UDP. Values of this field respect the Assigned SCION Protocol Numbers (see <a href="#protnum" class="auto internal xref">Appendix "Assigned SCION Protocol Numbers"</a>).<a href="#section-2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.5">
            <p id="section-2.1-3.5.1"><code>HdrLen</code>: Specifies the entire length of the SCION header in bytes, i.e. the sum of the lengths of the common header, the address header, and the path header. The SCION header is aligned to a multiple of 4 bytes. The SCION header length is computed as <code>HdrLen</code> * 4 bytes. The 8 bits of the <code>HdrLen</code> field limit the SCION header to a maximum of 255 * 4 = 1020 bytes.<a href="#section-2.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.6">
            <p id="section-2.1-3.6.1"><code>PayloadLen</code>: Specifies the length of the payload in bytes. The payload includes (SCION) extension headers and the L4 payload. This field is 16 bits long, supporting a maximum payload size of 65'535 bytes.<a href="#section-2.1-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.7">
            <p id="section-2.1-3.7.1"><code>PathType</code>: Specifies the type of the SCION path and is 8 bits long. The format of one path type is independent of all other path types. The currently defined SCION path types are Empty (0), SCION (1), OneHopPath (2), EPIC (3) and COLIBRI (4). This document only specifies the Empty, SCION and OneHopPath path types. The other path types are currently experimental. For more details, see <a href="#path-header" class="auto internal xref">Section 2.3</a>.<a href="#section-2.1-3.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-scion-path-types"></span><div id="_table-1">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-scion-path-types" class="selfRef">SCION path types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Path Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Empty path (<code>EmptyPath</code>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">SCION (<code>SCION</code>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">One-hop path (<code>OneHopPath</code>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">EPIC path (experimental)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">COLIBRI path (experimental)</td>
            </tr>
          </tbody>
        </table>
</div>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">
            <p id="section-2.1-5.1.1"><code>DT/DL/ST/SL</code>: These fields define the endpoint address type and endpoint address length for the source and destination endpoint. <code>DT</code> and <code>DL</code> stand for Destination Type and Destination Length, whereas <code>ST</code> and <code>SL</code> stand for Source Type and Source Length. The possible endpoint address length values are 4 bytes, 8 bytes, 12 bytes, and 16 bytes. If an address has a length different from the supported values, the next larger size <span class="bcp14">SHALL</span> be used and the address can be padded with zeros. <a href="#_table-2" class="auto internal xref">Table 2</a> below lists the currently used values for address length. The "type" identifier is only defined in combination with a specific address length. For example, address type "0" is defined as IPv4 in combination with address length 4, but is defined as IPv6 in combination with address length 16. Per address length, several sub-types are possible and <a href="#_table-3" class="auto internal xref">Table 3</a> shows the currently assigned combinations of lengths and types.<a href="#section-2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-address-length-values"></span><div id="_table-2">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-address-length-values" class="selfRef">Address length values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">DL/SL Value</th>
              <th class="text-left" rowspan="1" colspan="1">Address Length</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">4 bytes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">8 bytes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">12 bytes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">16 bytes</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-allocations-of-type-values-"></span><div id="_table-3">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-allocations-of-type-values-" class="selfRef">Allocations of type values to length values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Length (bytes)</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">DT/DL or ST/SL encoding</th>
              <th class="text-left" rowspan="1" colspan="1">Conventional Use</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">0b0000</td>
              <td class="text-left" rowspan="1" colspan="1">IPv4</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">0b0100</td>
              <td class="text-left" rowspan="1" colspan="1">Service</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">0b0011</td>
              <td class="text-left" rowspan="1" colspan="1">IPv6</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">other</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-8">A service address designates a set of endpoint addresses rather than a singular one. A packet addressed to a service is redirected to any one endpoint address that is known to be part of the set. <a href="#_table-4" class="auto internal xref">Table 4</a> lists the known services.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-9.1">
            <p id="section-2.1-9.1.1"><code>RSV</code>: These bits are currently reserved for future use.<a href="#section-2.1-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="address-header">
<section id="section-2.2">
        <h3 id="name-address-header">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-address-header" class="section-name selfRef">Address Header</a>
        </h3>
<p id="section-2.2-1">The SCION address header has the following format:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span id="name-the-scion-address-header-pa"></span><div id="_figure-4">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-2.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│            DstISD             │                               │
├───────────────────────────────┘                               ┤
│                             DstAS                             │
├───────────────────────────────┬───────────────────────────────┤
│            SrcISD             │                               │
├───────────────────────────────┘                               ┤
│                             SrcAS                             │
├───────────────────────────────────────────────────────────────┤
│                 DstHostAddr (variable length)                 │
├───────────────────────────────────────────────────────────────┤
│                 SrcHostAddr (variable length)                 │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-the-scion-address-header-pa" class="selfRef">The SCION address header packet format</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.2-3.1">
            <p id="section-2.2-3.1.1"><code>DstISD, SrcISD</code>: The 16-bit ISD identifier of the destination/source.<a href="#section-2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-3.2">
            <p id="section-2.2-3.2.1"><code>DstAS, SrcAS</code>: The 48-bit AS identifier of the destination/source.<a href="#section-2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-3.3">
            <p id="section-2.2-3.3.1"><code>DstHostAddr, SrcHostAddr</code>: Specifies the variable length endpoint address of the destination/source. The accepted type and length are defined in the <code>DT/DL/ST/SL</code> fields of the common header.<a href="#section-2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-4">If a service address is implied by the <code>DT/DL</code> or <code>ST/SL</code> field of the common header, the corresponding address field has the following format:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<span id="name-service-address-format"></span><div id="_figure-20">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-2.2-5.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│         Service Number        │              RSV              │
└───────────────────────────────┴───────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-service-address-format" class="selfRef">Service address format</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.2-6.1">
            <p id="section-2.2-6.1.1"><code>RSV</code>: reserved for future use<a href="#section-2.2-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-7">The currently known service numbers are:<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<span id="name-known-service-numbers"></span><div id="_table-4">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-known-service-numbers" class="selfRef">Known Service Numbers</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Service Number (hex)</th>
              <th class="text-left" rowspan="1" colspan="1">Short Name</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0001</td>
              <td class="text-left" rowspan="1" colspan="1">DS</td>
              <td class="text-left" rowspan="1" colspan="1">Discovery Service</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0002</td>
              <td class="text-left" rowspan="1" colspan="1">CS</td>
              <td class="text-left" rowspan="1" colspan="1">Control Service</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0xFFFF</td>
              <td class="text-left" rowspan="1" colspan="1">None</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved invalid value</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.2-9"><strong>Note:</strong> For more information on addressing in SCION, see the SCION Control Plane Specification (<span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>).<a href="#section-2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-header">
<section id="section-2.3">
        <h3 id="name-path-header">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-path-header" class="section-name selfRef">Path Header</a>
        </h3>
<p id="section-2.3-1">The path header of a SCION packet differs for each SCION path type. The path type is set in the <code>PathType</code> field of the SCION common header.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">SCION supports three path types:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<div id="empty">
<section id="section-2.3.1">
          <h4 id="name-empty-path-type">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-empty-path-type" class="section-name selfRef">Empty Path Type</a>
          </h4>
<p id="section-2.3.1-1">The <code>Empty</code> path type (<code>PathType=0</code>) is used to send traffic within an AS. It has no additional fields, i.e. it consumes 0 bytes on the wire.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">One use case of the <code>Empty</code> path type lies in the context of <span><a href="#scion-bfd" class="internal xref">link-failure detection</a> (<a href="#scion-bfd" class="auto internal xref">Section 6.1</a>)</span>.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scion-path-type">
<section id="section-2.3.2">
          <h4 id="name-scion-path-type">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-scion-path-type" class="section-name selfRef">SCION Path Type</a>
          </h4>
<p id="section-2.3.2-1">The <code>SCION</code> path type (<code>PathType=1</code>) is the standard path type. A SCION path has the following layout:<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<span id="name-layout-of-a-standard-scion-"></span><div id="_figure-5">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-2.3.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│                          PathMetaHdr                          │
├───────────────────────────────────────────────────────────────┤
│                           InfoField                           │
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                              ...                              │
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                           InfoField                           │
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                           HopField                            │
│                                                               │
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                           HopField                            │
│                                                               │
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                              ...                              │
│                                                               │
│                                                               │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-layout-of-a-standard-scion-" class="selfRef">Layout of a standard SCION path</a>
            </figcaption></figure>
</div>
<p id="section-2.3.2-3">It consists of a path meta header, up to 3 Info Fields and up to 64 Hop Fields.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2-4.1">
              <p id="section-2.3.2-4.1.1"><code>PathMetaHdr</code> indicates the currently valid Info Field and Hop Field while the packet is traversing the network along the path, as well as the number of Hop Fields per segment.<a href="#section-2.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.2-4.2">
              <p id="section-2.3.2-4.2.1"><code>InfoField</code> equals the number of path segments that the path contains - there is one Info Field per path segment. Each Info Field contains basic information about the corresponding segment, such as a timestamp indicating the creation time. There are also two flags: one specifies whether the segment is to be traversed in construction direction, the other whether the first or last Hop Field in the segment represents a peering Hop Field.<a href="#section-2.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.2-4.3">
              <p id="section-2.3.2-4.3.1"><code>HopField</code> represents a hop through an AS on the path, with the ingress and egress interface identifiers for this AS. This information is authenticated with a Message Authentication Code (MAC) to prevent forgery.<a href="#section-2.3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.2-5">The SCION header is created by extracting the required Info Fields and Hop Fields from the corresponding path segments. The process of extracting is illustrated in <a href="#_figure-6" class="auto internal xref">Figure 8</a> below. Note that ASes at the intersection of multiple segments are represented by two Hop Fields. Be aware that these Hop Fields are not equal!<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
<p id="section-2.3.2-6">In the Hop Field that represents the last Hop in the first segment (seen in the direction of travel), only the ingress interface will be specified. However, in the hop Field that represents the first hop in the second segment (also in the direction of travel), only the egress interface will be defined. Thus, the two Hop Fields for this one AS build a full hop through the AS, specifying both the ingress and egress interface. As such, they bring the two adjacent segments together.<a href="#section-2.3.2-6" class="pilcrow">¶</a></p>
<span id="name-path-construction-example"></span><div id="_figure-6">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-2.3.2-7.1">
<pre>
                   ┌┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┐
                   ┆    ISD Core    ┆
   ┌───┐   ┌───┐   ┆  ┌───┐  ┌───┐  ┆    ┌───┐  ┌───┐
   │AS3├───┤AS4├──────┤AS1├──┤AS2├───────┤AS5├──┤AS6│
   └───┘   └───┘   ┆  └───┘  └───┘  ┆    └───┘  └───┘
                   └┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┘

 Up-Segment           Core-Segment        Down-Segment
┌─────────┐           ┌─────────┐         ┌─────────┐
│ ┌─────┐ │           │ ┌─────┐ │         │ ┌─────┐ │
│ │ INF │ ├────────┐  │ │ INF │ ├──┐      │ │ INF │ ├──┐
│ └─────┘ │        │  │ └─────┘ │  │      │ └─────┘ │  │
│ ┌─────┐ │        │  │ ┌─────┐ │  │      │ ┌─────┐ │  │
│ │ HF  │ ├──────┐ │  │ │ HF  │ ├────┐    │ │ HF  │ ├────┐
│ └─────┘ │      │ │  │ └─────┘ │  │ │    │ └─────┘ │  │ │
│ ┌─────┐ │      │ │  │ ┌─────┐ │  │ │    │ ┌─────┐ │  │ │
│ │ HF  │ ├────┐ │ │  │ │ HF  │ ├──────┐  │ │ HF  │ ├──────┐
│ └─────┘ │    │ │ │  │ └─────┘ │  │ │ │  │ └─────┘ │  │ │ │
│ ┌─────┐ │    │ │ │  └─────────┘  │ │ │  │ ┌─────┐ │  │ │ │
│ │ HF  │ ├──┐ │ │ │               │ │ │  │ │ HF  │ ├────────┐
│ └─────┘ │  │ │ │ │  ┌─────────┐  │ │ │  │ └─────┘ │  │ │ │ │
└─────────┘  │ │ │ │  │ ┏━━━━━┓ │  │ │ │  └─────────┘  │ │ │ │
             │ │ │ │  │ ┃Meta ┃ │  │ │ │               │ │ │ │
             │ │ │ │  │ ┗━━━━━┛ │  │ │ │               │ │ │ │
             │ │ │ │  │ ┌─────┐ │  │ │ │               │ │ │ │
             │ │ │ └─▶│ │ INF │ │  │ │ │               │ │ │ │
             │ │ │    │ └─────┘ │  │ │ │               │ │ │ │
             │ │ │    │ ┌─────┐ │  │ │ │               │ │ │ │
             │ │ │    │ │ INF │ │◀─┘ │ │               │ │ │ │
             │ │ │    │ └─────┘ │    │ │               │ │ │ │
             │ │ │    │ ┌─────┐ │    │ │               │ │ │ │
             │ │ │    │ │ INF │ │◀─────────────────────┘ │ │ │
             │ │ │    │ └─────┘ │    │ │                 │ │ │
             │ │ │    │ ┌─────┐ │    │ │                 │ │ │
             │ │ └───▶│ │ HF  │ │    │ │                 │ │ │
             │ │      │ └─────┘ │    │ │                 │ │ │
             │ │      │ ┌─────┐ │    │ │                 │ │ │
             │ └─────▶│ │ HF  │ │    │ │                 │ │ │
             │        │ └─────┘ │    │ │                 │ │ │
             │        │ ┌─────┐ │    │ │                 │ │ │
             └──────-▶│ │ HF  │ │    │ │                 │ │ │
                      │ └─────┘ │    │ │                 │ │ │
                      │ ┌─────┐ │    │ │                 │ │ │
                      │ │ HF  │ │◀───┘ │                 │ │ │
                      │ └─────┘ │      │                 │ │ │
                      │ ┌─────┐ │      │                 │ │ │
     Forwarding Path  │ │ HF  │ │◀─────┘                 │ │ │
                      │ └─────┘ │                        │ │ │
                      │ ┌─────┐ │                        │ │ │
                      │ │ HF  │ │◀───────────────────────┘ │ │
                      │ └─────┘ │                          │ │
                      │ ┌─────┐ │                          │ │
                      │ │ HF  │ │◀─────────────────────────┘ │
                      │ └─────┘ │                            │
                      │ ┌─────┐ │                            │
                      │ │ HF  │ │◀───────────────────────────┘
                      │ └─────┘ │
                      └─────────┘
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-path-construction-example" class="selfRef">Path construction example</a>
            </figcaption></figure>
</div>
<div id="PathMetaHdr">
<section id="section-2.3.2.1">
            <h5 id="name-path-meta-header-field">
<a href="#section-2.3.2.1" class="section-number selfRef">2.3.2.1. </a><a href="#name-path-meta-header-field" class="section-name selfRef">Path Meta Header Field</a>
            </h5>
<p id="section-2.3.2.1-1">The 4-byte Path Meta Header field (<code>PathMetaHdr</code>) defines meta information about the SCION path that is contained in the path header. It has the following format:<a href="#section-2.3.2.1-1" class="pilcrow">¶</a></p>
<span id="name-scion-path-type-format-of-t"></span><div id="_figure-7">
<figure id="figure-9">
              <div class="alignLeft art-text artwork" id="section-2.3.2.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┼─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┤
│ C │  CurrHF   │    RSV    │  Seg0Len  │  Seg1Len  │  Seg2Len  │
└───┴───────────┴───────────┴───────────┴───────────┴───────────┘
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-scion-path-type-format-of-t" class="selfRef">SCION path type - Format of the Path Meta Header field</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.3.2.1-3.1">
                <p id="section-2.3.2.1-3.1.1"><code>C</code> (urrINF): Specifies a 2-bits index (0-based) pointing to the current Info Field for the packet on its way through the network. For details, see <a href="#offset-calc" class="auto internal xref">Section 2.3.2.2</a> below.<a href="#section-2.3.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.1-3.2">
                <p id="section-2.3.2.1-3.2.1"><code>CurrHF</code>: Specifies a 6-bits index (0-based) pointing to the current Hop Field for the packet on its way through the network. For details, see <a href="#offset-calc" class="auto internal xref">Section 2.3.2.2</a> below. Note that the <code>CurrHF</code> index <span class="bcp14">MUST</span> point to a Hop Field that is part of the current path segment, as indicated by the <code>CurrINF</code> index.<a href="#section-2.3.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.2.1-4">Both indices are used by SCION routers when forwarding data traffic through the network. The SCION routers also increment the indexes if required. For more details, see <a href="#process-router" class="auto internal xref">Section 4.2.2</a>.<a href="#section-2.3.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2.1-5.1">
                <p id="section-2.3.2.1-5.1.1"><code>Seg{0,1,2}Len</code>: The number of Hop Fields in a given segment. Seg{i}Len &gt; 0 implies that segment <em>i</em> contains at least one Hop Field, which means that Info Field <em>i</em> exists. (If Seg{i}Len = 0 then segment <em>i</em> is empty, meaning that this path does not include segment <em>i</em>, and therefore there is no Info Field <em>i</em>.) The following rules apply:<a href="#section-2.3.2.1-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2.1-5.1.2.1">
                    <p id="section-2.3.2.1-5.1.2.1.1">The total number of Hop Fields in an end-to-end path <span class="bcp14">MUST</span> be equal to the sum of all <code>Seg{0,1,2}Len</code> contained in this end-to-end path.<a href="#section-2.3.2.1-5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-2.3.2.1-5.1.2.2">
                    <p id="section-2.3.2.1-5.1.2.2.1">It is an error to have Seg{X}Len &gt; 0 AND Seg{Y}Len == 0, where 2 &gt;= <em>X</em> &gt; <em>Y</em> &gt;= 0. That is, if path segment Y is empty, the following path segment X <span class="bcp14">MUST</span> also be empty.<a href="#section-2.3.2.1-5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.3.2.1-5.2">
                <p id="section-2.3.2.1-5.2.1"><code>RSV</code>: Unused and reserved for future use.<a href="#section-2.3.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="offset-calc">
<section id="section-2.3.2.2">
            <h5 id="name-path-offset-calculations">
<a href="#section-2.3.2.2" class="section-number selfRef">2.3.2.2. </a><a href="#name-path-offset-calculations" class="section-name selfRef">Path Offset Calculations</a>
            </h5>
<p id="section-2.3.2.2-1">The path offset calculations are used by the SCION border routers to determine the Info Field and Hop Field that are currently valid for the packet on its way through the network.<a href="#section-2.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2.2-2">The following rules apply when calculating the path offsets:<a href="#section-2.3.2.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.2.2-3">
<pre>
   if Seg2Len &gt; 0: NumINF = 3
   else if Seg1Len &gt; 0: NumINF = 2
   else if Seg0Len &gt; 0: NumINF = 1
   else: invalid
</pre><a href="#section-2.3.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2.2-4">The offsets of the current Info Field and current Hop Field (relative to the end of the address header) are now calculated as:<a href="#section-2.3.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.2.2-5">
<pre>
   B = byte
   InfoFieldOffset = 4B + 8B * CurrINF
   HopFieldOffset = 4B + 8B.NumINF + 12B * CurrHF
</pre><a href="#section-2.3.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2.2-6">To check that the current Hop Field is in the segment of the current Info Field, the <code>CurrHF</code> needs to be compared to the <code>SegLen</code> fields of the current and preceding Info Fields.<a href="#section-2.3.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="inffield">
<section id="section-2.3.2.3">
            <h5 id="name-info-field">
<a href="#section-2.3.2.3" class="section-number selfRef">2.3.2.3. </a><a href="#name-info-field" class="section-name selfRef">Info Field</a>
            </h5>
<p id="section-2.3.2.3-1">The 8-byte Info Field (<code>InfoField</code>) has the following format:<a href="#section-2.3.2.3-1" class="pilcrow">¶</a></p>
<span id="name-scion-path-type-format-of-th"></span><div id="_figure-8">
<figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-2.3.2.3-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┼─┼─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│    RSV    │P│C│      RSV      │             Acc               │
├───────────┴─┴─┴───────────────┴───────────────────────────────┤
│                           Timestamp                           │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-scion-path-type-format-of-th" class="selfRef">SCION path type - Format of the Info Field</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.3.2.3-3.1">
                <p id="section-2.3.2.3-3.1.1"><code>RSV</code>: Unused and reserved for future use.<a href="#section-2.3.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.3-3.2">
                <p id="section-2.3.2.3-3.2.1"><code>P</code>: Peering flag. If the flag has value "1", the segment represented by this Info Field contains a peering Hop Field, which requires special processing in the data plane. For more details, see <a href="#peerlink" class="auto internal xref">Section 4.1.2</a> and <a href="#packet-verif" class="auto internal xref">Section 4.2</a>.<a href="#section-2.3.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.3-3.3">
                <p id="section-2.3.2.3-3.3.1"><code>C</code>: Construction direction flag. If the flag has value "1", the Hop Fields in the segment represented by this Info Field are arranged in the direction they have been constructed during beaconing.<a href="#section-2.3.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.3-3.4">
                <p id="section-2.3.2.3-3.4.1"><code>Acc</code>: Accumulator. This updatable field/counter is <span class="bcp14">REQUIRED</span> for calculating the MAC in the data plane. For more details, see <a href="#auth-chained-macs" class="auto internal xref">Section 4.1</a>.<a href="#section-2.3.2.3-3.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.3-3.5">
                <p id="section-2.3.2.3-3.5.1"><code>Timestamp</code>: Timestamp created by the initiator of the corresponding beacon. The timestamp is defined as the number of seconds elapsed since the POSIX Epoch (1970-01-01 00:00:00 UTC), encoded as a 32-bit unsigned integer. This timestamp enables the validation of a Hop Field in the segment represented by this Info Field, by verifying the expiration time and MAC set in the Hop Field - the expiration time of a Hop Field is calculated relative to the timestamp. A Info field with a timestamp in the future is invalid. For the purpose of validation, a timestamp is considered "future" if it is later than the locally available current time plus 337.5 seconds (i.e. the minimum time to live of a hop).<a href="#section-2.3.2.3-3.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="hopfld">
<section id="section-2.3.2.4">
            <h5 id="name-hop-field">
<a href="#section-2.3.2.4" class="section-number selfRef">2.3.2.4. </a><a href="#name-hop-field" class="section-name selfRef">Hop Field</a>
            </h5>
<p id="section-2.3.2.4-1">The 12-byte Hop Field (<code>HopField</code>) has the following format:<a href="#section-2.3.2.4-1" class="pilcrow">¶</a></p>
<span id="name-scion-path-type-format-of-the"></span><div id="_figure-9">
<figure id="figure-11">
              <div class="alignLeft art-text artwork" id="section-2.3.2.4-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┼─┼─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│    RSV    │I│E│    ExpTime    │          ConsIngress          │
├───────────┴─┴─┴───────────────┼───────────────────────────────┤
│          ConsEgress           │                               │
├───────────────────────────────┘                               ┤
│                              MAC                              │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-scion-path-type-format-of-the" class="selfRef">SCION path type - Format of the Hop Field</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.3.2.4-3.1">
                <p id="section-2.3.2.4-3.1.1"><code>RSV</code>: Unused and reserved for future use.<a href="#section-2.3.2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.4-3.2">
                <p id="section-2.3.2.4-3.2.1"><code>I</code>: The Ingress Router Alert flag. If this has value "1" and the packet is received on the interface with ID  corresponding to the value of <code>ConsIngress</code>, the router <span class="bcp14">SHOULD</span> process the L4 payload in the packet.<a href="#section-2.3.2.4-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.4-3.3">
                <p id="section-2.3.2.4-3.3.1"><code>E</code>: The Egress Router Alert flag. If this has value "1" and the packet is received on the interface with ID  corresponding to the value of <code>ConsEgress</code>, the router <span class="bcp14">SHOULD</span> process the L4 payload in the packet.<a href="#section-2.3.2.4-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.4-3.4">
                <p id="section-2.3.2.4-3.4.1"><code>ExpTime</code>: Expiration time of a Hop Field. This field is 1-byte long, and the expiration time specified in this field is relative and expressed in units of 256th of a day. An absolute expiration time in seconds is computed in combination with the <code>Timestamp</code> field (from the corresponding Info Field), as follows:<a href="#section-2.3.2.4-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2.4-3.4.2.1">
                    <p id="section-2.3.2.4-3.4.2.1.1"><code>Timestamp</code> + (1 + <code>ExpTime</code>) * (86400/256)<a href="#section-2.3.2.4-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.3.2.4-3.5">
                <p id="section-2.3.2.4-3.5.1"><code>ConsIngress</code>, <code>ConsEgress</code>: The 16-bits ingress/egress interface IDs in construction direction, that is, the direction of beaconing.<a href="#section-2.3.2.4-3.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.2.4-3.6">
                <p id="section-2.3.2.4-3.6.1"><code>MAC</code>: The 6-byte Message Authentication Code to authenticate the Hop Field. For details on how this MAC is calculated, see <a href="#hf-mac-overview" class="auto internal xref">Section 4.1.1</a>.<a href="#section-2.3.2.4-3.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.2.4-4">The Ingress Router (respectively Egress Router) is the router owning the Ingress interface (respectively, Egress interface) when the packet is traveling in the <em>construction direction</em> of the path segment (i.e. the direction of beaconing). When the packet is traveling in the opposite direction, the meanings are reversed.<a href="#section-2.3.2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.3.2.4-5">Router alert flags work similarly to <span>[<a href="#RFC2711" class="cite xref">RFC2711</a>]</span> and allow a sender to address a specific router on the path without knowing its address. Processing the L4 payload in the packet means that the router will treat the payload of the packet as a message to itself and parse it according to the value of the <code>NextHdr</code> field. Such messages include Traceroute Requests (see <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span> section "SCMP/Traceroute Request").<a href="#section-2.3.2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.3.2.4-6">Setting multiple router alert flags on a path <span class="bcp14">SHOULD</span> be avoided. This is because the router for which the corresponding Router Alert flag is set to "1" may process the request without further forwarding it along the path. Use cases that require multiple routers/hops on the path to process a packet <span class="bcp14">SHOULD</span> rely on a hop-by-hop extension (see <a href="#ext-header" class="auto internal xref">Section 2.4</a>).<a href="#section-2.3.2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="onehop">
<section id="section-2.3.3">
          <h4 id="name-one-hop-path-type">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-one-hop-path-type" class="section-name selfRef">One-Hop Path Type</a>
          </h4>
<p id="section-2.3.3-1">The <code>OneHopPath</code> path type (<code>PathType=2</code>) is currently used to bootstrap beaconing between neighboring ASes. This is necessary as neighbor ASes do not have a forwarding path before beaconing is started.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-2">A one-hop path has exactly one Info Field and two Hop Fields with the specialty that the second Hop Field is not known a priori, but is instead created by the ingress SCION border router of the neighboring AS while processing the one-hop path. Any entity with access to the forwarding key of the source endpoint AS can create a valid info and Hop Field as described in <a href="#inffield" class="auto internal xref">Section 2.3.2.3</a> and <a href="#hopfld" class="auto internal xref">Section 2.3.2.4</a>, respectively.<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3.3-3">Upon receiving a packet containing a one-hop path, the ingress border router of the destination AS fills in the <code>ConsIngress</code> field in the second Hop Field of the one-hop path with the ingress interface ID. It sets the <code>ConsEgress</code> field to an invalid value (e.g. unspecified value 0), ensuring the path cannot be used beyond the destination AS. Then it calculates and appends the appropriate MAC for the Hop Field.<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3.3-4"><a href="#_figure-10" class="auto internal xref">Figure 12</a> below shows the layout of a SCION one-hop path type. There is only a single Info Field; the appropriate Hop Field can be processed by a border router based on the source and destination address. In this context, the following rules apply:<a href="#section-2.3.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.3-5.1">
              <p id="section-2.3.3-5.1.1">At the source endpoint AS, <em>CurrHF := 0</em>.<a href="#section-2.3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-5.2">
              <p id="section-2.3.3-5.2.1">At the destination endpoint AS, <em>CurrHF := 1</em>.<a href="#section-2.3.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-layout-of-the-scion-one-hop"></span><div id="_figure-10">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-2.3.3-6.1">
<pre>
┌───────────────────────────────────────────────────────────────┐
│                           InfoField                           │
├───────────────────────────────────────────────────────────────┤
│                           HopField                            │
├───────────────────────────────────────────────────────────────┤
│                           HopField                            │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-layout-of-the-scion-one-hop" class="selfRef">Layout of the SCION one-hop path type</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="reverse">
<section id="section-2.3.4">
          <h4 id="name-path-reversal">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-path-reversal" class="section-name selfRef">Path Reversal</a>
          </h4>
<p id="section-2.3.4-1">When a destination endpoint receives a SCION packet, it <span class="bcp14">MAY</span> use the path information in the SCION header for sending the reply packets. To reverse a path, the destination endpoint <span class="bcp14">MUST</span> perform the following steps:<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.4-2">
<li id="section-2.3.4-2.1">
              <p id="section-2.3.4-2.1.1">Reverse the order of the Info Fields;<a href="#section-2.3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.4-2.2">
              <p id="section-2.3.4-2.2.1">Reverse the order of the Hop Fields;<a href="#section-2.3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.4-2.3">
              <p id="section-2.3.4-2.3.1">For each Info Field, negate the construction direction flag <code>C</code>; do not change the accumulator field <code>Acc</code>.<a href="#section-2.3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.4-2.4">
              <p id="section-2.3.4-2.4.1">In the <code>PathMetaHdr</code> field:<a href="#section-2.3.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-2.4.2.1">
                  <p id="section-2.3.4-2.4.2.1.1">Set the <code>CurrINF</code> and <code>CurrHF</code> to "0".<a href="#section-2.3.4-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.3.4-2.4.2.2">
                  <p id="section-2.3.4-2.4.2.2.1">Reverse the order of the non-zero <code>SegLen</code> fields.<a href="#section-2.3.4-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="ext-header">
<section id="section-2.4">
        <h3 id="name-extension-headers">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-extension-headers" class="section-name selfRef">Extension Headers</a>
        </h3>
<p id="section-2.4-1">SCION provides two types of extension headers:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-2.1">
            <p id="section-2.4-2.1.1">The Hop-by-Hop Options header is used to carry <span class="bcp14">OPTIONAL</span> information that <span class="bcp14">MAY</span> be examined and processed by every SCION router along a packet's delivery path. The Hop-by-Hop Options header is identified by value "200" in the <code>NextHdr</code> field of the SCION common header (see <a href="#common-header" class="auto internal xref">Section 2.1</a>).<a href="#section-2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.2">
            <p id="section-2.4-2.2.1">The End-to-End Options header is used to carry <span class="bcp14">OPTIONAL</span> information that <span class="bcp14">MAY</span> be examined and processed by the sender and/or the receiving endpoints of the packet. The End-to-End Options header is identified by value "201" in the <code>NextHdr</code> field of the SCION common header (see <a href="#common-header" class="auto internal xref">Section 2.1</a>).<a href="#section-2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.4-3">If both headers are present, the Hop-by-Hop Options header <span class="bcp14">MUST</span> come before the End-to-End Options header.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4"><strong>Note:</strong> The SCION extension headers are defined and used based on and similar to the IPv6 extensions as specified in section 4 of <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>. The SCION Hop-by-Hop Options header and End-to-End Options header resemble the IPv6 Hop-by-Hop Options Header (section 4.3 in the RFC) and Destination Options Header (section 4.6), respectively.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">The SCION Hop-by-Hop Options and End-to-End Options headers are aligned to 4 bytes and have the following format:<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<span id="name-extension-headers-options-h"></span><div id="_figure-11">
<figure id="figure-13">
          <div class="alignLeft art-text artwork" id="section-2.4-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│    NextHdr    │     ExtLen    │            Options            │
├───────────────┴───────────────┘                               ┤
│                                                               │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-extension-headers-options-h" class="selfRef">Extension headers: Options header</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.4-7.1">
            <p id="section-2.4-7.1.1"><code>NextHdr</code>: Unsigned 8-bit integer. Identifies the type of header immediately following the Hop-by-Hop/End-to-End Options header. Values of this field respect the Assigned SCION Protocol Numbers (see also <a href="#protnum" class="auto internal xref">Appendix "Assigned SCION Protocol Numbers"</a>).<a href="#section-2.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-7.2">
            <p id="section-2.4-7.2.1"><code>ExtLen</code>: 8-bit unsigned integer. The length of the Hop-by-hop or End-to-end options header in 4-octet units, not including the first 4 octets. That is: <code>ExtLen = uint8(((L + 2) / 4) - 1)</code>, where <code>L</code> is the size of the header in bytes, assuming that <code>L + 2</code> is a multiple of 4.<a href="#section-2.4-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-7.3">
            <p id="section-2.4-7.3.1"><code>Options</code>: This is a variable-length field. The length of this field <span class="bcp14">MUST</span> be such that the complete length of the Hop-by-Hop/End-to-End Options header is an integer multiple of 4 bytes. This can be achieved by using options of type 0 or 1 (see <a href="#_table-4" class="auto internal xref">Table 4</a>) . The <code>Options</code> field contains one or more Type-Length-Value (TLV) encoded options. For details, see <a href="#optfld" class="auto internal xref">Section 2.4.1</a>.<a href="#section-2.4-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="optfld">
<section id="section-2.4.1">
          <h4 id="name-options-field">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-options-field" class="section-name selfRef">Options Field</a>
          </h4>
<p id="section-2.4.1-1">The <code>Options</code> field of the Hop-by-Hop Options and the End-to-End Options headers carries a variable number of options that are type-length-value (TLV) encoded. Each TLV-encoded option has the following format:<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<span id="name-options-field-tlv-encoded-o"></span><div id="_figure-12">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-2.4.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│    OptType    │  OptDataLen   │            OptData            │
├───────────────┴───────────────┘                               ┤
│                              ...                              │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-options-field-tlv-encoded-o" class="selfRef">Options field: TLV-encoded options</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.4.1-3.1">
              <p id="section-2.4.1-3.1.1"><code>OptType</code>: 8-bit identifier of the type of option. The following option types are assigned to the SCION HBH/E2E Options header:<a href="#section-2.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-option-types-of-scion-optio"></span><div id="_table-5">
<table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-option-types-of-scion-optio" class="selfRef">Option types of SCION Options header</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Decimal</th>
                <th class="text-left" rowspan="1" colspan="1">Option Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Pad1 (see <a href="#pad1" class="auto internal xref">Section 2.4.1.1</a>)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">PadN (see <a href="#padn" class="auto internal xref">Section 2.4.1.2</a>)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">SCION Packet Authenticator Option.<br> Only used by the End-to-End Options header (experimental).</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">253</td>
                <td class="text-left" rowspan="1" colspan="1">Used for experimentation and testing</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">254</td>
                <td class="text-left" rowspan="1" colspan="1">Used for experimentation and testing</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">255</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="normal">
<li class="normal" id="section-2.4.1-5.1">
              <p id="section-2.4.1-5.1.1"><code>OptDataLen</code>: Unsigned 8-bit integer denoting the length of the <code>OptData</code> field of this option in bytes.<a href="#section-2.4.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.4.1-5.2">
              <p id="section-2.4.1-5.2.1"><code>OptData</code>: Variable-length field. Option-type specific data.<a href="#section-2.4.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.4.1-6">The options within a header <span class="bcp14">MUST</span> be processed strictly in the order they appear in the header. This is to prevent a receiver from, for example, scanning through the header looking for a specific option and processing this option prior to all preceding ones.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">Individual options may have specific alignment requirements, to ensure that multibyte values within the <code>OptData</code> fields have natural boundaries. The alignment requirement of an option is specified using the notation "xn+y". This means that the <code>OptType</code> <span class="bcp14">MUST</span> appear at an integer multiple of x bytes from the start of the header, plus y bytes. For example:<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4.1-8.1">
              <p id="section-2.4.1-8.1.1"><code>2n</code>: means any 2-bytes offset from the start of the header.<a href="#section-2.4.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.4.1-8.2">
              <p id="section-2.4.1-8.2.1"><code>4n+2</code>: means any 4-bytes offset from the start of the header, plus 2 bytes.<a href="#section-2.4.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.4.1-9">There are two padding options to align subsequent options and to pad out the containing header to a multiple of 4 bytes in length - for details, see below. All SCION implementations <span class="bcp14">MUST</span> recognize these padding options.<a href="#section-2.4.1-9" class="pilcrow">¶</a></p>
<div id="pad1">
<section id="section-2.4.1.1">
            <h5 id="name-pad1-option">
<a href="#section-2.4.1.1" class="section-number selfRef">2.4.1.1. </a><a href="#name-pad1-option" class="section-name selfRef">Pad1 Option</a>
            </h5>
<p id="section-2.4.1.1-1">Alignment requirement: none.<a href="#section-2.4.1.1-1" class="pilcrow">¶</a></p>
<span id="name-tlv-encoded-options-pad1-op"></span><div id="_figure-13">
<figure id="figure-15">
              <div class="alignLeft art-text artwork" id="section-2.4.1.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
┌───────────────┐
│       0       │
└───────────────┘
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-tlv-encoded-options-pad1-op" class="selfRef">TLV-encoded options - Pad1 option</a>
              </figcaption></figure>
</div>
<p id="section-2.4.1.1-3"><strong>Note:</strong> The format of the Pad1 option is a special case - it does not have length and value fields.<a href="#section-2.4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1.1-4">The Pad1 option is used to insert 1 byte of padding into the <code>Options</code> field of an extension header. If more than one byte of padding is required, the PadN option <span class="bcp14">MUST</span> be used.<a href="#section-2.4.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="padn">
<section id="section-2.4.1.2">
            <h5 id="name-padn-option">
<a href="#section-2.4.1.2" class="section-number selfRef">2.4.1.2. </a><a href="#name-padn-option" class="section-name selfRef">PadN Option</a>
            </h5>
<p id="section-2.4.1.2-1">Alignment requirement: none.<a href="#section-2.4.1.2-1" class="pilcrow">¶</a></p>
<span id="name-tlv-encoded-options-padn-op"></span><div id="_figure-14">
<figure id="figure-16">
              <div class="alignLeft art-text artwork" id="section-2.4.1.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│       1       │  OptDataLen   │            OptData            │
├───────────────┴───────────────┘                               ┤
│                              ...                              │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-tlv-encoded-options-padn-op" class="selfRef">TLV-encoded options - PadN option</a>
              </figcaption></figure>
</div>
<p id="section-2.4.1.2-3">The PadN option is used to insert two or more bytes of padding into the <code>Options</code> field of an extension header. For N bytes of padding, the <code>OptDataLen</code> field contains the value N-2, and the <code>OptData</code> consists of N-2 zero-valued bytes.<a href="#section-2.4.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="pseudo">
<section id="section-2.5">
        <h3 id="name-pseudo-header-for-upper-lay">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-pseudo-header-for-upper-lay" class="section-name selfRef">Pseudo Header for Upper-Layer Checksum</a>
        </h3>
<p id="section-2.5-1">The SCION Data Plane does not provide payload integrity protection, as further clarified in <a href="#payload-integrity" class="auto internal xref">Section 7.2.2</a>.
Should any transport or other upper-layer protocols compute a checksum of the SCION header, then they <span class="bcp14">SHOULD</span> use the following pseudo header:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<span id="name-layout-of-the-pseudo-header"></span><div id="_figure-15">
<figure id="figure-17">
          <div class="alignLeft art-text artwork" id="section-2.5-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤◀─┐
│            DstISD             │                               │  │
├───────────────────────────────┘                               ┤  │
│                             DstAS                             │  │
├───────────────────────────────┬───────────────────────────────┤  │
│            SrcISD             │                               │  │ SCION
├───────────────────────────────┘                               ┤  │ address
│                             SrcAS                             │  │ header
├───────────────────────────────────────────────────────────────┤  │
│                 DstHostAddr (variable length)                 │  │
├───────────────────────────────────────────────────────────────┤  │
│                 SrcHostAddr (variable length)                 │  │
├───────────────────────────────────────────────────────────────┤◀─┘
│                   Upper-Layer Packet Length                   │
├───────────────────────────────────────────────┬───────────────┤
│                      zero                     │  Next Header  │
└───────────────────────────────────────────────┴───────────────┘
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-layout-of-the-pseudo-header" class="selfRef">Layout of the pseudo header for the upper-layer checksum</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.5-3.1">
            <p id="section-2.5-3.1.1"><code>DstISD</code>, <code>SrcISD</code>, <code>DstAS</code>, <code>SrcAS</code>, <code>DstHostAddr</code>, <code>SrcHostAddr</code>: These values are taken from the SCION address header.<a href="#section-2.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.5-3.2">
            <p id="section-2.5-3.2.1"><code>Upper-Layer Packet Length</code>: The length of the upper-layer header and data. Some upper-layer protocols define headers that carry the length information explicitly (e.g. UDP). This information is used as the upper-layer packet length in the pseudo header for these protocols. The remaining protocols, which do not carry the length information directly, use the value from the <code>PayloadLen</code> field in the SCION common header, minus the sum of the extension header lengths.<a href="#section-2.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.5-3.3">
            <p id="section-2.5-3.3.1"><code>Next Header</code>: The protocol identifier associated with the upper-layer protocol (e.g., 17 for UDP - see also <a href="#protnum" class="auto internal xref">Appendix "Assigned SCION Protocol Numbers"</a>). This field can differ from the <code>NextHdr</code> field in the SCION common header, if extensions are present.<a href="#section-2.5-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.5-4">This pseudo-header is used in current implementations of UDP on top of SCION. However, as checksums across layers are not recommended, this should be re-evaluated in future revisions.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="life-of-a-packet">
<section id="section-3">
      <h2 id="name-life-of-a-scion-data-packet">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-life-of-a-scion-data-packet" class="section-name selfRef">Life of a SCION Data Packet</a>
      </h2>
<p id="section-3-1">This section gives a high-level description of the life cycle of a SCION packet: how it is created at its source endpoint, passes through a number of SCION routers, and finally reaches its destination endpoint. It is assumed that both source and destination are native SCION endpoints (i.e. they both run a native SCION network stack).<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This example illustrates an intra-ISD case, i.e. all communication happening within a single ISD. As the sample ISD only consists of one core AS, the end-to-end path only includes an up-path and down-path segment. In the case of inter-ISD forwarding, the complete end-to-end path from source endpoint to destination endpoint would always require a core path segment as well, although this makes no difference for the forwarding process which works the same in an intra-ISD and inter-ISD context.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="description">
<section id="section-3.1">
        <h3 id="name-description">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-description" class="section-name selfRef">Description</a>
        </h3>
<span id="name-sample-topology-to-illustra"></span><div id="_figure-16">
<figure id="figure-18">
          <div class="alignLeft art-text artwork" id="section-3.1-1.1">
<pre>
                  ┌─────────────────────────┐
                  │                         │
                  │           AS1           │
                  │                         │ (1-1,
                  │                         │ 198.51.100.17)
                  │           198.51.100.4┌─┴─┐i1b
                  │            ┌──────────┤R3 ├──┐
             i1a┌─┴─┐          │          └─┬─┘  │
             ┌──┤R2 ├──────────┘            │    │
             │  └─┬─┘198.51.100.1           │    │
             │    │                         │    │
             │    └─────────────────────────┘    │ (1-3,
             │                                   │ 198.51.100.18)
        i2a┌─┴─┐                               ┌─┴─┐i3a
┌──────────┤R1 ├──────────┐         ┌──────────┤R4 ├──────────┐
│          └─┬─┘          │         │          └─┬─┘          │
│            │203.0.113.17│         │            │192.0.2.34  │
│            │            │         │            │            │
│            │    AS2     │         │            │    AS3     │
│            │            │         │            │            │
│     ┌──────┴─────┐      │         │      ┌─────┴──────┐     │
│     │ Endpoint A │      │         │      │ Endpoint B │     │
│     └────────────┘      │         │      └────────────┘     │
│     1-2,203.0.113.6     │         │      1-3,192.0.2.7      │
│                         │         │                         │
└─────────────────────────┘         └─────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-sample-topology-to-illustra" class="selfRef">Sample topology to illustrate the life cycle of a SCION packet. AS1 is the core AS of ISD 1, and AS2 and AS3 are non-core ASes of ISD 1.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-2">Based on the network topology in <a href="#_figure-16" class="auto internal xref">Figure 18</a> above, this example shows the path of a SCION packet sent from its source at Endpoint A to its destination at Endpoint B, and how it will be processed by each router on the path using simplified snapshots of the packet header after each processing step. These snapshots, which are depicted in tables, show the most relevant information of the header, i.e. the SCION path and IP encapsulation for local communication.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="creating-an-end-to-end-scion-forwarding-path">
<section id="section-3.2">
        <h3 id="name-creating-an-end-to-end-scio">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-creating-an-end-to-end-scio" class="section-name selfRef">Creating an End-to-End SCION Forwarding Path</a>
        </h3>
<p id="section-3.2-1">In this example, Endpoint A in AS2 wants to send a data packet to Endpoint B in AS3. Both AS2 and AS3 are part of ISD 1. To create an end-to-end SCION forwarding path, Endpoint A first requests its own AS2 control service for up segments to the core AS in its ISD. The AS2 control service will return up segments from AS2 to the ISD core. Endpoint A will also query its AS2 control service for a down segment from its ISD core AS to AS3, in which Endpoint B is located. The AS2 control service will return down segments from the ISD core down to AS3.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"><strong>Note:</strong> For more details on the lookup of path segments, see the section "Path Lookup" in the Control Plane specification (<span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Based on its own selection criteria, Endpoint A selects the up segment (0,i2a)(i1a,0) and the down segment (0,i1b)(i3a,0) from the path segments returned by its own AS2 control service. The path segments consist of Hop Fields that carry the ingress and egress interfaces of each AS (e.g., i2a, i1a, ...), as described in detail in <a href="#header" class="auto internal xref">Section 2</a> - (x,y) represents one Hop Field.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">To obtain an end-to-end forwarding path from the source AS to the destination AS, Endpoint A combines the two path segments into the resulting SCION forwarding path, which contains the two Info Fields <em>IF1</em> and <em>IF2</em> and the Hop Fields (0,i2a), (i1a,0), (0,i1b), and (i3a,0).<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5"><strong>Note:</strong> As this brief sample path does not contain a core segment, the end-to-end path only consists of two path segments.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">Endpoint A now adds this end-to-end forwarding path to the header of the packet that it wants to send to Endpoint B, and starts transferring the packet.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-by-step-explanation">
<section id="section-3.3">
        <h3 id="name-step-by-step-explanation">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-step-by-step-explanation" class="section-name selfRef">Step-by-Step Explanation</a>
        </h3>
<p id="section-3.3-1">This section explains what happens with the SCION packet header at each router, based on the network topology in described <a href="#_figure-16" class="auto internal xref">Figure 18</a> above. Each step includes a table that represents a simplified snapshot of the packet header at the end of this specific step. Regarding the notation used in the figure/tables, each source and destination entry should be read as router (or endpoint) followed by its address. The current Info Field (with metadata on the current path segment) in the SCION header is depicted as italic/cursive in the tables. The current Hop Field, representing the current AS, is shown bold. The snapshot tables also include references to IP/UDP addresses. In this context, words "ingress" and "egress" refer to the direction of travel of SCION data packets.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1"><em>Step 1</em> <br> <strong>A-&gt;R1</strong>: The SCION-enabled Endpoint A in AS2 creates a new SCION packet destined for destination endpoint B in AS3, with payload P. Endpoint A sends the packet (for the chosen forwarding path) to the next SCION router as provided by its control service, which is in this case Router 1. Endpoint A encapsulates the SCION packet into an underlay UDP/IPv4 header for the local delivery to Router 1, utilizing AS2's internal routing protocol. The current Info Field is <em>IF1</em>. Upon receiving the packet, Router 1 will forward the packet on the egress interface that endpoint A has included into the first Hop Field of the SCION header.<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-snapshot-header-step-1"></span><table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-snapshot-header-step-1" class="selfRef">Snapshot header - step 1</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">A -&gt; R1</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SCION</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 1-2,203.0.113.6 (source Endpoint A) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 1-3,192.0.2.7 (dest. Endpoint B) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">PATH = <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- <em>IF1</em> <strong>(0,i2a)</strong> (i1a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- IF2 (0,i1b) (i3a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">UDP</td>
              <td class="text-left" rowspan="1" colspan="1">P<sub>S</sub> = 30041, P<sub>D</sub> = 30041 <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IP</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 203.0.113.6 (Endpoint A) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 203.0.113.17 (Router 1) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Link layer</td>
              <td class="text-left" rowspan="1" colspan="1">SRC=A, DST=R1</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">
            <p id="section-3.3-4.1.1"><em>Step 2</em> <br> <strong>R1-&gt;R2</strong>: Router 1 inspects the SCION header and considers the relevant Info Field of the specified SCION path, which is the Info Field indicated by the current Info Field pointer. In this case, it is the first Info Field <em>IF1</em>. The current Hop Field is the first Hop Field (0,i2a), which instructs router 1 to forward the packet on its interface i2a. After reading the current Hop Field, Router 1 moves the pointer forward by one position to the second Hop Field (i1a,0).<a href="#section-3.3-4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.3-4.1.2">
The link shown here is an example of not using a UDP/IP underlay. Although most implementations use such an encapsulation, SCION only requires link-layer connectivity. What is used for one given inter-AS link is a function of the available implementations at each end, the available infrastructure, and the joint preference of the two ASes administrators.<a href="#section-3.3-4.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-snapshot-header-step-2"></span><table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-snapshot-header-step-2" class="selfRef">Snapshot header - step 2</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">R1 -&gt; R2</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SCION</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 1-2,203.0.113.6 (source Endpoint A) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 1-3,192.0.2.7 (dest. Endpoint B) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">PATH = <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- <em>IF1</em> (0,i2a) <strong>(i1a,0)</strong>  <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- IF2 (0,i1b) (i3a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Link layer</td>
              <td class="text-left" rowspan="1" colspan="1">SRC=R1, DST=R2</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-3.3-6.1">
            <p id="section-3.3-6.1.1"><em>Step 3</em> <br> <strong>R2-&gt;R3</strong>: When receiving the packet, Router 2 of Core AS1 checks whether the packet has been received through the ingress interface i1a as specified by the current Hop Field. Otherwise, the packet is dropped by Router 2. The router notices that it has consumed the last Hop Field of the current path segment, and hence moves the pointer from the current Info Field to the next Info Field <em>IF2</em>. The corresponding current Hop Field is (0,i1b), which contains egress interface i1b. Router maps the i1b interface ID to egress Router 3, it therefore encapsulates the SCION packet inside an intra-AS underlay IP packet with the address of Router 3 as the underlay destination.<a href="#section-3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-snapshot-header-step-3"></span><table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-snapshot-header-step-3" class="selfRef">Snapshot header - step 3</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">R2 -&gt; R3</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SCION</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 1-2,203.0.113.6 (source Endpoint A) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 1-3,192.0.2.7 (dest. Endpoint B) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">PATH =  <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- IF1 (0,i2a) (i1a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- <em>IF2</em> <strong>(0,i1b)</strong> (i3a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">UDP</td>
              <td class="text-left" rowspan="1" colspan="1">P<sub>S</sub> = 30041, P<sub>D</sub> = 30041 <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IP</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 198.51.100.1 (Router 2) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 198.51.100.4 (Router 3) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Link layer</td>
              <td class="text-left" rowspan="1" colspan="1">SRC=R2, DST=R3</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-3.3-8.1">
            <p id="section-3.3-8.1.1"><em>Step 4</em> <br> <strong>R3-&gt;R4</strong>: Router 3 inspects the current Hop Field in the SCION header, uses interface i1b to forward the packet to its neighbor SCION-enabled Router 4 of AS3, and moves the current hop-field pointer forward. It adds an IP header to reach Router 4.<a href="#section-3.3-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-snapshot-header-step-4"></span><table class="center" id="table-9">
          <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-snapshot-header-step-4" class="selfRef">Snapshot header - step 4</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">R3 -&gt; R4</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SCION</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 1-2,203.0.113.6 (source Endpoint A) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 1-3,192.0.2.7 (dest. Endpoint B) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">PATH =  <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- IF1 (0,i2a) (i1a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- <em>IF2</em> (0,i1b) <strong>(i3a,0)</strong> <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">UDP</td>
              <td class="text-left" rowspan="1" colspan="1">P<sub>S</sub> = 30041, P<sub>D</sub> = 30041 <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IP</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 1-1,198.51.100.17 (Router 3) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 1-3,198.51.100.18 (Router 4) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Link layer</td>
              <td class="text-left" rowspan="1" colspan="1">SRC=R3, DST=R4</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-3.3-10.1">
            <p id="section-3.3-10.1.1"><em>Step 5</em> <br> <strong>R4-&gt;B</strong>: SCION-enabled Router 4 first checks whether the packet has been received through the ingress interface i3a as specified by the current Hop Field. Router 4 will then also realize, based on the fields <code>CurrHF</code> and <code>SegLen</code> in the SCION header, that the packet has reached the last hop in its SCION path. Therefore, instead of stepping up the pointers to the next Info Field or Hop Field, Router 4 inspects the SCION destination address and extracts the endpoint address 192.0.2.7. It creates a fresh underlay UDP/IP header with this address as destination and with itself as source. The intra-domain forwarding can now deliver the packet to its destination at Endpoint B.<a href="#section-3.3-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-snapshot-header-step-5"></span><table class="center" id="table-10">
          <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-snapshot-header-step-5" class="selfRef">Snapshot header - step 5</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">R4 -&gt; B</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SCION</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 1-2,203.0.113.6 (source Endpoint A) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 1-3,192.0.2.7 (dest. Endpoint B) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">PATH =  <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- IF1 (0,i2a) (i1a,0) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">- <em>IF2</em> (0,i1b) <strong>(i3a,0)</strong> <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">UDP</td>
              <td class="text-left" rowspan="1" colspan="1">P<sub>S</sub> = 30041, P<sub>D</sub> = 30041 <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IP</td>
              <td class="text-left" rowspan="1" colspan="1">SRC = 192.0.2.34 (Router 4) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DST = 192.0.2.7 (Endpoint B) <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Link layer</td>
              <td class="text-left" rowspan="1" colspan="1">SRC=R4, DST=B</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.3-12">When destination Endpoint B wants to respond to source Endpoint A, it can just swap the source and destination addresses in the SCION header, reverse the SCION path, and set the pointers to the Info Fields and Hop Fields at the beginning of the reversed path (see also <a href="#reverse" class="auto internal xref">Section 2.3.4</a>).<a href="#section-3.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="path-auth">
<section id="section-4">
      <h2 id="name-path-authorization-2">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-path-authorization-2" class="section-name selfRef">Path Authorization</a>
      </h2>
<p id="section-4-1">Path authorization guarantees that data packets always traverse the network along paths segments authorized by all on-path ASes in the control plane. In contrast to the IP-based Internet where forwarding decisions are made by routers based on locally stored information, SCION routers base their forwarding decisions purely on the forwarding information carried in the packet header and set by endpoints.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">SCION uses cryptographic mechanisms to efficiently provide path authorization. The mechanisms are based on <em>symmetric</em> cryptography in the form of Message Authentication Codes (MACs) in the data plane to secure forwarding information encoded in Hop Fields. This section first explains how Hop Field MACs are computed, then how they are validated as they traverse the network.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="auth-chained-macs">
<section id="section-4.1">
        <h3 id="name-authorizing-segments-throug">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authorizing-segments-throug" class="section-name selfRef">Authorizing Segments through Chained MACs</a>
        </h3>
<p id="section-4.1-1">When authorizing SCION PCBs and path segments in the control plane and forwarding information in the data plane, an AS authenticates not only its own hop information but also an aggregation of all upstream hops. This section describes how this works.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="hf-mac-overview">
<section id="section-4.1.1">
          <h4 id="name-hop-field-mac-overview">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-hop-field-mac-overview" class="section-name selfRef">Hop Field MAC Overview</a>
          </h4>
<p id="section-4.1.1-1">The MAC in the Hop Fields of a SCION path has two purposes:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-2.1">
              <p id="section-4.1.1-2.1.1">Preventing malicious endpoints from adding, removing or reordering hops within a path segment created during beaconing in the control plane. In particular, preventing path splicing, i.e. the combination of parts of different valid path segments into a new and unauthorized path segment.<a href="#section-4.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-2.2">
              <p id="section-4.1.1-2.2.1">Authentication of the information contained in the Hop Field itself, in particular the <code>ExpTime</code>, <code>ConsIngress</code>, and <code>ConsEgress</code>.<a href="#section-4.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.1-3">To fulfill these purposes, the MAC for the Hop Field of AS<sub>i</sub> includes both the components of the current Hop Field HF<sub>i</sub> and an aggregation of the path segment identifier and all preceding Hop Fields/entries in the path segment. The aggregation is a 16-bit XOR-sum of the path segment identifier and the Hop Field MACs.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">When originating a path segment construction beacon PCB in the control plane, a core AS chooses a random 16-bit value as segment identifier <code>SegID</code> for the path segment and includes it in the PCB's <code>Segment Info</code> component. In the control plane, each AS<sub>i</sub> on the path segment computes the MAC for the current HF<sub>i</sub>, based on the value of <code>SegID</code> and the MACs of the preceding hop entries. Here, the full XOR-sum is computed explicitly.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">For high-speed packet processing in the data plane, computing even cheap operations such as the XOR-sum over a variable number of inputs is complicated, in particular for hardware router implementations. To avoid this overhead for the MAC chaining in path authorization in the data plane, the XOR-sum is tracked incrementally for each of the path segments in a path as a separate, updatable Accumulator Field <code>Acc</code>. The routers update <code>Acc</code> by adding/subtracting only a single 16-bit value each.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">When combining path segments to create a path to the destination endpoint, the source endpoint <span class="bcp14">MUST</span> also initialize the value of accumulator field <code>Acc</code> for each path segment. The <code>Acc</code> field <span class="bcp14">MUST</span> contain the correct XOR-sum of the path segment identifier and preceding Hop Field MACs expected by the first router that is traversed.<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.1-7">The aggregated 16-bit path segment identifier and preceding MACs prevent splicing of different path segments unless there is a collision of the <code>Acc</code> value among compatible path segments in an AS. See <a href="#path-splicing" class="auto internal xref">Section 7.1.3</a> for more details.<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<div id="hf-mac-calc">
<section id="section-4.1.1.1">
            <h5 id="name-hop-field-mac-calculation">
<a href="#section-4.1.1.1" class="section-number selfRef">4.1.1.1. </a><a href="#name-hop-field-mac-calculation" class="section-name selfRef">Hop Field MAC - Calculation</a>
            </h5>
<p id="section-4.1.1.1-1">The Hop Field MAC is generally calculated at a current AS<sub>i</sub> as follows:<a href="#section-4.1.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.1-2.1">
                <p id="section-4.1.1.1-2.1.1">Consider a path segment with "n" hops, containing ASes AS<sub>0</sub>, ... , AS<sub>n-1</sub>, with forwarding keys K<sub>0</sub>, ... , K<sub>n-1</sub> in this order.<a href="#section-4.1.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-2.2">
                <p id="section-4.1.1.1-2.2.1">AS<sub>0</sub> is the core AS that created the PCB representing the path segment and that added a random initial 16-bit segment identifier <code>SegID</code> to the <code>Segment Info</code> field of the PCB.<a href="#section-4.1.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1.1.1-3">MAC<sub>i</sub> = <br> Ck<sub>i</sub> (<code>SegID</code> XOR MAC<sub>0</sub> [:2] ... XOR MAC<sub>i-1</sub> [:2], Timestamp, ExpTime<sub>i</sub>, ConsIngress<sub>i</sub>, ConsEgress<sub>i</sub>)<a href="#section-4.1.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1.1-4">where<a href="#section-4.1.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.1-5.1">
                <p id="section-4.1.1.1-5.1.1">k<sub>i</sub> = The forwarding key k of the current AS<sub>i</sub><a href="#section-4.1.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-5.2">
                <p id="section-4.1.1.1-5.2.1">Ck<sub>i</sub> (...) = Cryptographic checksum C over (...) computed with forwarding key k<sub>i</sub><a href="#section-4.1.1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-5.3">
                <p id="section-4.1.1.1-5.3.1"><code>SegID</code> = The random initial 16-bit segment identifier set by the core AS when creating the corresponding PCB<a href="#section-4.1.1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-5.4">
                <p id="section-4.1.1.1-5.4.1">XOR = The bitwise "exclusive or" operation<a href="#section-4.1.1.1-5.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-5.5">
                <p id="section-4.1.1.1-5.5.1">MAC<sub>i</sub> [:2] = The Hop Field MAC for AS<sub>i</sub>, truncated to 2 bytes<a href="#section-4.1.1.1-5.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-5.6">
                <p id="section-4.1.1.1-5.6.1">Timestamp = The timestamp set by the core AS when creating the corresponding PCB<a href="#section-4.1.1.1-5.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-5.7">
                <p id="section-4.1.1.1-5.7.1">ExpTime<sub>i</sub>, ConsIngress<sub>i</sub>, ConsEgress<sub>i</sub> = The content of the Hop Field HF<sub>i</sub><a href="#section-4.1.1.1-5.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1.1.1-6">Thus, the current MAC is based on the XOR-sum of the truncated MACs of all preceding Hop Fields in the path segment as well as the path segment's <code>SegID</code>. In other words, the current MAC is <em>chained</em> to all preceding MACs. In order to effectively prevent path-splicing, the cryptographic checksum function used <span class="bcp14">MUST</span> ensure that the truncation of the MACs is non-degenerate and roughly uniformly distributed (see <a href="#mac-requirements" class="auto internal xref">Section 4.1.1.4</a>).<a href="#section-4.1.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="def-acc">
<section id="section-4.1.1.2">
            <h5 id="name-accumulator-acc-definition">
<a href="#section-4.1.1.2" class="section-number selfRef">4.1.1.2. </a><a href="#name-accumulator-acc-definition" class="section-name selfRef">Accumulator Acc - Definition</a>
            </h5>
<p id="section-4.1.1.2-1">The Accumulator Acc<sub>i</sub> is an updatable counter introduced in the data plane to avoid the overhead caused by MAC-chaining for path authorization. This is achieved by incrementally tracking the XOR-sum of the previous MACs as a separate, updatable accumulator field <code>Acc</code>, which is part of the path segment's Info Field <code>InfoField</code> in the packet header (see also <a href="#inffield" class="auto internal xref">Section 2.3.2.3</a>). Routers update this field by adding/subtracting only a single 16-bit value each.<a href="#section-4.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-2"><a href="#hf-mac-calc" class="auto internal xref">Section 4.1.1.1</a> provides a general formula to compute MAC<sub>i</sub>, but at each SCION router the expression <code>SegID XOR MAC_0 [:2] ... XOR MAC_i-1 [:2]</code> is replaced by Acc<sub>i</sub>. This results in the following alternative procedure for the computation of MAC<sub>i</sub> at SCION routers:<a href="#section-4.1.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-3">MAC<sub>i</sub> = Ck<sub>i</sub> (Acc<sub>i</sub>, Timestamp, ExpTime<sub>i</sub>, ConsIngress<sub>i</sub>, ConsEgress<sub>i</sub>)<a href="#section-4.1.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-4">During forwarding, SCION routers at each AS<sub>i</sub> update the Acc field in the packet header so that it contains the correct input value of Acc for the next AS in the path segment to be able to calculate the MAC over its Hop Field. Note that the correct input value of the <code>Acc</code> field depends on the direction of travel.<a href="#section-4.1.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-5">The value of Acc<sub>i+1</sub> is calculated based on the following definition (in the direction of beaconing):<a href="#section-4.1.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-6">Acc<sub>i+1</sub> = Acc<sub>i</sub> XOR MAC<sub>i</sub> [:2]<a href="#section-4.1.1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.2-7.1">
                <p id="section-4.1.1.2-7.1.1">XOR = The bitwise "exclusive or" operation<a href="#section-4.1.1.2-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.2-7.2">
                <p id="section-4.1.1.2-7.2.1">MAC<sub>i</sub> [:2] = The Hop Field MAC for the current AS<sub>i</sub>, truncated to 2 bytes<a href="#section-4.1.1.2-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="default-hop-field-mac-algorithm">
<section id="section-4.1.1.3">
            <h5 id="name-default-hop-field-mac-algor">
<a href="#section-4.1.1.3" class="section-number selfRef">4.1.1.3. </a><a href="#name-default-hop-field-mac-algor" class="section-name selfRef">Default Hop Field MAC Algorithm</a>
            </h5>
<p id="section-4.1.1.3-1">The algorithm used to compute the Hop Field MAC is an AS-specific choice. The operator of an AS can freely choose any MAC algorithm and the control service and routers of the AS do need to agree on the algorithm used, but all implementations <span class="bcp14">MUST</span> support the Default Hop Field MAC algorithm described below.<a href="#section-4.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.3-2">The default MAC algorithm is AES-CMAC (<span>[<a href="#RFC4493" class="cite xref">RFC4493</a>]</span>) truncated to 48-bits, computed over the Info Field and the first 6 bytes of the Hop Field with flags and reserved fields zeroed out. The input is padded to 16 bytes. The <em>first</em> 6 bytes of the AES-CMAC output are used as resulting Hop Field MAC.<a href="#section-4.1.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1.3-3"><a href="#_figure-18" class="auto internal xref">Figure 19</a> below shows the layout of the input data to calculate the Hop Field MAC.<a href="#section-4.1.1.3-3" class="pilcrow">¶</a></p>
<span id="name-input-data-to-calculate-the"></span><div id="_figure-18">
<figure id="figure-19">
              <div class="alignLeft art-text artwork" id="section-4.1.1.3-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤◀─┐
│               0               │              Acc              │  │ Info
├───────────────────────────────┴───────────────────────────────┤  │ Field
│                           Timestamp                           │  │
├───────────────┬───────────────┬───────────────────────────────┤◀─┤
│       0       │    ExpTime    │          ConsIngress          │  │ Hop
├───────────────┴───────────────┼───────────────────────────────┤  │ Field
│          ConsEgress           │               0               │  │
└───────────────────────────────┴───────────────────────────────┘◀─┘
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-input-data-to-calculate-the" class="selfRef">Input data to calculate the Hop Field MAC for the default hop-field MAC algorithm</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="mac-requirements">
<section id="section-4.1.1.4">
            <h5 id="name-alternative-hop-field-mac-a">
<a href="#section-4.1.1.4" class="section-number selfRef">4.1.1.4. </a><a href="#name-alternative-hop-field-mac-a" class="section-name selfRef">Alternative Hop Field MAC Algorithms</a>
            </h5>
<p id="section-4.1.1.4-1">For alternative algorithms, the following requirements <span class="bcp14">MUST</span> all be met:<a href="#section-4.1.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.4-2.1">
                <p id="section-4.1.1.4-2.1.1">The Hop Field MAC field is computed as a function of the secret forwarding key, the <code>Acc</code> and <code>Timestamp</code> fields of the Info Field, and the <code>ExpTime</code>, <code>ConsIngress</code> and <code>ConsEgress</code> fields of the Hop Field. Function is used in the mathematical sense that for for any values of these inputs there is exactly one result.<a href="#section-4.1.1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.4-2.2">
                <p id="section-4.1.1.4-2.2.1">The algorithm returns an unforgable 48-bit value. Unforgable specifically means "existentially unforgable under a chosen message attack" (<span>[<a href="#CRYPTOBOOK" class="cite xref">CRYPTOBOOK</a>]</span>). Informally, this means an attacker without access to the secret key has no computationally efficient means to create a valid MAC for some attacker chosen input values, even if it has access to an "oracle" providing a valid MAC for any other input values.<a href="#section-4.1.1.4-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.4-2.3">
                <p id="section-4.1.1.4-2.3.1">The truncation of the result value to the first 16 bits of the result value:<a href="#section-4.1.1.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.4-2.3.2.1">
                    <p id="section-4.1.1.4-2.3.2.1.1">is not degenerate, i.e. any small change in any input value <span class="bcp14">SHOULD</span> have an "avalanche effect" on these bits, and<a href="#section-4.1.1.4-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.1.1.4-2.3.2.2">
                    <p id="section-4.1.1.4-2.3.2.2.1">is roughly uniformly distributed when considering all possible input values.<a href="#section-4.1.1.4-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-4.1.1.4-3">This additional requirement is naturally satisfied for MAC algorithms based on typical block ciphers or hash algorithms. It ensures that the MAC chaining via the <code>Acc</code> field is not degenerate.<a href="#section-4.1.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="peerlink">
<section id="section-4.1.2">
          <h4 id="name-peering-link-mac-computatio">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-peering-link-mac-computatio" class="section-name selfRef">Peering Link MAC Computation</a>
          </h4>
<p id="section-4.1.2-1">The Hop Field MAC computation described in <a href="#hf-mac-calc" class="auto internal xref">Section 4.1.1.1</a> does not apply to a peering Hop Field, i.e. to a Hop Field that allows transiting from a child interface/link to a peering interface/link.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">The reason for this is that the MACs of the Hop Fields "after" the peering Hop Field (in beaconing direction) are not chained to the MAC of the peering Hop Field, but to the MAC of the main Hop Field in the corresponding AS entry. To make this work, the MAC of the peering Hop Field is also chained to the MAC of the main Hop Field - this allows for the validation of the chained MAC for both the peering Hop Field and the following Hop Fields by using the same <code>Acc</code> field value.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">The peering Hop Field is defined as follows:<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">Hop Field<sup>Peer</sup><sub>i</sub> = (ExpTime<sup>Peer</sup><sub>i</sub>, ConsIngress<sup>Peer</sup><sub>i</sub>, ConsEgress<sup>Peer</sup><sub>i</sub>, MAC<sup>Peer</sup><sub>i</sub>)<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">See <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span> for more information.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">This results in the calculation of the MAC for the peering Hop Field<sup>Peer</sup><sub>i</sub> as follows:<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">MAC<sup>Peer</sup><sub>i</sub> = <br> Ck<sup>Peer</sup><sub>i</sub> (<code>SegID</code> XOR MAC<sub>0</sub> [:2] ... XOR MAC<sub>i</sub> [:2], Timestamp, ExpTime<sup>Peer</sup><sub>i</sub>, ConsIngress<sup>Peer</sup><sub>i</sub>, ConsEgress<sup>Peer</sup><sub>i</sub>)<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8"><strong>Note:</strong> The XOR-sum of the MACs in the formula of the peering Hop Field <strong>also includes</strong> the MAC of the main Hop Field (whereas for the calculation of the MAC for the main Hop Field itself only the XOR-sum of the <em>previous</em> MACs is used).<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-verif">
<section id="section-4.2">
        <h3 id="name-path-initialization-and-pac">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-path-initialization-and-pac" class="section-name selfRef">Path Initialization and Packet Processing</a>
        </h3>
<p id="section-4.2-1">As described in <a href="#header" class="auto internal xref">Section 2</a>, the path header of the data plane packets only contains a sequence of Info Fields and Hop Fields without any additional data from the corresponding PCBs. The SCION path also does not contain any AS numbers - except for the source and destination ASes - and there is no field explicitly defining the type of each segment (up, core, or down). This chapter describes the required steps for the source endpoint and SCION routers to respectively craft and forward a data packet.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="initialization-at-source-endpoint">
<section id="section-4.2.1">
          <h4 id="name-initialization-at-source-en">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-initialization-at-source-en" class="section-name selfRef">Initialization at Source Endpoint</a>
          </h4>
<p id="section-4.2.1-1">The source endpoint <span class="bcp14">MUST</span> perform the following steps to correctly initialize a path:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2">
<li id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">Combine the preferred end-to-end path from the path segments obtained during path lookup.<a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">Extract the Info Fields and Hop Fields from the different path segments that together build the end-to-end path to the destination endpoint. Then insert the relevant information from the Info Fields and Hop Fields into the corresponding <code>InfoFields</code> and <code>Hopfields</code> in the data packet header.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">Each 8-byte Info Field <code>InfoField</code> in the packet header contains the updatable <code>Acc</code> field as well as a Peering flag <code>P</code> and a Construction Direction flag <code>C</code> (see also <a href="#inffield" class="auto internal xref">Section 2.3.2.3</a>). As a next step in the path initialization process, the source <span class="bcp14">MUST</span> correctly set the flags and the <code>Acc</code> field of all <code>InfoFields</code> included in the path, according to the following rules:<a href="#section-4.2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.3.2.1">
                  <p id="section-4.2.1-2.3.2.1.1">The Construction Direction flag <code>C</code> <span class="bcp14">MUST</span> be set to "1" whenever the corresponding segment is traversed in construction direction, i.e., for down-path segments and potentially for core segments. It <span class="bcp14">MUST</span> be set to "0" for up-path segments and "reversed" core segments.<a href="#section-4.2.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-2.3.2.2">
                  <p id="section-4.2.1-2.3.2.2.1">The Peering flag <code>P</code> <span class="bcp14">MUST</span> be set to "1" for up-segments and down-segments if the path contains a peering Hop Field.<a href="#section-4.2.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.2.1-2.3.3">
The following <code>InfoField</code> settings are possible, based on the following cases:<a href="#section-4.2.1-2.3.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.3.4.1">
                  <p id="section-4.2.1-2.3.4.1.1"><strong>Case 1</strong> <br> The path segment is traversed in construction direction and includes no peering Hop Field. It starts at the <em>i</em>-th AS of the full segment discovered in beaconing. In this case:<a href="#section-4.2.1-2.3.4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.3.4.1.2.1">
                      <p id="section-4.2.1-2.3.4.1.2.1.1">The Peering flag <code>P</code> = "0"<a href="#section-4.2.1-2.3.4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.1-2.3.4.1.2.2">
                      <p id="section-4.2.1-2.3.4.1.2.2.1">The Construction Direction flag <code>C</code> = "1"<a href="#section-4.2.1-2.3.4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.1-2.3.4.1.2.3">
                      <p id="section-4.2.1-2.3.4.1.2.3.1">The value of the <code>Acc</code> = Acc<sub>i</sub>. For more details, see <a href="#def-acc" class="auto internal xref">Section 4.1.1.2</a>.<a href="#section-4.2.1-2.3.4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-4.2.1-2.3.4.2">
                  <p id="section-4.2.1-2.3.4.2.1"><strong>Case 2</strong> <br> The path segment is traversed in construction direction and includes a peering Hop Field (which is the first Hop Field of the segment). It starts at the <em>i</em>-th AS of the full segment discovered in beaconing. In this case:<a href="#section-4.2.1-2.3.4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.3.4.2.2.1">
                      <p id="section-4.2.1-2.3.4.2.2.1.1">The Peering flag <code>P</code> = "1"<a href="#section-4.2.1-2.3.4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.1-2.3.4.2.2.2">
                      <p id="section-4.2.1-2.3.4.2.2.2.1">The Construction Direction flag <code>C</code> = "1"<a href="#section-4.2.1-2.3.4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.1-2.3.4.2.2.3">
                      <p id="section-4.2.1-2.3.4.2.2.3.1">The value of the <code>Acc</code> = Acc<sub>i+1</sub>. For more details, see <a href="#def-acc" class="auto internal xref">Section 4.1.1.2</a>.<a href="#section-4.2.1-2.3.4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-4.2.1-2.3.4.3">
                  <p id="section-4.2.1-2.3.4.3.1"><strong>UCase 3</strong> <br> The path segment is traversed against construction direction. The full segment has "n" hops. In this case:<a href="#section-4.2.1-2.3.4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.3.4.3.2.1">
                      <p id="section-4.2.1-2.3.4.3.2.1.1">The Peering flag <code>P</code> = "0" or "1" (depending on whether the last Hop Field in the up-segment is a peering Hop Field)<a href="#section-4.2.1-2.3.4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.1-2.3.4.3.2.2">
                      <p id="section-4.2.1-2.3.4.3.2.2.1">The Construction Direction flag <code>C</code> = "0"<a href="#section-4.2.1-2.3.4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.1-2.3.4.3.2.3">
                      <p id="section-4.2.1-2.3.4.3.2.3.1">The value of the <code>Acc</code> = Acc<sub>n-1</sub>. This is because seen from the direction of beaconing, the source endpoint is the last AS in the path segment. For more details, see <a href="#hf-mac-calc" class="auto internal xref">Section 4.1.1.1</a> and <a href="#def-acc" class="auto internal xref">Section 4.1.1.2</a>.<a href="#section-4.2.1-2.3.4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-4.2.1-2.4">
              <p id="section-4.2.1-2.4.1">Besides setting the flags and the <code>Acc</code> field, the source endpoint <span class="bcp14">MUST</span> also set the pointers in the <code>CurrInf</code> and <code>CurrHF</code> fields of the Path Meta Header <code>PathMetaHdr</code> (see <a href="#PathMetaHdr" class="auto internal xref">Section 2.3.2.1</a>). As the source endpoint builds the starting point of the forwarding, both pointers <span class="bcp14">MUST</span> be set to "0".<a href="#section-4.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="process-router">
<section id="section-4.2.2">
          <h4 id="name-processing-at-routers">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-processing-at-routers" class="section-name selfRef">Processing at Routers</a>
          </h4>
<p id="section-4.2.2-1">During forwarding, each SCION router verifies the path contained in the packet header. Each SCION router also <span class="bcp14">MUST</span> correctly verify or set the value of the Accumulator in the <code>Acc</code> field for the next AS to be able to verify its Hop Field. The exact operations differ based on the location of the AS on the path.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The processing of SCION packets for ASes where a peering link is crossed between path segments is a special case. A path containing a peering link contains exactly two path segments, one against construction direction (up) and one in construction direction (down). On the path segment against construction direction (up), the peering Hop Field is the last hop of the segment. In construction direction (down), the peering Hop Field is the first hop of the segment.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">The following sections describe the tasks to be performed by the ingress and egress border routers of each on-path AS. Each operation is described from the perspective of AS<sub>i</sub>, where i belongs to [0 ... n-1], and n == the number of ASes in the path segment (counted from the first AS in the beaconing direction).<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">The following figure provides a simplified representation of the processing at routers both in construction direction and against construction direction.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<span id="name-a-simplified-representation"></span><div id="_figure-19">
<figure id="figure-20">
            <div class="alignLeft art-text artwork" id="section-4.2.2-5.1">
<pre>
                             ┌───┐
                             │ R │  = Router
                             └───┘
Processing in construction direction

      1. Verify MAC of AS1          1. Verify MAC of AS2
      2. Update Acc for AS2         2. Update Acc for AS3
                 │                            │
                 ▼                            ▼
▶▶▶──────────────────────────────────────────────────────────────────▶▶▶
                 |                            |
┌─────────────┐  |           ┌─────────────┐  |          ┌─────────────┐
│             │  |           │             │  |          │             │
│           ┌─┴─┐|         ┌─┴─┐         ┌─┴─┐|        ┌─┴─┐           │
│     AS1   │ R ├──────────┤ R │   AS2   │ R ├─────────┤ R │   AS3     │
│           └─┬─┘|         └─┬─┘         └─┬─┘|        └─┬─┘           │
│             │  |           │             │  |          │             │
└─────────────┘  |           └─────────────┘  |          └─────────────┘
                 |                            |
◀◀◀──────────────────────────────────────────────────────────────────◀◀◀
                 ▲                            ▲
                 │                            │
       1. Update Acc for AS1        1. Update Acc for AS2
       2. Verify MAC of AS1         2. Verify MAC of AS2

                               Processing against construction direction
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-a-simplified-representation" class="selfRef">A simplified representation of the processing at routers in both directions.</a>
            </figcaption></figure>
</div>
<div id="process-router-ingress">
<section id="section-4.2.2.1">
            <h5 id="name-steps-at-ingress-border-rou">
<a href="#section-4.2.2.1" class="section-number selfRef">4.2.2.1. </a><a href="#name-steps-at-ingress-border-rou" class="section-name selfRef">Steps at Ingress Border Router</a>
            </h5>
<p id="section-4.2.2.1-1">A SCION ingress border router <span class="bcp14">MUST</span> perform the following steps when it receives a SCION packet:<a href="#section-4.2.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2.1-2">
<li id="section-4.2.2.1-2.1">
                <p id="section-4.2.2.1-2.1.1">Check that the interface through which the packet was received is equal to the ingress interface in the current Hop Field. If not, the router <span class="bcp14">MUST</span> drop the packet.<a href="#section-4.2.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.2.2.1-2.2">
                <p id="section-4.2.2.1-2.2.1">If there is a segment switch at the current router, check that the ingress and egress interface links are either:<a href="#section-4.2.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<ul class="normal">
<li class="normal" id="section-4.2.2.1-3.1">
                <p id="section-4.2.2.1-3.1.1">Both core<a href="#section-4.2.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.1-3.2">
                <p id="section-4.2.2.1-3.2.1">Parent-child or vice-versa<a href="#section-4.2.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.1-3.3">
                <p id="section-4.2.2.1-3.3.1">Peering-child or vice-versa<a href="#section-4.2.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.2.1-4">Link types above are defined in <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span> section "Paths and Links". This check prevents valley use of peering links or hair-pin segments.
3. Check if the current Hop Field is expired or originated in the future, i.e. the current Info Field <span class="bcp14">MUST NOT</span> have a timestamp in the future, as defined in <a href="#inffield" class="auto internal xref">Section 2.3.2.3</a>. If either is true, the router <span class="bcp14">MUST</span> drop the packet.<a href="#section-4.2.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2.1-5">The next steps depend on the direction of travel and whether this segment includes a peering Hop Field. Both features are indicated by the settings of the Construction Direction flag <code>C</code> and the Peering flag <code>P</code> in the current Info Field, so the settings of both flags <span class="bcp14">MUST</span> be checked. The following combinations are possible:<a href="#section-4.2.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.1-6.1">
                <p id="section-4.2.2.1-6.1.1">The packet traverses the path segment in <strong>construction direction</strong> (<code>C</code> = "1" and <code>P</code> = "0" or "1"). In this case, proceed with step 4.<a href="#section-4.2.2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.1-6.2">
                <p id="section-4.2.2.1-6.2.1">The packet traverses the path segment <strong>against construction direction</strong> (<code>C</code> = "0"). The following cases are possible:<a href="#section-4.2.2.1-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.1-6.2.2.1">
                    <p id="section-4.2.2.1-6.2.2.1.1"><strong>Case 1</strong> <br> The path segment includes <strong>no peering Hop Field</strong> (<code>P</code> = "0"). In this case, the ingress border router <span class="bcp14">MUST</span> take the following step(s):<a href="#section-4.2.2.1-6.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.1-6.2.2.1.2.1">
                        <p id="section-4.2.2.1-6.2.2.1.2.1.1">Compute the value of the Accumulator Acc as follows:<a href="#section-4.2.2.1-6.2.2.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.2.1-6.2.2.1.2.1.2">
Acc = Acc<sub>i+1</sub> XOR MAC<sub>i</sub> <br>
  where <br>
  Acc<sub>i+1</sub> = the current value of the field <code>Acc</code> in the current Info Field <br>
  MAC<sub>i</sub> = the value of MAC<sub>i</sub> in the current Hop Field representing AS<sub>i</sub><a href="#section-4.2.2.1-6.2.2.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2.2.1-6.2.2.1.2.1.3"><strong>Note:</strong> In the case described here, the packet travels against direction of beaconing, i.e. the packet comes from AS<sub>i+1</sub> and will enter AS<sub>i</sub>. This means that the <code>Acc</code> field of this incoming packet represents the value of Acc<sub>i+1</sub>, but to compute the MAC<sub>i</sub> for the current AS<sub>i</sub>, we need the value of Acc<sub>i</sub> (see <a href="#def-acc" class="auto internal xref">Section 4.1.1.2</a>). As the border router knows that the formula for Acc<sub>i+1</sub> = Acc<sub>i</sub> XOR MAC<sub>i</sub> [:2] (see also <a href="#def-acc" class="auto internal xref">Section 4.1.1.2</a>), and because the values of Acc<sub>i+1</sub> and MAC<sub>i</sub> are known, the router will be able to recover the value Acc<sub>i</sub> based on the aforementioned formula for Acc.<a href="#section-4.2.2.1-6.2.2.1.2.1.3" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.1-6.2.2.1.2.2">
                        <p id="section-4.2.2.1-6.2.2.1.2.2.1">Replace the current value of the field <code>Acc</code> in the current Info Field with the newly calculated value of Acc.<a href="#section-4.2.2.1-6.2.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.1-6.2.2.1.2.3">
                        <p id="section-4.2.2.1-6.2.2.1.2.3.1">Compute the MAC<sup>Verify</sup><sub>i</sub> over the Hop Field of the current AS<sub>i</sub>. For this, use the formula in <a href="#hf-mac-calc" class="auto internal xref">Section 4.1.1.1</a>, but replace <code>SegID XOR MAC_0[:2] ... XOR MAC_i-1 [:2]</code> in the formula with the value of Acc as just set in the <code>Acc</code> field in the current Info Field.<a href="#section-4.2.2.1-6.2.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.1-6.2.2.1.2.4">
                        <p id="section-4.2.2.1-6.2.2.1.2.4.1">If the MAC<sub>i</sub> in the current Hop Field does not match the just calculated MAC<sup>Verify</sup><sub>i</sub>, drop the packet.<a href="#section-4.2.2.1-6.2.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.1-6.2.2.1.2.5">
                        <p id="section-4.2.2.1-6.2.2.1.2.5.1">If the current Hop Field is the last Hop Field in the path segment as determined by the value of the current <code>SegLen</code> and other metadata in the path meta header, increment both <code>CurrInf</code> and <code>CurrHF</code> in the path meta header. Proceed with step 4.<a href="#section-4.2.2.1-6.2.2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="normal" id="section-4.2.2.1-6.2.2.2">
                    <p id="section-4.2.2.1-6.2.2.2.1"><strong>Case 2</strong> <br> The path segment includes a <strong>peering Hop Field</strong> (<code>P</code> = "1"), but the current hop is <strong>not</strong> the peering hop (i.e. the current hop is <strong>neither</strong> the last hop of the first segment <strong>nor</strong> the first hop of the second segment). In this case, the ingress border router needs to perform the steps previously described for the path segment without peering Hop Field, but the border router <span class="bcp14">MUST NOT</span> increment <code>CurrInf</code> and <span class="bcp14">MUST NOT</span> increment <code>CurrHF</code> in the path meta header. Proceed with step 4.<a href="#section-4.2.2.1-6.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.2.2.1-6.2.2.3">
                    <p id="section-4.2.2.1-6.2.2.3.1"><strong>Case 3</strong> <br> The path segment includes a <strong>peering Hop Field</strong> (<code>P</code> = "1"), and the current Hop Field <em>is</em> the peering Hop Field (i.e. the current hop is <strong>either</strong> the last hop of the first segment <strong>or</strong> the first hop of the second segment). In this case, the ingress border router <span class="bcp14">MUST</span> take the following step(s):<a href="#section-4.2.2.1-6.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.1-6.2.2.3.2.1">
                        <p id="section-4.2.2.1-6.2.2.3.2.1.1">Compute MAC<sup>Peer</sup><sub>i</sub>. For this, use the formula in <a href="#peerlink" class="auto internal xref">Section 4.1.2</a>, but replace <code>SegID XOR MAC_0[:2] ... XOR MAC_i [:2]</code> in the formula with the value of Acc as set in the <code>Acc</code> field in the current Info Field (this is the value of Acc as it comes with the packet).<a href="#section-4.2.2.1-6.2.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.1-6.2.2.3.2.2">
                        <p id="section-4.2.2.1-6.2.2.3.2.2.1">If the MAC<sub>i</sub> in the current Hop Field does not match the just calculated MAC<sup>Peer</sup><sub>i</sub>, drop the packet.<a href="#section-4.2.2.1-6.2.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.1-6.2.2.3.2.3">
                        <p id="section-4.2.2.1-6.2.2.3.2.3.1">Increment both <code>CurrInf</code> and <code>CurrHF</code> in the path meta header. Proceed with step 4.<a href="#section-4.2.2.1-6.2.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2.1-7">
<li id="section-4.2.2.1-7.1">
                <p id="section-4.2.2.1-7.1.1">Forward the packet to the egress border router (based on the egress interface ID in the current Hop Field) or to the destination endpoint, if this is the destination AS.<a href="#section-4.2.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="steps-at-egress-border-router">
<section id="section-4.2.2.2">
            <h5 id="name-steps-at-egress-border-rout">
<a href="#section-4.2.2.2" class="section-number selfRef">4.2.2.2. </a><a href="#name-steps-at-egress-border-rout" class="section-name selfRef">Steps at Egress Border Router</a>
            </h5>
<p id="section-4.2.2.2-1">A SCION egress border router <span class="bcp14">MUST</span> perform the following steps when it receives a SCION packet:<a href="#section-4.2.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2.2-2">
<li id="section-4.2.2.2-2.1">
                <p id="section-4.2.2.2-2.1.1">Check the settings of the Construction Direction flag <code>C</code> and the Peering flag <code>P</code> in the currently valid Info Field. The following cases are possible:<a href="#section-4.2.2.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.2-2.1.2.1">
                    <p id="section-4.2.2.2-2.1.2.1.1"><strong>Case 1</strong> <br> The packet traverses the path segment in <strong>construction direction</strong> (<code>C</code> = "1"). The path segment either includes <strong>no peering Hop Field</strong> (<code>P</code> = "0") or the path segment does include a <strong>peering Hop Field</strong> (<code>P</code> = "1"), but the current hop is not the peering hop (i.e. the current hop is <strong>neither</strong> the last hop of the first segment <strong>nor</strong> the first hop of the second segment). In this case, the egress border router <span class="bcp14">MUST</span> take the following step(s):<a href="#section-4.2.2.2-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.2-2.1.2.1.2.1">
                        <p id="section-4.2.2.2-2.1.2.1.2.1.1">Compute MAC<sup>Verify</sup><sub>i</sub> over the Hop Field of the current AS<sub>i</sub>. For this, use the formula in <a href="#hf-mac-calc" class="auto internal xref">Section 4.1.1.1</a>, but replace <code>SegID XOR MAC_0[:2] ... XOR MAC_i-1 [:2]</code> in the formula with the value of Acc as set in the <code>Acc</code> field in the current Info Field.<a href="#section-4.2.2.2-2.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.2-2.1.2.1.2.2">
                        <p id="section-4.2.2.2-2.1.2.1.2.2.1">If the just calculated MAC<sup>Verify</sup><sub>i</sub> does not match the MAC<sub>i</sub> in the Hop Field of the current AS<sub>i</sub>, drop the packet.<a href="#section-4.2.2.2-2.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.2-2.1.2.1.2.3">
                        <p id="section-4.2.2.2-2.1.2.1.2.3.1">Compute the value of Acc<sub>i+1</sub>. For this, use the formula in <a href="#def-acc" class="auto internal xref">Section 4.1.1.2</a>. Replace Acc<sub>i</sub> in the formula with the current value of Acc as set in the <code>Acc</code> field of the current Info Field.<a href="#section-4.2.2.2-2.1.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.2-2.1.2.1.2.4">
                        <p id="section-4.2.2.2-2.1.2.1.2.4.1">Replace the value of the <code>Acc</code> field in the current Info Field with the just calculated value of Acc<sub>i+1</sub>.<a href="#section-4.2.2.2-2.1.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="normal" id="section-4.2.2.2-2.1.2.2">
                    <p id="section-4.2.2.2-2.1.2.2.1"><strong>Case 2</strong> <br> The packet traverses the path segment in <strong>construction direction</strong> (<code>C</code> = "1") where the path segment includes a <strong>peering Hop Field</strong> (<code>P</code> = "1") and the current Hop Field <em>is</em> the peering Hop Field (i.e. the current hop is <strong>either</strong> the last hop of the first segment <strong>or</strong> the first hop of the second segment). In this case, the egress border router <span class="bcp14">MUST</span> take the following steps:<a href="#section-4.2.2.2-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.2-2.1.2.2.2.1">
                        <p id="section-4.2.2.2-2.1.2.2.2.1.1">Compute MAC<sup>Peer</sup><sub>i</sub>. For this, use the formula in <a href="#peerlink" class="auto internal xref">Section 4.1.2</a>, but replace <code>SegID XOR MAC_0 [:2] ... XOR MAC_i [:2]</code> with the value in the <code>Acc</code> field of the current Info Field.<a href="#section-4.2.2.2-2.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.2.2.2-2.1.2.2.2.2">
                        <p id="section-4.2.2.2-2.1.2.2.2.2.1">If the MAC<sub>i</sub> in the Hop Field of the current AS<sub>i</sub> does not match the just calculated MAC<sup>Peer</sup><sub>i</sub>, drop the packet.<a href="#section-4.2.2.2-2.1.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="normal" id="section-4.2.2.2-2.1.2.3">
                    <p id="section-4.2.2.2-2.1.2.3.1"><strong>Case 3</strong> <br> The packet traverses the path segment <strong>against construction direction</strong> (<code>C</code> = "0" and <code>P</code> = "0" or "1"). In this case, proceed with Step 3.<a href="#section-4.2.2.2-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.2.2.2-2.2">
                <p id="section-4.2.2.2-2.2.1">Increment <code>CurrHF</code> in the path meta header.<a href="#section-4.2.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.2.2.2-2.3">
                <p id="section-4.2.2.2-2.3.1">Forward the packet to the neighbor AS.<a href="#section-4.2.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="effects-of-clock-inaccuracy">
<section id="section-4.2.2.3">
            <h5 id="name-effects-of-clock-inaccuracy">
<a href="#section-4.2.2.3" class="section-number selfRef">4.2.2.3. </a><a href="#name-effects-of-clock-inaccuracy" class="section-name selfRef">Effects of Clock Inaccuracy</a>
            </h5>
<p id="section-4.2.2.3-1">A PCB originated by a given control service is used to construct data plane paths. Specifically, the timestamp in the Info Field and the expiry time of Hop Fields are used for Hop Field MAC computation, see <a href="#hf-mac-calc" class="auto internal xref">Section 4.1.1.1</a>, which is used to validate paths at each on-path SCION router. A segment's originating control service and the routers that the segment refers to all have different clocks. Their differences affect the validation process:<a href="#section-4.2.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.3-2.1">
                <p id="section-4.2.2.3-2.1.1">A fast clock at origination or a slow clock at validation will yield a lengthened expiration time for hops, and possibly an origination time in the future.<a href="#section-4.2.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.3-2.2">
                <p id="section-4.2.2.3-2.2.1">A slow clock at origination or a fast clock at validation will yield a shortened expiration time for hops, and possibly an expiration time in the past.<a href="#section-4.2.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.2.3-3">This bias comes in addition to a structural delay: PCBs are propagated at a configurable interval (typically, one minute). As a result of this and the way they are iteratively constructed, PCBs with N hops may become available for path construction up to N intervals (so typically N minutes) after origination which creates a constraint on the expiration of hops. Hops of the minimal expiration time (337.5 seconds - see <a href="#hopfld" class="auto internal xref">Section 2.3.2.4</a>) would render useless any path segment longer than 5 hops. For this reason, it is unadvisable to create hops with a short expiration time. The norm is 6 hours.<a href="#section-4.2.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2.3-4">In comparison to these time scales, clock offsets in the order of minutes are immaterial.<a href="#section-4.2.2.3-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2.3-5">Each administrator of SCION control services and routers is responsible for maintaining sufficient clock accuracy. No particular method is assumed for this.<a href="#section-4.2.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deployment-considerations">
<section id="section-5">
      <h2 id="name-deployment-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations</a>
      </h2>
<div id="mtu">
<section id="section-5.1">
        <h3 id="name-mtu">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-mtu" class="section-name selfRef">MTU</a>
        </h3>
<p id="section-5.1-1">SCION requires its underlay protocol to provide a minimum MTU of 1232 bytes. This number results from 1280, the minimum IPv6 MTU as of <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span>), minus 48, assuming UDP/IPv6 as underlay. Higher layer protocols such as SCMP rely only on such minimum MTU.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The MTU of a SCION path is defined as the minimum of the MTUs of the links traversed by that path. The control plane disseminates such values and makes them available to endpoints (see: <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span>, Path MTU).<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The MTU of each link may be discovered or administratively configured (current practice is for it to be configured). It must be less than or equal to the MTU of the link's underlay encapsulation or native link-layer in either direction.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">SCION assumes that the MTUs of a path segment remains correct for the life time of that segment. This is generally a safe assumption because:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-5.1">
            <p id="section-5.1-5.1.1">Intra-AS network MTUs are a result of the network configuration of each AS and therefore predictable.<a href="#section-5.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-5.2">
            <p id="section-5.1-5.2.1">Inter-AS links MTU are normally under the joint control of the administrators of the two ASes involved and therefore equally predictable.<a href="#section-5.1-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-6">Should the inter-AS link MTU be unpredictable (e.g. because the inter-AS link is deployed as an overlay), then the link's MTU <span class="bcp14">MUST</span> be configured statically to a conservative value. For a UDP/IP underlay, 1232 is a safe value.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fragmentation">
<section id="section-5.2">
        <h3 id="name-packet-fragmentation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-packet-fragmentation" class="section-name selfRef">Packet Fragmentation</a>
        </h3>
<p id="section-5.2-1">The SCION network layer does not support packet fragmentation; not even at the source endpoint. Upper layer protocols and applications <span class="bcp14">MUST</span> comply with the MTU of the paths that they use.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">SCION is agnostic to datagram fragmentation by the underlay network layer, (e.g. used for intra-AS communication). Implementations <span class="bcp14">SHOULD</span> allow MTU discovery mechanisms such as <span>[<a href="#RFC4821" class="cite xref">RFC4821</a>]</span> to be enabled in the underlay and avoid fragmentation. For inter-AS links, using a different configuration is the joint decision of the administrators of the two ASes involved. For intra-AS interfaces using a different configuration is the choice of that AS' administrator alone.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sig">
<section id="section-5.3">
        <h3 id="name-scion-ip-gateway">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-scion-ip-gateway" class="section-name selfRef">SCION IP Gateway</a>
        </h3>
<p id="section-5.3-1">The SCION IP Gateway (SIG) enables IP packets to be tunneled over SCION to support communication between hosts that do not run a SCION implementation. A SIG acts as a router from the perspective of IP, whilst acting as SCION endpoint from the perspective of the SCION network. It is typically deployed inside the same AS-internal network as its non-SCION hosts, or at the edge of an enterprise network. Tunneling IP traffic over SCION requires a pair of SIGs: at the ingress and egress points of the SCION network.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">IP tunneling over SCION is an application from the perspective of the Data Plane and is outwith the scope of this document.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">More information about the reference open source SCION IP Gateway implementation can be found at <span>[<a href="#SIG" class="cite xref">SIG</a>]</span>.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="handling-link-failures">
<section id="section-6">
      <h2 id="name-handling-link-failures">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-handling-link-failures" class="section-name selfRef">Handling Link Failures</a>
      </h2>
<div id="scion-bfd">
<section id="section-6.1">
        <h3 id="name-link-failure-detection-bfd">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-link-failure-detection-bfd" class="section-name selfRef">Link Failure Detection - BFD</a>
        </h3>
<p id="section-6.1-1">To detect link failures quickly and reliably, SCION uses the Bidirectional Forwarding Detection (BFD) protocol (<span>[<a href="#RFC5880" class="cite xref">RFC5880</a>]</span>) on links between SCION routers. If a router does not receive a BFD message from its peer at some regular interval, it considers the link to be down (in both directions) until messages are received again.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">A SCION BFD message consists of a SCION packet with a <code>NextHdr</code> value of <code>203</code> (<code>BFD/SCION</code>) and a path type of either <code>00</code> (<code>Empty</code> - used on intra-AS links) or <code>2</code> (<code>OneHopPath</code> - used on inter-AS links). The BFD header itself is a BFD Control Header as described in <span>[<a href="#RFC5880" class="cite xref">RFC5880</a>]</span>. More information on one-hop and empty paths is available in <a href="#onehop" class="auto internal xref">Section 2.3.3</a> and <a href="#empty" class="auto internal xref">Section 2.3.1</a>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">A SCION router <span class="bcp14">SHOULD</span> accept BFD connections from its peers and <span class="bcp14">SHOULD</span> attempt to establish BFD connections to its peers. While a link is considered to be down, a SCION router should drop packets destined to that link. In that case, it <span class="bcp14">SHOULD</span> send a <span><a href="#link-down-notification" class="internal xref">notification</a> (<a href="#link-down-notification" class="auto internal xref">Section 6.2</a>)</span> to the originator.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="link-down-notification">
<section id="section-6.2">
        <h3 id="name-link-failure-notification-s">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-link-failure-notification-s" class="section-name selfRef">Link Failure Notification - SCMP</a>
        </h3>
<p id="section-6.2-1">In SCION, an intermediate router cannot change the path followed by a packet, only the source endpoint can chose a different path. Therefore, to enable fast recovery, a router <span class="bcp14">SHOULD</span> signal forwarding failures to the source, via a SCMP notification (see <span>[<a href="#I-D.dekater-scion-controlplane" class="cite xref">I-D.dekater-scion-controlplane</a>]</span> section "SCMP/Error Messages"). This allows the source endpoint to quickly switch to a different path. To that end, the source end-point <span class="bcp14">SHOULD</span> give lower preference to the broken path. Current implementations use a negative cache with entries retained for 10s.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Sending an SCMP error notification is <span class="bcp14">OPTIONAL</span>. Endpoints should therefore implement additional mechanisms to validate or detect link down signals. To reduce exposure to denial-of-service attacks, SCION routers <span class="bcp14">SHOULD</span> employ rate limiting when sending recommended SCMP notifications (especially identical ones). Rate limit policies are up to each AS' administrator.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This section describes the possible security risks and attacks that the SCION Data Plane may be prone to, and how these attacks may be mitigated. It first discusses security risks that pertain to path authorization, followed by a section on other forwarding related security considerations.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="path-authorization-1">
<section id="section-7.1">
        <h3 id="name-path-authorization-3">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-path-authorization-3" class="section-name selfRef">Path Authorization</a>
        </h3>
<p id="section-7.1-1">A central property of the SCION path-aware data plane is path authorization. Path authorization guarantees that data packets always traverse the network along path segments authorized in the control plane by all on-path ASes. This section discusses how an adversary may attempt to violate the path authorization property, as well as SCION's prevention mechanisms; either an attacker can attempt to create unauthorized Hop Fields, or they can attempt to create illegitimate paths assembled from authentic individual Hop Fields.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The main protection mechanism is the Hop Field MAC (see <a href="#auth-chained-macs" class="auto internal xref">Section 4.1</a>) that authenticates the Hop Field content comprised of ingress/egress interface identifiers, creation and expiration timestamp and the preceding Hop Field MACs in the path segment. Each Hop Field MAC is computed using the secret forwarding key of the respective AS, which is shared across the SCION routers and control plane services within each AS.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div id="forwarding-key-compromise">
<section id="section-7.1.1">
          <h4 id="name-forwarding-key-compromise">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-forwarding-key-compromise" class="section-name selfRef">Forwarding key compromise</a>
          </h4>
<p id="section-7.1.1-1">For the current default MAC algorithm - AES-CMAC truncated to 48 bits - key recovery attacks from (any number of) known plaintext/MAC combinations is computationally infeasible as far as publicly known. In addition, the MAC algorithm can be freely chosen by each AS, enabling algorithmic agility for MAC computations. Should a MAC algorithm be discovered to be weak or insecure, each AS can quickly switch to a secure algorithm without the need for coordination with other ASes.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">A more realistic risk to the secrecy of the forwarding key is exfiltration from a compromised router or control plane service. An AS can optionally rotate its forwarding key at regular intervals to limit the exposure after a temporary device compromise. However, such a key rotation scheme cannot mitigate the impact of an undiscovered compromise of a device.<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1.1-3">When an AS's forwarding key is compromised, an attacker can forge Hop Field MACs and undermine path authorization. As path segments are checked for validity and policy compliance during the path discovery phase and during forwarding, routers only validate the MAC and basic validity of the current the Hop Field. Consequently, creating fraudulent Hop Fields with valid MACs allows an attacker to bypass most path segment validity checks and to create path segments that violate the AS's local policy and/or general path segment validity requirements. In particular, an attacker could create paths that include loops (limited by the maximum number of Hop Fields of a path).<a href="#section-7.1.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1.1-4">Unless an attacker has access to the forwarding keys of all ASes on the illegitimate path it wants to fabricate, it will need to splice fragments of two legitimate path segments with an illegitimate Hop Field. For this, it needs to create a Hop Field with a MAC that fits into the MAC chain expected by the second path segment fragment. The only input that the attacker can vary relatively freely is the 8-bit <code>ExpTime</code>, but the resulting MAC needs to match a specific 16 bit <code>Acc</code> value. While there is a low probability of this working for a specific attempt (1/256), the attack will succeed eventually if the attacker can keep retrying over a longer time period or with many different path segment fragments.<a href="#section-7.1.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1.1-5">While a forwarding key compromise and the resulting loss of path authorization is a serious degradation of SCION's routing security properties, this does not affect access control or data security for the hosts in the affected AS. Unauthorized paths are available to the attacker, but the routing of packets from legitimate senders is not affected.<a href="#section-7.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forging-hop-field-mac">
<section id="section-7.1.2">
          <h4 id="name-forging-hop-field-mac">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-forging-hop-field-mac" class="section-name selfRef">Forging Hop Field MAC</a>
          </h4>
<p id="section-7.1.2-1">Another method to break path authorization is to directly forge a Hop Field in an online attack, using the router as an oracle to determine the validity of the Hop Field MAC. The adversary needs to send one packet per guess for verification and for 6-byte MAC, an adversary would need an expected 2<sup>47</sup> (~140 trillion) tries to successfully forge the MAC of a single Hop Field.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">As the router only checks MACs during the encoded validity period of the Hop Field, which is limited by the packet header format to at most 24 hours, these tries need to occur in a limited time period. This results in a seemingly infeasible number of ~1.6e9 guesses per second.<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2-3">In the unlikely case that an online brute-force attack succeeds, the obtained Hop Field can be used until its inevitable expiration after the just mentioned 24 hour limit.<a href="#section-7.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-splicing">
<section id="section-7.1.3">
          <h4 id="name-path-splicing">
<a href="#section-7.1.3" class="section-number selfRef">7.1.3. </a><a href="#name-path-splicing" class="section-name selfRef">Path Splicing</a>
          </h4>
<p id="section-7.1.3-1">In a path splicing attack, an adversary source endpoint takes valid Hop Fields of multiple path segments and splices them together to obtain a new unauthorized path.<a href="#section-7.1.3-1" class="pilcrow">¶</a></p>
<p id="section-7.1.3-2">Candidate path segments for splicing must have at least one AS interface in common as a connection point, and the same origination timestamp as this is directly protected by the Hop Field MAC. This can occur by chance or if the two candidate path segments were originated as the same segment that diverged and converged back.<a href="#section-7.1.3-2" class="pilcrow">¶</a></p>
<p id="section-7.1.3-3">The Hop Field MAC protects the 16-bit aggregation of path segment identifier and preceding MACs, see <a href="#auth-chained-macs" class="auto internal xref">Section 4.1</a>. This MAC chaining prevents splicing even in the case that the AS interface and segment timestamp match.<a href="#section-7.1.3-3" class="pilcrow">¶</a></p>
<p id="section-7.1.3-4">As the segment identifier and aggregation of preceding MACs is only 16-bits wide, a chance collision among compatible path segments can occur rarely. Successful path splicing would allow an attacker to briefly use a path that violates an ASes path policy, e.g. making a special transit link available to a customer AS that is not billed accordingly, or violate general path segment validity requirements. In particular, a spliced path segment could traverse one or multiple links twice. However, creating a loop traversing a link an arbitrary number of times would involve multiple path splices and therefore multiple random collisions happening simultaneously, which is exceedingly unlikely. A wider security margin against path splicing could be obtained by increasing the width of the segment identifier / <code>Acc</code> field, e.g. by extending it into the 8-bit reserved field next to it in the Info Field.<a href="#section-7.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="on-path-attacks">
<section id="section-7.2">
        <h3 id="name-on-path-attacks">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-on-path-attacks" class="section-name selfRef">On-Path Attacks</a>
        </h3>
<p id="section-7.2-1">When an adversary sits on the path between the source and destination endpoint, it is able to intercept the data packets that are being forwarded and would allow the adversary to hijack traffic onto a path that is different from the intended one selected by the source endpoint. Possible on-path attacks in the data plane are modifications of the SCION path header and SCION address header, or by simply dropping packets. This kind of attack generally cannot be prevented, although anendpoint can use SCION's path awareness to immediately select an alternate path if available.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="modification-of-the-path-header">
<section id="section-7.2.1">
          <h4 id="name-modification-of-the-path-he">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-modification-of-the-path-he" class="section-name selfRef">Modification of the Path Header</a>
          </h4>
<p id="section-7.2.1-1">An on-path adversary could modify the SCION path header and replace the remaining part of path segments to the destination with different segments. Such replaced segments must include authorized segments as otherwise the packet would be simply dropped on its way to the destination.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">The already traversed portion of the current segment and past segments can also be modified by the adversary (e.g. by deleting and adding valid and invalid Hop Fields). On reply packets from the destination, the adversary can transparently revert the changes to the path header again. For instance, if an adversary M is an intermediate AS on the path of a packet from A to B, then M can replace the packet’s past path (leading up to, but not including M) where the new path may not be a valid end-to-end path. However, when B reverses the path and sends a reply packet, that packet would go via M which can then transparently change the invalid path back to the valid path to A. In addition, the endpoint address header can also be modified.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">Modifications of the SCION path and address header can be discovered by the destination endpoint by a data integrity protection system. Such a data integrity protection system, loosely analogous to the IPSec Authentication Header, exists for SCION but is out of scope for this document. This is described as the SCION Packet Authentication Option (SPAO) in <span>[<a href="#CHUAT22" class="cite xref">CHUAT22</a>]</span>.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">Moreover, packet integrity protection is not enough if there are two colluding adversaries on the path. These colluding adversaries can forward the packet between them using a different path than selected by the source endpoint: The first on-path attacker remodels the packet header arbitrarily, and the second on-path attacker changes the path back to the original source-selected path, such that the integrity check by the destination endpoint succeeds. However, such an attack is of little value. An on-path adversary may inspect/copy/disrupt its traffic without diverting it away from the sender-chosen path. For this reason proof-of-transit, which would be required to detect such an attack, has marginal benefit in the context of SCION and it is not in scope for this document.<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload-integrity">
<section id="section-7.2.2">
          <h4 id="name-payload-integrity">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-payload-integrity" class="section-name selfRef">Payload Integrity</a>
          </h4>
<p id="section-7.2.2-1">An on-path attacker can modify the payload of a SCION packet. Existing higher layer protocols can easily defend against such an attack without any cooperation by the SCION network. For that reason, payload integrity is not in scope for this specification. However, there exists a proposal for an experimental extension to authenticate addresses, provide integrity protection for payloads, and replay protection: SPAO . This is still very experimental and it not used in the production network.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="off-path-attacks">
<section id="section-7.3">
        <h3 id="name-off-path-attacks">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-off-path-attacks" class="section-name selfRef">Off-Path Attacks</a>
        </h3>
<p id="section-7.3-1">SCION's path awareness limits the abilities of an off-path adversary to influence forwarding in the data plane. Once a packet is en-route it will follow its determined path regardless of the actions of the adversary. An adversary can attempt to disrupt the connectivity of the path by flooding a link with excessive traffic (see <a href="#dos" class="auto internal xref">Section 7.4</a> below), but after detecting congestion, the endpoint can switch to another non-congested path for subsequent packets.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dos">
<section id="section-7.4">
        <h3 id="name-volumetric-denial-of-servic">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-volumetric-denial-of-servic" class="section-name selfRef">Volumetric Denial of Service Attacks</a>
        </h3>
<p id="section-7.4-1">An adversary can attempt to disrupt the connectivity of a network path by flooding a link with excessive traffic. In this case, the endpoint can switch to another non-congested path for subsequent packets.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">SCION provides protection against certain reflection-based DoS attacks. Here, the adversary sends requests to a server with the source address set to the address of the victim, and the server will send a reply that is typically larger than the request to the victim. This can be prevented in SCION as long as the attacker and the victim are located in different ASes as the reply packets are simply returned along reversed path to the actual sender regardless of the source address information. Thus, the reply packets will be forwarded to the attacker's AS where they will be discarded because the destination AS does not match.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">However, the path choice of the endpoint may possibly be exploited by an attacker to create intermittent congestion with a relatively low send rate. The attacker can exploit the latency differences of the available paths, sending at precisely timed intervals to cause short, synchronized bursts of packets near the victim.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4"><strong>Note</strong> SCION does not protect against two other types of DoS attacks, namely transport protocol attacks and application layer attacks. Such attacks are out of SCION's scope although additional information contained in the SCION header enables more targeted filtering, e.g. by ISD, AS or path length.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The SCION AS and ISD number are SCION-specific numbers. They are currently allocated by Anapaya Systems, a provider of SCION-based networking software and solutions (see <span>[<a href="#ISD-AS-assignments" class="cite xref">ISD-AS-assignments</a>]</span>). This task is currently being transitioned from Anapaya to the SCION Association.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.dekater-scion-controlplane">[I-D.dekater-scion-controlplane]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Control Plane"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-scion-controlplane-08</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-scion-controlplane-08">https://datatracker.ietf.org/doc/html/draft-dekater-scion-controlplane-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-scion-pki">[I-D.dekater-scion-pki]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Control Plane PKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-scion-pki-09</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-scion-pki-09">https://datatracker.ietf.org/doc/html/draft-dekater-scion-pki-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2460">[RFC2460]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 2460</span>, <span class="seriesInfo">DOI 10.17487/RFC2460</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2460">https://www.rfc-editor.org/rfc/rfc2460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
        <dd>
<span class="refAuthor">Nichols, K.</span>, <span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2474">https://www.rfc-editor.org/rfc/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3168">[RFC3168]</dt>
        <dd>
<span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3168">https://www.rfc-editor.org/rfc/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4493">[RFC4493]</dt>
        <dd>
<span class="refAuthor">Song, JH.</span>, <span class="refAuthor">Poovendran, R.</span>, <span class="refAuthor">Lee, J.</span>, and <span class="refAuthor">T. Iwata</span>, <span class="refTitle">"The AES-CMAC Algorithm"</span>, <span class="seriesInfo">RFC 4493</span>, <span class="seriesInfo">DOI 10.17487/RFC4493</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4493">https://www.rfc-editor.org/rfc/rfc4493</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5880">[RFC5880]</dt>
        <dd>
<span class="refAuthor">Katz, D.</span> and <span class="refAuthor">D. Ward</span>, <span class="refTitle">"Bidirectional Forwarding Detection (BFD)"</span>, <span class="seriesInfo">RFC 5880</span>, <span class="seriesInfo">DOI 10.17487/RFC5880</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5880">https://www.rfc-editor.org/rfc/rfc5880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6437">[RFC6437]</dt>
        <dd>
<span class="refAuthor">Amante, S.</span>, <span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">J. Rajahalme</span>, <span class="refTitle">"IPv6 Flow Label Specification"</span>, <span class="seriesInfo">RFC 6437</span>, <span class="seriesInfo">DOI 10.17487/RFC6437</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6437">https://www.rfc-editor.org/rfc/rfc6437</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8200">https://www.rfc-editor.org/rfc/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CHUAT22">[CHUAT22]</dt>
        <dd>
<span class="refAuthor">Chuat, L.</span>, <span class="refAuthor">Legner, M.</span>, <span class="refAuthor">Basin, D.</span>, <span class="refAuthor">Hausheer, D.</span>, <span class="refAuthor">Hitz, S.</span>, <span class="refAuthor">Mueller, P.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"The Complete Guide to SCION"</span>, <span class="seriesInfo">ISBN 978-3-031-05287-3</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-031-05288-0">https://doi.org/10.1007/978-3-031-05288-0</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CRYPTOBOOK">[CRYPTOBOOK]</dt>
        <dd>
<span class="refAuthor">Boneh, D.</span> and <span class="refAuthor">V. Shoup</span>, <span class="refTitle">"A Graduate Course in Applied Cryptography"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://toc.cryptobook.us/">https://toc.cryptobook.us/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-panrg-scion-overview">[I-D.dekater-panrg-scion-overview]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"SCION Overview"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-panrg-scion-overview-06</span>, <time datetime="2024-05-07" class="refDate">7 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-panrg-scion-overview-06">https://datatracker.ietf.org/doc/html/draft-dekater-panrg-scion-overview-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISD-AS-assignments">[ISD-AS-assignments]</dt>
        <dd>
<span class="refTitle">"SCION ISD and AS Assignments"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://docs.anapaya.net/en/latest/resources/isd-as-assignments/">https://docs.anapaya.net/en/latest/resources/isd-as-assignments/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1918">[RFC1918]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y.</span>, <span class="refAuthor">Moskowitz, B.</span>, <span class="refAuthor">Karrenberg, D.</span>, <span class="refAuthor">de Groot, G. J.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02" class="refDate">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1918">https://www.rfc-editor.org/rfc/rfc1918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2711">[RFC2711]</dt>
        <dd>
<span class="refAuthor">Partridge, C.</span> and <span class="refAuthor">A. Jackson</span>, <span class="refTitle">"IPv6 Router Alert Option"</span>, <span class="seriesInfo">RFC 2711</span>, <span class="seriesInfo">DOI 10.17487/RFC2711</span>, <time datetime="1999-10" class="refDate">October 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2711">https://www.rfc-editor.org/rfc/rfc2711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4821">[RFC4821]</dt>
        <dd>
<span class="refAuthor">Mathis, M.</span> and <span class="refAuthor">J. Heffner</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery"</span>, <span class="seriesInfo">RFC 4821</span>, <span class="seriesInfo">DOI 10.17487/RFC4821</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4821">https://www.rfc-editor.org/rfc/rfc4821</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9217">[RFC9217]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refTitle">"Current Open Questions in Path-Aware Networking"</span>, <span class="seriesInfo">RFC 9217</span>, <span class="seriesInfo">DOI 10.17487/RFC9217</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9217">https://www.rfc-editor.org/rfc/rfc9217</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9473">[RFC9473]</dt>
        <dd>
<span class="refAuthor">Enghardt, R.</span> and <span class="refAuthor">C. Krähenbühl</span>, <span class="refTitle">"A Vocabulary of Path Properties"</span>, <span class="seriesInfo">RFC 9473</span>, <span class="seriesInfo">DOI 10.17487/RFC9473</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9473">https://www.rfc-editor.org/rfc/rfc9473</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCIONLAB">[SCIONLAB]</dt>
        <dd>
<span class="refAuthor">Kown, J.</span>, <span class="refAuthor">García-Pardo, J.</span>, <span class="refAuthor">Legner, M.</span>, <span class="refAuthor">Wirz, F.</span>, <span class="refAuthor">Frei, M.</span>, <span class="refAuthor">Hausheer, D.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"SCIONLAB - A Next-Generation Internet Testbed"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/abstract/document/9259355">https://ieeexplore.ieee.org/abstract/document/9259355</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCIONLAB_WEBSITE">[SCIONLAB_WEBSITE]</dt>
        <dd>
<span class="refTitle">"SCIONLab website"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://www.scionlab.org/">https://www.scionlab.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIG">[SIG]</dt>
      <dd>
<span class="refAuthor">Anapaya</span>, <span class="refAuthor">ETH</span>, and <span class="refAuthor">SCION</span>, <span class="refTitle">"SCION IP Gateway Documentation"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://docs.scion.org/en/latest/sig.html">https://docs.scion.org/en/latest/sig.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Many thanks go to Matthias Frei (SCION Association), Juan A. Garcia Prado (ETH Zurich) and Kevin Meynell (SCION Association) for reviewing this document. We are also very grateful to Adrian Perrig (ETH Zurich), for providing guidance and feedback about each aspect of SCION. Finally, we are indebted to the SCION development teams of Anapaya and ETH Zurich, for their practical knowledge and for the documentation about the SCION Data Plane, as well as to the authors of <span>[<a href="#CHUAT22" class="cite xref">CHUAT22</a>]</span> - the book is an important source of input and inspiration for this draft.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deployment-testing-scionlab">
<section id="appendix-B">
      <h2 id="name-deployment-testing-scionlab">
<a href="#name-deployment-testing-scionlab" class="section-name selfRef">Deployment Testing: SCIONLab</a>
      </h2>
<p id="appendix-B-1">SCIONLab is a global research network that is available to test the SCION architecture. You can create and use your ASes using your own computation resources which allows you to gain real-world experience of deploying and managing a SCION network.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">More information can be found at <span>[<a href="#SCIONLAB_WEBSITE" class="cite xref">SCIONLAB_WEBSITE</a>]</span> and in the <span>[<a href="#SCIONLAB" class="cite xref">SCIONLAB</a>]</span> paper.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protnum">
<section id="appendix-C">
      <h2 id="name-assigned-scion-protocol-num">
<a href="#name-assigned-scion-protocol-num" class="section-name selfRef">Assigned SCION Protocol Numbers</a>
      </h2>
<p id="appendix-C-1">This appendix lists the assigned SCION protocol numbers.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="considerations">
<section id="appendix-C.1">
        <h3 id="name-considerations">
<a href="#name-considerations" class="section-name selfRef">Considerations</a>
        </h3>
<p id="appendix-C.1-1">SCION attempts to take the IANA's assigned Internet protocol numbers into consideration. Widely employed protocols have the same protocol number as the one assigned by IANA. SCION specific protocol numbers start at 200.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">The protocol numbers are used in the SCION header to identify the upper layer protocol.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="assignment">
<section id="appendix-C.2">
        <h3 id="name-assignment">
<a href="#name-assignment" class="section-name selfRef">Assignment</a>
        </h3>
<span id="name-the-assigned-scion-protocol"></span><table class="center" id="table-11">
          <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-the-assigned-scion-protocol" class="selfRef">The assigned SCION protocol numbers</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Keyword</th>
              <th class="text-left" rowspan="1" colspan="1">Protocol</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-5</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">TCP/SCION</td>
              <td class="text-left" rowspan="1" colspan="1">Transmission Control Protocol over SCION</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7-16</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">UDP/SCION</td>
              <td class="text-left" rowspan="1" colspan="1">User Datagram Protocol over SCION</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">18-199</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">200</td>
              <td class="text-left" rowspan="1" colspan="1">HBH</td>
              <td class="text-left" rowspan="1" colspan="1">SCION Hop-by-Hop Options</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">201</td>
              <td class="text-left" rowspan="1" colspan="1">E2E</td>
              <td class="text-left" rowspan="1" colspan="1">SCION End-to-End Options</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">202</td>
              <td class="text-left" rowspan="1" colspan="1">SCMP</td>
              <td class="text-left" rowspan="1" colspan="1">SCION Control Message Protocol</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">203</td>
              <td class="text-left" rowspan="1" colspan="1">BFD/SCION</td>
              <td class="text-left" rowspan="1" colspan="1">BFD over SCION</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">204-252</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">253</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Use for experimentation and testing</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">254</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Use for experimentation and testing</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">255</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-D">
      <h2 id="name-change-log">
<a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-D-1">Changes made to drafts since ISE submission. This section is to be removed before publication.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="draft-dekater-scion-dataplane-05">
<section id="appendix-D.1">
        <h3 id="name-draft-dekater-scion-datapla">
<a href="#name-draft-dekater-scion-datapla" class="section-name selfRef">draft-dekater-scion-dataplane-05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.1-1.1">
            <p id="appendix-D.1-1.1.1">Abstract: mention goal and that document is not an Internet Standard<a href="#appendix-D.1-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-dataplane-04">
<section id="appendix-D.2">
        <h3 id="name-draft-dekater-scion-dataplan">
<a href="#name-draft-dekater-scion-dataplan" class="section-name selfRef">draft-dekater-scion-dataplane-04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.2-1.1">
            <p id="appendix-D.2-1.1.1">Moved SCMP specification to draft-dekater-scion-controlplane<a href="#appendix-D.2-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-dataplane-03">
<section id="appendix-D.3">
        <h3 id="name-draft-dekater-scion-dataplane">
<a href="#name-draft-dekater-scion-dataplane" class="section-name selfRef">draft-dekater-scion-dataplane-03</a>
        </h3>
<p id="appendix-D.3-1">Major changes:<a href="#appendix-D.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.3-2.1">
            <p id="appendix-D.3-2.1.1">Introduction: clarified document goal and added Figure showing SCION Header within the stack<a href="#appendix-D.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-2.2">
            <p id="appendix-D.3-2.2.1">Added section with SCMP specification<a href="#appendix-D.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-2.3">
            <p id="appendix-D.3-2.3.1">Added section on Handling Link Failures and BFD<a href="#appendix-D.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-2.4">
            <p id="appendix-D.3-2.4.1">Added sections on MTU and fragmentation<a href="#appendix-D.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-2.5">
            <p id="appendix-D.3-2.5.1">Clarified router checks in Processing at Routers<a href="#appendix-D.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-2.6">
            <p id="appendix-D.3-2.6.1">Security Considerations: add section on Payload Modifications<a href="#appendix-D.3-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-D.3-3">Minor changes:<a href="#appendix-D.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.3-4.1">
            <p id="appendix-D.3-4.1.1">Added short section mentioning SCION IP Gateway<a href="#appendix-D.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.2">
            <p id="appendix-D.3-4.2.1">Clarified the router alert flags and relationship to the ConsIngress/Egress fields.<a href="#appendix-D.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.3">
            <p id="appendix-D.3-4.3.1">Clarifications in the SCION Header Specification section (router alert flags, service addresses, one-hop paths, text clarifications, validity of peering links)<a href="#appendix-D.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.4">
            <p id="appendix-D.3-4.4.1">Added mention of why proof of transit is not needed.<a href="#appendix-D.3-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.5">
            <p id="appendix-D.3-4.5.1">Rename flow ID to Flow Label and document by reference to <span>[<a href="#RFC6437" class="cite xref">RFC6437</a>]</span>.<a href="#appendix-D.3-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.6">
            <p id="appendix-D.3-4.6.1">Added reference to SCIONLab as a testbed for implementors<a href="#appendix-D.3-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.7">
            <p id="appendix-D.3-4.7.1">Added J. C. Hugly as author.<a href="#appendix-D.3-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.8">
            <p id="appendix-D.3-4.8.1">Introduced this change log<a href="#appendix-D.3-4.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-4.9">
            <p id="appendix-D.3-4.9.1">Clarify addressing and avoid confusing claim of communication between two endpoints with the same IP (section 1.3.1)<a href="#appendix-D.3-4.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-dataplane-02">
<section id="appendix-D.4">
        <h3 id="name-draft-dekater-scion-dataplane-">
<a href="#name-draft-dekater-scion-dataplane-" class="section-name selfRef">draft-dekater-scion-dataplane-02</a>
        </h3>
<p id="appendix-D.4-1">Major changes:<a href="#appendix-D.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.4-2.1">
            <p id="appendix-D.4-2.1.1">Added overview of SCION components to Introduction section.<a href="#appendix-D.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-2.2">
            <p id="appendix-D.4-2.2.1">Introduced AES-CMAC as default MAC algorithm and elaborated on MAC chaining and path splicing.<a href="#appendix-D.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-2.3">
            <p id="appendix-D.4-2.3.1">Added section to describe Effects of Clock Inaccuracy / time synchronization requirements<a href="#appendix-D.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-2.4">
            <p id="appendix-D.4-2.4.1">Added section to describe required router Configuration<a href="#appendix-D.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-2.5">
            <p id="appendix-D.4-2.5.1">Added service field table.<a href="#appendix-D.4-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-D.4-3">Minor changes:<a href="#appendix-D.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.4-4.1">
            <p id="appendix-D.4-4.1.1">Removed forward references.<a href="#appendix-D.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-4.2">
            <p id="appendix-D.4-4.2.1">General edits to make terminology consistent, remove duplication and rationalize text.<a href="#appendix-D.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-4.3">
            <p id="appendix-D.4-4.3.1">Added and capitalized RFC2119 compliant terminology.<a href="#appendix-D.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-4.4">
            <p id="appendix-D.4-4.4.1">Clarified implications of AS forwarding key compromise and path splicing in security considerations<a href="#appendix-D.4-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-4.5">
            <p id="appendix-D.4-4.5.1">Clarified the computation of ExtLen.<a href="#appendix-D.4-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Corine de Kater</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:c_de_kater@gmx.ch" class="email">c_de_kater@gmx.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nicola Rustignoli</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nic@scion.org" class="email">nic@scion.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jean-Christophe Hugly</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jch@scion.org" class="email">jch@scion.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Hitz</span></div>
<div dir="auto" class="left"><span class="org">Anapaya Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hitz@anapaya.net" class="email">hitz@anapaya.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
